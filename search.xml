<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[HTTPsè¯ä¹¦ç›¸å…³]]></title>
    <url>%2F2018%2F03%2F25%2FHTTPS-certificate%2F</url>
    <content type="text"><![CDATA[åŽ»å¹´æŸå®¢æˆ·éœ€è¦ä½¿ç”¨HTTP/2ä¸šåŠ¡æ¥åšäººå·¥ç›´æ’­å†…å®¹å®¡æ ¸ç”¨ã€‚å…·ä½“æ“ä½œåº”è¯¥ä¸ºä¸€ä¸ªå¤§å±å¹•ï¼Œä¸€ä¸ªchromeæµè§ˆå™¨ï¼Œæµè§ˆå™¨ä½¿ç”¨HTTP/2å¯ä»¥å¤ç”¨ä¸€ä¸ªè¿žæŽ¥ï¼Œå‘èŠ‚ç‚¹åŒæ—¶è¯·æ±‚å‡ åè·¯æµï¼ŒéšåŽè¿›è¡Œå®¡æ ¸ã€‚ ç”±äºŽå½¼æ—¶å…¬å¸æ‰€ä½¿ç”¨çš„cacheè½¯ä»¶å’Œå‰ç«¯åå‘ä»£ç†è½¯ä»¶å‡ä¸æ”¯æŒHTTP/2ï¼Œæ‰€ä»¥åœ¨å®¢æˆ·è¦æ±‚çš„åŒºåŸŸï¼Œæ­å»ºäº†ä¸¤å°NGINXæœåŠ¡çš„æœºå™¨ï¼Œç”±å®¢æˆ·ä½¿ç”¨hostsè®¿é—®çš„å½¢å¼è¿›è¡ŒæœåŠ¡ã€‚ è¿‘æœŸè¯¥å®¢æˆ·æ‰€ä½¿ç”¨çš„è¯ä¹¦è¿‡æœŸï¼Œè€Œç”±äºŽè¯¥ä¸¤å°æœºå™¨ä¸ºäººå·¥é…ç½®ï¼Œæœªè‡ªåŠ¨æ›´æ–°æ–°çš„è¯ä¹¦ï¼Œå¯¼è‡´è¯¥æœåŠ¡å¼‚å¸¸ã€‚è€Œå®¢æœäººå‘˜æ‰€æä¾›çš„æ–°çš„è¯ä¹¦æ²¡æœ‰åŒ…å«ç§é’¥ï¼Œå¯¼è‡´è¯ä¹¦ä¸€åº¦æ— æ³•æ›´æ–°ã€‚ ä¹‹å‰å¯¹äºŽHTTPsä¸šåŠ¡ä¸€ç›´æœªæœ‰çœŸçš„æŽ¥è§¦ï¼Œæ­¤æ¬¡è¶æœºå­¦ä¹ ä¸€è®°ã€‚ åŠ å¯†æ–¹å¼ä¸Žåº”ç”¨å¯¹ç§°åŠ å¯†å¯¹ç§°åŠ å¯†çš„ä¸»è¦åŽŸç†æ˜¯ï¼Œæ•°æ®äº¤äº’åŒæ–¹ä½¿ç”¨äº‹å…ˆé€šè¿‡ä¸€å®šé€”å¾„çº¦å®šå¥½çš„ç§˜é’¥å¯¹éœ€è¦ä¼ è¾“çš„æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼Œå¹¶ä½¿ç”¨åŒæ ·çš„ç§˜é’¥å¯¹æ”¶åˆ°çš„åŠ å¯†æ¶ˆæ¯è¿›è¡Œè§£å¯†ã€‚ ç”±äºŽä½¿ç”¨çš„åŠ è§£å¯†çš„ç§˜é’¥ä¸€æ ·ï¼Œæ‰€ä»¥ç§°ä¸ºå¯¹ç§°åŠ å¯†ã€‚å¸¸è§çš„å¯¹ç§°åŠ å¯†æ–¹å¼æœ‰DESã€3DESã€TDEAã€Blowfishã€RC2ã€RC4ã€RC5ã€IDEAã€SKIPJACKã€AESç­‰ã€‚ éžå¯¹ç§°åŠ å¯†éžå¯¹ç§°åŠ å¯†åŒºåˆ«äºŽå¯¹ç§°åŠ å¯†çš„ä¸€ç‚¹æ˜¯ï¼Œæ•°æ®äº¤äº’åŒæ–¹æŒæœ‰çš„ç§˜é’¥ä¸ä¸€æ ·ï¼Œä¸€èˆ¬ç”¨æˆ·æŒæœ‰çš„ç§˜é’¥ç§°ä¸ºå…¬é’¥ï¼Œè€ŒæœåŠ¡ç«¯æŒæœ‰çš„ç§˜é’¥ä¸ºç§é’¥ã€‚å…¬é’¥å¯ä»¥å…¬å¼€ï¼ŒæœåŠ¡ç«¯å¯¹äºŽä»»ä½•è¯·æ±‚æ–¹éƒ½å¯ä»¥å“åº”å…¶å…¬é’¥ã€‚è€Œç§é’¥åªèƒ½æ˜¯æœåŠ¡ç«¯æŒæœ‰ã€‚ å½“éœ€è¦è¿›è¡ŒåŠ å¯†é€šä¿¡æ—¶ï¼ŒæœåŠ¡ç«¯å°†å…¬é’¥æä¾›ç»™ç”¨æˆ·å¹¶æºå¸¦ä¸€ä¸ªéšæœºæ•°ï¼Œç”¨æˆ·åˆ©ç”¨å…¬é’¥å’Œéšæœºæ•°å°†éœ€è¦ä¼ è¾“çš„æ¶ˆæ¯åŠ å¯†ã€‚æœåŠ¡ç«¯é€šè¿‡ç§é’¥è§£å¯†ï¼Œå¾—åˆ°æ˜Žæ–‡æ¶ˆæ¯ã€‚ æœåŠ¡ç«¯å¯¹éœ€è¦å“åº”çš„æ¶ˆæ¯åˆ©ç”¨hashç®—æ³•ç”Ÿæˆæ‘˜è¦ï¼Œå¹¶åˆ©ç”¨ç§é’¥å°†æ‘˜è¦åŠ å¯†ï¼Œå½¢æˆæ•°å­—ç­¾åã€‚å½“å®¢æˆ·ç«¯æ”¶åˆ°å“åº”åŽï¼Œåˆ©ç”¨å…¬é’¥è§£å¼€æ•°å­—ç­¾åï¼Œå¾—åˆ°æ‘˜è¦ï¼Œç„¶åŽå¯¹æ”¶åˆ°çš„æ¶ˆæ¯åˆ©ç”¨åŒæ ·çš„hashç®—æ³•ç”Ÿæˆæ‘˜è¦ï¼Œå¯¹æ¯”ä¸¤è€…æ‘˜è¦æ˜¯å¦ç›¸åŒã€‚å¦‚æžœç›¸åŒï¼Œåˆ™è®¤ä¸ºå“åº”æ¶ˆæ¯æ¥è‡ªæŒ‡å®šæœåŠ¡ç«¯ã€‚ å¸¸è§çš„éžå¯¹ç§°åŠ å¯†æœ‰ï¼šRSAã€Elgamalã€èƒŒåŒ…ç®—æ³•ã€Rabinã€D-Hã€ECCï¼ˆæ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ï¼‰ã€‚ å®žé™…åº”ç”¨éžå¯¹ç§°åŠ è§£å¯†çš„è®¡ç®—æ¶ˆè€—è¦æ¯”å¯¹ç§°åŠ è§£å¯†å¤§å¾ˆå¤šï¼Œæ‰€ä»¥å®žé™…åº”ç”¨ä¸€èˆ¬é‡‡ç”¨ä¸¤è€…çš„ç»“åˆè¾¾åˆ°é€Ÿåº¦å’Œå®‰å…¨çš„ä¸¤å…¨å…¶ç¾Žã€‚å³ï¼šä½¿ç”¨éžå¯¹ç§°æœºå¯†æ–¹å¼ä¼ è¾“å¯¹ç§°åŠ å¯†çš„ç§˜é’¥ã€‚ç”¨å¯¹ç§°åŠ å¯†ä¼ è¾“å®žé™…çš„æ¶ˆæ¯ã€‚ CA, certificate authorityå‰©ä¸‹çš„é—®é¢˜æ˜¯å¦‚ä½•åœ¨åœ¨éžå¯¹ç§°åŠ å¯†æ—¶ï¼ŒæŠŠæœåŠ¡å™¨çš„å…¬é’¥ä¼ è¾“ç»™è¯·æ±‚æ–¹äº†ã€‚è‹¥æ˜¯ç›´æŽ¥ä¼ è¾“ï¼Œå…¬é’¥åœ¨ä¼ è¾“è¿‡ç¨‹å¦‚æžœå‘ç”ŸåŠ«æŒè¢«æ›¿æ¢æˆå…¶ä»–å…¬é’¥æ€Žä¹ˆåŠžã€‚ ä»¥ä¸Šé—®é¢˜æ€»ç»“ä¸‹æ¥ä¾¿æ˜¯å¦‚ä½•è¯æ˜Žæ”¶åˆ°çš„å…¬é’¥ä¾¿æ˜¯ä¾¿æ˜¯å®žé™…è¯·æ±‚å“åº”æ–¹ç»™çš„å‘¢ã€‚ æ­¤å¤„å¼•å…¥ä¸€ä¸ªæ•°å­—æ‘˜è¦çš„æ¦‚å¿µã€‚æ¶ˆæ¯æ‘˜è¦æ˜¯å°†å…¬é’¥å’Œå…¶ä»–è¯ä¹¦ç”³è¯·è€…çš„ä¿¡æ¯ä½œä¸ºhashè¾“å…¥ï¼ˆé¢„æ˜ å°„ï¼‰è€Œå¾—åˆ°çš„hashå€¼ã€‚ç”±äºŽhashå”¯ä¸€æ€§ï¼Œå¦‚æžœä¸­é€”è¢«ç¯¡æ”¹ï¼Œåˆ™ç›¸åº”çš„æ¶ˆæ¯æ‘˜è¦å°†å‘ç”Ÿå˜åŒ–ï¼Œæ— æ³•æ ¡éªŒé€šè¿‡ã€‚ ä¸ºäº†é˜²æ­¢ä¸­é—´åŠ«æŒæ–¹ä¿®æ”¹æ•´ä¸ªå…¬é’¥å’Œå…¶ä»–é¢„æ˜ å°„çš„ä¿¡æ¯ï¼Œå¹¶ç”Ÿæˆæ–°çš„æ¶ˆæ¯æ‘˜è¦ï¼ŒæœåŠ¡ç«¯åœ¨æä¾›æ¶ˆæ¯æ‘˜è¦æ—¶ï¼Œä¼šä½¿ç”¨æœ‰æƒå¨æ€§çš„è¯ä¹¦æŽˆæƒä¸­å¿ƒçš„ç§é’¥è¿›è¡ŒåŠ å¯†ï¼Œè€Œè¿™äº›æƒå¨æ€§çš„è¯ä¹¦æŽˆæƒä¸­å¿ƒçš„å…¬é’¥åˆ™é¢„è®¾åœ¨æˆ‘ä»¬çš„æ“ä½œç³»ç»Ÿæˆ–è€…æµè§ˆå™¨ä¸­ã€‚å½“ä¸­é€”è¯ä¹¦è¢«åŠ«æŒç¯¡æ”¹åŽï¼Œå°†æ— æ³•æ ¡éªŒé€šè¿‡ã€‚ ä¸Šè¿°æƒå¨æ€§çš„è¯ä¹¦æŽˆæƒä¸­å¿ƒå³æ‰€è°“çš„CA,certificate authorityï¼Œæ¯”è¾ƒè‘—åçš„æœ‰Symantecï¼ŒGeoTrustå’Œæ–°å…´çš„å…è´¹çš„Letâ€™s Encryptç­‰ã€‚ HTTPSäº¤äº’ä½¿ç”¨cURLå‘èµ·ä¸€æ¬¡HTTPSçš„è¯·æ±‚ï¼ŒcURLè®°å½•çš„å“åº”å¦‚ä¸‹ï¼š /usr/local/curl-7.55.1/bin/curl --http2 --cacert /etc/pki/tls/certs/ca-bundle.crt https://pull-flv-l1-hs-admin.pstatp.com/live/livestream.flv -v * Trying 110.242.21.20... * TCP_NODELAY set * Connected to pull-flv-l1-hs-admin.pstatp.com (110.242.21.20) port 443 (#0) * ALPN, offering h2 * ALPN, offering http/1.1 * Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH * successfully set certificate verify locations: * CAfile: /etc/pki/tls/certs/ca-bundle.crt CApath: none * TLSv1.2 (OUT), TLS header, Certificate Status (22): * TLSv1.2 (OUT), TLS handshake, Client hello (1): * TLSv1.2 (IN), TLS handshake, Server hello (2): * TLSv1.2 (IN), TLS handshake, Certificate (11): * TLSv1.2 (IN), TLS handshake, Server key exchange (12): * TLSv1.2 (IN), TLS handshake, Server finished (14): * TLSv1.2 (OUT), TLS handshake, Client key exchange (16): * TLSv1.2 (OUT), TLS change cipher, Client hello (1): * TLSv1.2 (OUT), TLS handshake, Finished (20): * TLSv1.2 (IN), TLS change cipher, Client hello (1): * TLSv1.2 (IN), TLS handshake, Finished (20): * SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 * ALPN, server accepted to use h2 * Server certificate: * subject: CN=*.pstatp.com * start date: Dec 21 00:00:00 2017 GMT * expire date: Dec 26 12:00:00 2020 GMT * subjectAltName: host "pull-flv-l1-hs-admin.pstatp.com" matched cert's "*.pstatp.com" * issuer: C=US; O=DigiCert Inc; OU=www.digicert.com; CN=RapidSSL RSA CA 2018 * SSL certificate verify ok. * Using HTTP2, server supports multi-use * Connection state changed (HTTP/2 confirmed) * Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0 * Using Stream ID: 1 (easy handle 0x10cc020) > GET /live/livestream.flv HTTP/2 > Host: pull-flv-l1-hs-admin.pstatp.com > User-Agent: curl/7.55.1 > Accept: */* > * Connection state changed (MAX_CONCURRENT_STREAMS updated)! &lt; HTTP/2 200 &lt; date: Sun, 25 Mar 2018 03:08:54 GMT &lt; content-type: video/x-flv &lt; cache-control: no-cache &lt; expires: -1 &lt; pragma: no-cache &lt; Warning: Binary output can mess up your terminal. Use "--output -" to tell Warning: curl to output it to your terminal anyway, or consider "--output Warning: &lt;FILE>" to save to a file. * Failed writing body (0 != 13) * Closing connection 0 * TLSv1.2 (OUT), TLS alert, Client hello (1): å¯ä»¥çœ‹åˆ°cURLåœ¨tcpå»ºè”åŽï¼Œè¿›å…¥äº†TLSv1.2çš„SSLå±‚æ•°æ®äº¤äº’ã€‚ é¦–å…ˆClientç«¯å‘èµ·Client Helloï¼Œä¼šæä¾›4å­—èŠ‚çš„unixæ—¶é—´å’Œç”¨äºŽåŽç»­ä½¿ç”¨çš„28å­—èŠ‚éšæœºæ•°random_Cã€‚å¹¶ä¸”ä¼šæºå¸¦å®¢æˆ·ç«¯æ”¯æŒæ‰€æœ‰åŠ å¯†å¥—ä»¶(Cipher Suites)åç§°ï¼Œä»¥ä¾›æœåŠ¡å™¨é€‰æ‹©ï¼Œå¦‚ä¸‹å›¾ä¸€æ‰€ç¤ºã€‚ å›¾ä¸€ å¹¶ä¸”å¯èƒ½ä¼šåœ¨æ‰©å±•ä¿¡æ¯(Extension)ä¸­æºå¸¦è¯·æ±‚URLçš„server nameä¿¡æ¯ï¼Œæ–¹ä¾¿æœåŠ¡å™¨å†³å®šä½¿ç”¨å“ªæœ¬SNIè¯ä¹¦ã€‚å…³äºŽSNIè¯ä¹¦ï¼Œå¯ä»¥æŸ¥çœ‹ç»´åŸºç™¾ç§‘ã€‚è¯·æ±‚å¦‚ä¸‹å›¾äºŒæ‰€ç¤ºã€‚ å›¾äºŒ æœåŠ¡ç«¯æ”¶åˆ°Client HelloåŽä¼šç›¸åº”å“åº”ç»™å®¢æˆ·ç«¯Server Helloï¼Œä¼šæä¾›æœåŠ¡ç«¯çš„4å­—èŠ‚çš„unixæ—¶é—´å’Œç”¨äºŽåŽç»­ä½¿ç”¨çš„28å­—èŠ‚éšæœºæ•°random_Sï¼Œå¹¶ä¸”é€‰å®šå®¢æˆ·ç«¯æä¾›çš„æ”¯æŒçš„åŠ å¯†å¥—ä»¶ä¸­çš„ä¸€ç§ï¼Œå¦‚ä¸‹å›¾ä¸‰ä¸­æ‰€ç¤ºï¼Œé€‰æ‹©æ˜¯**TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256**ï¼Œå…¶å…·ä½“çš„å«ä¹‰ä¸ºï¼š åŸºäºŽTLSåè®®ï¼› ä½¿ç”¨ECDHEä½œä¸ºç§˜é’¥äº¤æ¢ç®—æ³•ï¼› RSAä½œä¸ºç­¾åè®¤è¯ï¼› AES_128_GCMä½œä¸ºå¯¹ç§°åŠ å¯†ç®—æ³•ï¼› SHA256ä½œä¸ºæ‘˜è¦ç®—æ³•ï¼› å†æ·±å…¥çš„ä¿¡æ¯ï¼Œä¼°è®¡æ˜¯è¦çœ‹å‡ æœ¬å¤§éƒ¨å¤´çš„ä¹¦æ‰èƒ½ç†è§£äº†ã€‚ å›¾ä¸‰ æœåŠ¡ç«¯åœ¨å‘é€Server Helloä¹‹åŽï¼Œä¾¿ä¼šå°†ç›¸å…³çš„è¯ä¹¦ï¼ˆåŒ…å«å…¬é’¥ï¼‰å‘é€ç»™å®¢æˆ·ç«¯ï¼Œè¯¥æ“ä½œç§°ä¸ºCertificateï¼Œå¦‚ä¸‹å›¾å››æ‰€ç¤ºï¼Œå…¶ä¸­åŒ…å«çš„è¯ä¹¦ä¿¡æ¯å¦‚ä¸‹å›¾äº”æ‰€ç¤ºã€‚ å›¾å›› å›¾äº” æ­¤æ¬¡åŠ å¯†é€šä¿¡ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ECDHEç®—æ³•ä½œä¸ºç§˜é’¥äº¤æ¢ç®—æ³•ã€‚æ‰€ä»¥æœåŠ¡ç«¯åœ¨å‘é€Certificateæ¶ˆæ¯åŽè¿˜ä¼šç»™å‡ºç”¨äºŽECDHEåŠ å¯†ä½¿ç”¨çš„ä¿¡æ¯ï¼Œç§°ä½œServer Key Exchangeã€‚å¦‚ä¸‹å›¾å…­ï¼ŒæœåŠ¡ç«¯æä¾›äº†åŠ å¯†ç®—æ³•æ‰€éœ€çš„Pubkeyä»¥åŠå¯¹æ•°æ®åšäº†ä¸€æ¬¡ç­¾åã€‚ å›¾å…­ åˆ°æ­¤ï¼ŒæœåŠ¡ç«¯æ‰€éœ€ä¼ é€’çš„æ•°æ®å‡å·²å®Œæˆï¼ŒæœåŠ¡ç«¯å‘é€ä¸€ä¸ªServer Hello doneæ¶ˆæ¯ï¼Œè¡¨ç¤ºå®Œæˆã€‚å¦‚ä¸‹å›¾ä¸ƒã€‚ å›¾ä¸ƒ æŽ¥ä¸‹æ¥è½®åˆ°å®¢æˆ·ç«¯è¡¨æ¼”äº†ã€‚åœ¨æ”¶åˆ°æœåŠ¡ç«¯çš„Server Key Exchangeä¹‹åŽï¼Œå®¢æˆ·ç«¯ä¼šè¿›è¡Œç§˜é’¥äº¤æ¢ï¼Œåšç›¸åº”çš„Client Key ExchangeåŠ¨ä½œï¼Œäº¤æ¢ä¸€äº›åŠ å¯†å‚æ•°ã€‚å¦‚ä¸‹å›¾å…«ã€‚ æ­¤æ—¶ï¼Œä¸å‡ºæ„å¤–ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å°±å¯ä»¥è¿›è¡ŒåŠ å¯†é€šä¿¡äº†ã€‚å®¢æˆ·ç«¯å‘é€ChangeCipher Specæ¶ˆæ¯ï¼Œè¡¨ç¤ºæŽ¥ä¸‹æ¥å¼€å§‹åŠ å¯†é€šä¿¡ï¼ŒéšåŽå‘é€ä¸€ä¸ªåŠ å¯†çš„æ¡æ‰‹æ¶ˆæ¯Encrypted Handshake Messageè¿›è¡ŒéªŒè¯ã€‚å¦‚ä¸‹å›¾å…«ã€‚ å›¾å…« æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯å¼€å§‹åŠ å¯†é€šä¿¡çš„æ¶ˆæ¯å’ŒåŠ å¯†çš„æ¡æ‰‹æ¶ˆæ¯åŽï¼Œç›¸åº”çš„ä¹Ÿå“åº”ä¸€ä¸ªå¼€å§‹åŠ å¯†é€šä¿¡çš„æ¶ˆæ¯Change Cipher Specï¼Œå¹¶ä¸”ä¹Ÿå‘é€ä¸€ä¸ªåŠ å¯†çš„æ¡æ‰‹æ¶ˆæ¯Encrypted Handshake Messageã€‚å¦‚å›¾åæ‰€ç¤ºã€‚ å›¾ä¹ è‡³æ­¤ï¼ŒåŠ å¯†é€šé“å®Œæˆå»ºç«‹ï¼Œå¼€å§‹è¿›è¡ŒåŠ å¯†é€šä¿¡ã€‚ç›´åˆ°å®¢æˆ·ç«¯å‘èµ·Encrypted Alertï¼Œè¡¨ç¤ºç»“æŸä¸ºæ­¢ã€‚ æ€»ç»“ä¸‹æ¥çš„æµç¨‹å›¾å¤§è‡´å¦‚æ­¤ï¼š è¯¦ç»†çš„åŠ å¯†ç®—æ³•åŸºæœ¬ä¹Ÿä¸ç”¨äº†è§£ã€‚å¤ªé«˜æ·±äº†ã€‚ NGINXè¯ä¹¦é…ç½®NGINXä½œä¸ºproxyä½¿ç”¨æ—¶çš„ç›¸å…³é…ç½®ã€‚ å¯¹å¤–åŸŸåä¸ºpull.test.comï¼Œå¯ç”¨HTTPå’ŒHTTPSï¼Œå¹¶ä¸”å¯ç”¨HTTP2ï¼Œ server { server_name pull.test.com; listen [::]:443 ssl http2 reuseport; listen [::]:80 http2 reuseport; ssl_certificate /SSL_cert/test.com.crt; ssl_certificate_key /SSL_cert/test.com.key; ssl_trusted_certificate /SSL_cert/test.com.ca; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK; location / { set $s_host ori.pull.test.com; proxy_set_header Host $s_host; more_set_headers "Access-Control-Allow-Origin:*"; proxy_pass http://127.0.0.1:xxx; } //test URL location = /live/livestream.flv { set $s_host test.test.com; proxy_set_header Host $s_host;d proxy_pass http://127.0.0.1:xxx; } } Client->Server: Client Hello Server->Client: Server Hello Server->Client: Certificate Server->Client: Server Key Exchange Server->Client: Server Hello Done Client->Server: Client Key Exchange Client->Server: Change Cipher Spec Client->Server: Encrypted Handshake Message Server->Client: Change Cipher Spec Server->Client: Encrypted Handshake Message Client->Server: Application Data Server->Client: Application Data Client-->Server: ... Server-->Client: ... Client->Server: Encrypted Alert{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12,"theme":"simple"} var code = document.getElementById("sequence-0-code").value; var options = JSON.parse(decodeURIComponent(document.getElementById("sequence-0-options").value)); var diagram = Diagram.parse(code); diagram.drawSVG("sequence-0", options);]]></content>
      <tags>
        <tag>HTTPS</tag>
        <tag>NGINX</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[H265ç æµæ ¼å¼]]></title>
    <url>%2F2018%2F02%2F04%2FH265_format%2F</url>
    <content type="text"><![CDATA[H265æ ‡å‡†è‡ª2013å¹´æŽ¨å‡ºä»¥æ¥ï¼Œä¸€ç›´å—é™äºŽCPUæˆ–è€…GPUç¡¬è§£æ€§èƒ½çš„é™åˆ¶ï¼Œéš¾ä»¥æ™®åŠã€‚ IOS11çš„VideoToolboxæ”¯æŒç¡¬è§£H265ï¼Œå¼€å‘è€…å¯ä»¥è°ƒç”¨æä¾›çš„æŽ¥å£å®žçŽ°HEVCçš„ç¡¬è§£ã€‚è€Œå®‰å“é˜µè¥è¿‘å‡ ä»£SOCèŠ¯ç‰‡æ—©å°±æ”¯æŒäº†H265çš„ç¡¬è§£ï¼Œå¹¶ä¸”å…¶è®¡ç®—èƒ½åŠ›ä¹Ÿå¼ºå¤§åˆ°å‡ºçŽ°äº†å‡ºçŽ°äº†è®¨è®ºæ˜¯å¦æ€§èƒ½è¿‡å‰©çš„çŽ°è±¡ã€‚è‡³äºŽPCç«¯ï¼Œç”±äºŽPCè®¾å¤‡æ›´æ–°é€Ÿåº¦è¿œæ²¡æœ‰ç§»åŠ¨è®¾å¤‡å¿«é€Ÿï¼Œç›®å‰åœ¨ç”¨çš„PCè®¾å¤‡æ€§èƒ½å‚å·®ä¸é½ï¼Œå¹¶ä¸”è¿™ç±»çŽ°è±¡ä¼šæŒç»­ä¸€é•¿æ®µæ—¶é—´ã€‚ æŽ¨æµä¾§çš„H265æ¯”æ‹‰æµè¦å®¹æ˜“æŽ¨å¹¿ï¼Œä¸»æ’­å‘æ¥æŒæœ‰çš„è®¾å¤‡æ€§èƒ½éƒ½è¾ƒå¼ºï¼Œä¹Ÿæ˜¯æ¯”è¾ƒæ–°çš„æ——èˆ°äº§å“ï¼Œä¸€èˆ¬éƒ½å¯ä»¥æ”¯æŒHEVCçš„ç¡¬ç¼–ã€‚ åœ¨CDNä¾§ï¼Œå„å¤§CDNæœåŠ¡æä¾›å•†å¤§å¤šæ•°å‡å·²æ”¯æŒäº†H265æ ¼å¼çš„è§†é¢‘æ•°æ®åˆ†å‘ã€‚ åŸºäºŽä»¥ä¸Šï¼Œé¢„æµ‹2018å¹´ï¼Œå„å¤§è§†é¢‘å†…å®¹æä¾›å•†å¤„äºŽCDNå¸¦å®½æˆæœ¬è€ƒè™‘ï¼Œåº”è¯¥ä¼šæŠŠH265ä½œä¸ºä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å·¥ä½œé¡¹ç›®ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬å­¦ä¹ ä¸‹H265çš„ç æµæ ¼å¼ã€‚ FLVä¸ŽH265FLVæ˜¯ä¸€ä¸ªAdobeå…¬å¸ä¸ºflashæ’­æ”¾å™¨(SWF)é…å¥—æŽ¨å‡ºçš„è§†é¢‘å°è£…æ ¼å¼ã€‚ç”±äºŽå…¶æ ¼å¼ç»“æž„ç®€å•ï¼Œé…å¥—æ–¹æ¡ˆæˆç†Ÿï¼Œåœ¨æµåª’ä½“è¡Œä¸šå†…åº”ç”¨ååˆ†å¹¿æ³›ã€‚ è™½ç„¶FLVçš„æ ‡å‡†å‡ ä¹Žæ¯å¹´éƒ½åœ¨æ›´æ–°ï¼Œä½†æ˜¯Adobeå¹¶æ²¡æœ‰è®©FLVæ”¯æŒH265ã€‚FLVæ”¯æŒçš„ç¼–ç æ ¼å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼ˆå¼•è‡ªwikipediaï¼‰ï¼š Id Video encoding 0 RGB 1 run-length 2 Sorensonâ€™s H.263 3 Screen 1 4 On2 TrueMotion VP6 5 VP6 with alpha 6 Screen 2 7 MP4 H.264 8 ITU H.263 9 MPEG-4 ASP. ç›®å‰å›½å†…ç›´æ’­å¤§å¤šæ•°é‡‡ç”¨HTTP-FLVçš„æ‹‰æµæ–¹å¼ï¼Œå…¶åŽŸå› æ˜¯HTTPå¯ä»¥ä¿è¯åœ¨TCPæ¡æ‰‹æˆåŠŸä¹‹åŽé©¬ä¸Šå‘èµ·GETè¯·æ±‚ï¼Œä¸åƒRTMPé‚£æ ·è¿˜éœ€è¦è¿›è¡ŒRTMPåº”ç”¨å±‚é¢çš„æ¡æ‰‹ä»¥åŠå„ç±»messageæ¶ˆæ¯çš„ä¼ è¾“æ¥ç¡®å®šè®¸å¤šå‚æ•°ï¼Œä»Žè€Œä¿è¯è¾ƒå¿«çš„é¦–å±æ—¶é—´ã€‚è‡³äºŽHLSï¼ŒHDSï¼ŒMSSï¼ŒMPEG-DASHç­‰åŸºäºŽåˆ‡ç‰‡çš„ï¼Œåœ¨å›½å¤–ç›´æ’­ä¸­è¾ƒä¸ºå¸¸è§ï¼Œå›½å†…çš„ç›´æ’­æ™®éæ— æ³•æŽ¥å—åˆ‡ç‰‡å¸¦æ¥çš„å»¶è¿Ÿï¼Œå› æ­¤HTTP-FLVåœ¨å›½å†…ç›´æ’­è¡Œä¸šå†…åº”ç”¨å¹¿æ³›ã€‚ ç†æ‰€å½“ç„¶çš„ï¼Œå¤§å®¶ä¹Ÿéƒ½å¸Œæœ›å°†H265çš„ç æµä¹Ÿå°è£…è¿›FLVä¸­ï¼Œå¦‚æ­¤å¯ä»¥çœåŽ»å¾ˆå¤šé€‚é…å·¥ä½œã€‚ å› æ­¤ï¼Œä¾¿æœ‰äº†éžå®˜æ–¹çš„å¢¨å®ˆæˆè§„çš„â€æ ‡å‡†â€œäº†ã€‚ FLVä¸­ï¼ŒVideo Tagä¸­çš„Tag Dataä¸­çš„ç¬¬ä¸€å­—èŠ‚çš„ä½Žå››ä½è¡¨ç¤ºç¼–ç æ ¼å¼CodecIDï¼Œå…¶å–å€¼ä¾¿å¦‚ä¸Šè¿°è¡¨æ ¼æ‰€ç¤ºï¼Œå¸¸è§çš„æ˜¯7ï¼Œå³AVCç¼–ç æ–¹å¼ã€‚è€Œéžå®˜æ–¹çš„å¤§å®¶æ™®éçš„åšæ³•æ˜¯å°†0XC=12Dæ ‡å¿—ä¸ºHEVCã€‚ H265ç æµæ ¼å¼2018å¹´2æœˆ6æ—¥è¡¥å……ï¼Œåœ¨éžå®˜æ–¹çš„FLVå°è£…265ç æµä¸­ï¼ŒåŸºæœ¬ä¸Ž264ä¸€è‡´ï¼Œåˆ†ä¸º265æ ‡å‡†è‡ªå¸¦çš„é™„å½•Bï¼ˆAnnex-Bï¼‰å’ŒavcCç±»ä¼¼çš„hvcCã€‚ hvcCä¸€èˆ¬è§£æž 2C 2ï¼Œä»£è¡¨éžå…³é”®å¸§ CH=12Dï¼Œä»£è¡¨CodecID=12Dï¼Œä¸ºhevc 01 æ²¿ç”¨AVCä¸­çš„æ ¼å¼ 00 00 00 æ²¿ç”¨AVCä¸­çš„æ ¼å¼ 00 00 15 B0 ä»£è¡¨ä¸‹ä¸€ä¸ªNALUçš„é•¿åº¦ä¸º15B0H=5552Då­—èŠ‚ 02 01H=0000 0010 0000 0001Bï¼ŒNAL units header ç¬¬ä¸€ä½ï¼Œ1æ¯”ç‰¹ï¼Œ0ï¼Œç¦æ­¢ä½ï¼Œforbidden_zero_bitã€‚éžé›¶ä»£è¡¨å¼‚å¸¸ï¼› ç¬¬äºŒè‡³ä¸ƒä½ï¼Œ6æ¯”ç‰¹ï¼Œ000001ï¼ŒNALUç±»åž‹ï¼Œnal_unit_typeã€‚å¸¸è§çš„ç±»åž‹æœ‰ï¼š 40 01Hâ€“&gt;nal_unit_type=32Dï¼ŒVPS 42 01Hâ€“&gt;nal_unit_type=33Dï¼ŒSPS 44 01Hâ€“&gt;nal_unit_type=34Dï¼ŒPPS 4E 01Hâ€“&gt;nal_unit_type=39Dï¼ŒSEI 26 01Hâ€“&gt;nal_unit_type=19Dï¼ŒIDR 02 01Hâ€“&gt;nal_unit_type=1Dï¼Œè¢«å‚è€ƒçš„åŽç½®å›¾åƒ ç¬¬å…«è‡³åä¸‰ä½ï¼Œ6æ¯”ç‰¹ï¼Œ000000ï¼Œnuh_layer_idï¼Œä¸€èˆ¬å–å€¼ä¸º0ï¼Œéž0ä¸º3Dç­‰ç‰¹æ®Šè§†é¢‘ã€‚ ç¬¬åå››è‡³åå…­ä½ï¼Œ3æ¯”ç‰¹ï¼Œ001ï¼Œnuh_temporal_id_plus1ï¼ŒNALUæ‰€åœ¨æ—¶åŸŸå±‚çš„æ ‡è¯†å·temporalId+1ã€‚ hvcCå¤´è§£æž 1C 1ï¼Œä»£è¡¨å…³é”®å¸§ CH=12Dï¼Œä»£è¡¨CodecID=12Dï¼Œä¸ºhevc 01 æ²¿ç”¨AVCä¸­çš„æ ¼å¼ 00 00 00 æ²¿ç”¨AVCä¸­çš„æ ¼å¼ 00 00 00 19 ä¸‹ä¸€ä¸ªNALUçš„é•¿åº¦ä¸º19Hå­—èŠ‚ 40 01 0C 01 â€¦ 40 01 : VPS 00 00 00 28 ä¸‹ä¸€ä¸ªNALUçš„é•¿åº¦ä¸º28Hå­—èŠ‚ 42 01 01 01 â€¦ 42 01 : SPS 00 00 00 08 ä¸‹ä¸€ä¸ªNALUçš„é•¿åº¦ä¸º8Hå­—èŠ‚ 44 01 C1 71 â€¦ 44 01 : PPS 00 03 A0 C1 ä¸‹ä¸€ä¸ªNALUçš„é•¿åº¦æ˜¯03A0C1Hå­—èŠ‚ 26 01 .. 26 01 : IDR Annex-Bä¸€èˆ¬è§£æž 1C 1ï¼Œä»£è¡¨å…³é”®å¸§ CH=12Dï¼Œä»£è¡¨CodecID=12Dï¼Œä¸ºhevc 01 æ²¿ç”¨AVCä¸­çš„æ ¼å¼ 00 01 F4 æ²¿ç”¨AVCä¸­çš„æ ¼å¼ 00 00 00 01 Start code : åˆ†éš”ç¬¦ 26 01 â€¦ 26 01 : IDR 00 00 03 00 â€¦ æ­¤å¤„0x03å³é˜²ç«žäº‰å­—èŠ‚ï¼Œemulation_prevention_three_byte Annex-Bå¤´è§£æž 1C 1ï¼Œä»£è¡¨å…³é”®å¸§ CH=12Dï¼Œä»£è¡¨CodecID=12Dï¼Œä¸ºhevc 01 æ²¿ç”¨AVCä¸­çš„æ ¼å¼ 00 00 00 æ²¿ç”¨AVCä¸­çš„æ ¼å¼ 00 00 00 01 Start code : åˆ†éš”ç¬¦ 40 01 â€¦ 40 01 : VPS 00 00 00 01 Start code : åˆ†éš”ç¬¦ 42 01 â€¦ 42 01 : SPS 00 00 00 01 Start code : åˆ†éš”ç¬¦ 44 01 â€¦ 44 01 : PPS]]></content>
      <tags>
        <tag>live</tag>
        <tag>video_codec</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[H264ç æµä¸­çš„avcCå’ŒAnnex-B]]></title>
    <url>%2F2018%2F01%2F21%2FavcC-annexB%2F</url>
    <content type="text"><![CDATA[è¿‘æœŸç«žç­”ç›´æ’­ç«çƒ­ï¼Œç®€ç›´ç™¾èŠ±é½æ”¾ï¼Œå„å¤§ç›´æ’­è§£å†³æ–¹æ¡ˆæä¾›å•†ä¸ºäº†å¿«é€ŸæŠ¢å ä»½é¢ï¼Œæå‡ºå„ç§é™ä½Žå»¶è¿Ÿï¼ŒåŒæ­¥ç­”é¢˜å¡ä¸Žç›´æ’­ç”»é¢çš„æ–¹æ¡ˆã€‚ å…¶ä¸­ï¼ŒåŒæ­¥ç­”é¢˜å¡ä¸Žç›´æ’­ç”»é¢çš„æ–¹æ¡ˆä¸­ï¼Œæ¯”è¾ƒæ™®éçš„åšæ³•æ˜¯åœ¨H264ç æµçš„SEIä¸­å¢žåŠ ç›¸åº”çš„è‡ªå®šä¹‰ä¿¡æ¯ï¼Œä½¿å¾—æ’­æ”¾å™¨åœ¨è§£ç åˆ°å¯¹åº”çš„ä¿¡æ¯çš„æ—¶å€™å¼¹å‡ºé¢„å…ˆå‡ ç§’ä¸‹å‘çš„ç­”é¢˜å¡ï¼Œå¹¶å¼€å§‹å€’è®¡æ—¶ã€‚ åœ¨è¿™é‡Œï¼Œæ¶‰åŠåˆ°æ’­æ”¾å™¨è§£ç H264ç æµçš„æ–¹å¼ï¼Œæ’­æ”¾å™¨ä½¿ç”¨ä¸åŒçš„è§£ç æ–¹å¼å¯èƒ½å¯¼è‡´SEIè§£æžå¤±è´¥ï¼Œç”šè‡³ç”»é¢æ— æ³•æ­£å¸¸æ’­æ”¾ã€‚ SEIæ˜¯ä»€ä¹ˆå‘¢ï¼ŸSEIæ˜¯NALU typeä¸º6çš„NALUï¼Œå…¨ç§°ä¸ºSupplemental enhancementinformationï¼Œç›´è¯‘ä¸ºè¡¥å……å¢žå¼ºä¿¡æ¯ï¼Œä¸€èˆ¬ç§°ä¸ºå¢žå¼ºå¸§ã€‚æ­¤å¤„æ¶‰åŠåˆ°æ¯”è¾ƒåŸºç¡€çš„ç¼–ç æ‰“åŒ…æ–¹é¢çš„çŸ¥è¯†ï¼Œç¬”è€…ä¹Ÿä¸å¤ªæ¸…æ¥šï¼ŒåŽç»­æŸ¥é˜…èµ„æ–™æžæ˜Žç™½ä¹‹åŽä¸Žå¤§å®¶åˆ†äº«ã€‚ä»Šå¤©å…ˆç†ä¸‹H264æ‰“åŒ…ç æµçš„ä¸¤ç§æ ¼å¼ï¼šavccä¸Žannex-Bã€‚ H264ç¼–ç ç»“æž„è¦è¯´H264çš„æ‰“åŒ…æ–¹å¼ï¼Œé¦–å…ˆè¦è®²ä¸‹H264çš„ç¼–ç ç»“æž„ã€‚ H264ä¸»è¦åˆ†ä¸ºä¸¤å±‚ï¼šç¼–ç å±‚(Video Coding Layerï¼ŒVCL)å’Œç½‘ç»œæŠ½è±¡å±‚(NetworkAbstraction Layer (NAL))ï¼›å‰è€…å®šä¹‰äº†å„ç§ç¼–ç çš„ç®—æ³•ï¼ŒåŽè€…å°†å‰è€…ç¼–ç çš„æ•°æ®æŒ‰ç…§ä¸€å®šçš„æ–¹å¼è¿›è¡Œæ‰“åŒ…å­˜å‚¨æˆ–è€…ä¼ è¾“ã€‚ è€ŒNALå•å…ƒ(NALU)ä½œä¸ºå¯ä»¥å•ç‹¬å¯ä»¥è§£ç çš„ç»“æž„ï¼Œæ•´ä¸ªH264çš„ç æµå¯ä»¥ç†è§£ä¸ºç”±å¤šä¸ªNALUç»„æˆçš„ã€‚ è€ŒNALUç”±å¤´éƒ¨å’Œè´Ÿè·ç»„æˆã€‚ NALUçš„è´Ÿè·ç”±ç§°ä¸ºåŽŸå§‹å­—èŠ‚åºåˆ—è½½è·(Raw Byte Sequence Payload,RBSP)ï¼Œæ˜¯ç”±ä¸€ä¸²æ•°æ®æ¯”ç‰¹ä¸²(String Of Data Bits,SODB)åŠ ä¸Šæœ«å°¾çš„stop-bitsï¼ˆä½¿å¾—æ•´ä¸ªNALUé•¿åº¦æ˜¯8çš„å€æ•°ï¼‰ç»„æˆã€‚ å¦å¤–ï¼Œå…³äºŽRBSPè¿˜æœ‰ä¸€ä¸ªæ¦‚å¿µå«(Encapsulation Byte Sequence Packets,RBSPï¼Œä¸æ¸…æ¥šè¦æ€Žä¹ˆç¿»è¯‘)ã€‚è¿™ä¸ªEBSPæ˜¯åœ¨RBSPçš„åŸºç¡€ä¸Šï¼Œä¸ºäº†é˜²æ­¢ç¼–ç å‡ºæ¥çš„æ¯”ç‰¹æµä¸­æœ‰è·Ÿåˆ†éš”NALUçš„StartCodePrefix(0x00000001)æœ‰å†²çªï¼Œå¯¼è‡´åˆ†éš”NALUå¤±è´¥ã€‚æ‰€ä»¥åœ¨è¿žç»­å‡ºçŽ°ä¸¤ä¸ªå­—èŠ‚ä¸º0æ—¶ï¼Œå¼ºåˆ¶æ’å…¥ä¸€ä¸ª0x03å­—èŠ‚ã€‚åœ¨è§£ç æ—¶ï¼Œå†è®²0x03å­—èŠ‚åˆ é™¤ï¼Œè¿˜åŽŸå›žåŽ»ã€‚ç§°ä¸ºè„±å£³æ“ä½œï¼ˆæœ‰ä¸­æ–‡èµ„æ–™è¿™ä¹ˆç§°å‘¼ï¼Œä¸æ¸…æ¥šæœ‰æ²¡æœ‰è¿™ä¹ˆä¸ªå«æ³•ï¼‰ã€‚ çœ‹åˆ°æœ‰å¤§ç¥žç”¨æ•°å­¦å…¬å¼æ¦‚æ‹¬äº†ä»¥ä¸Šå‡ ä¸ªæ¦‚å¿µçš„å…³ç³»ã€‚æ­¤å¤„start_codeä¸ºannex-bæ ¼å¼ä¸­çš„åˆ†éš”ç¬¦ï¼Œå¯èƒ½æ˜¯ä¸‰å­—èŠ‚çš„0x000001æˆ–è€…å››å­—èŠ‚çš„0x00000001ï¼Œå®žé™…æ¥çœ‹åŽè€…è¾ƒå¤šï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸‹å›¾ä¸€ä¸ªå°ç¼ºé™·ã€‚ NALUå¤´éƒ¨ä¸€ä¸ªå­—èŠ‚è¡¨æ˜Žè¯¥NALUçš„ç±»åž‹ï¼Œæ ‡å‡†å®šä¹‰åˆ—è¡¨å¦‚ä¸‹ï¼š nal_unit_type Content of NAL unit &amp;RBSP syntax structure C NAL unit type class[Annex A] NAL unit type class[Annex G &amp; H] NAL unittype class[Annex I] 0 Unspecified non-VCL non-VCL non-VCL 1 Coded slice of a non-IDR pictureslice_layer_without_partitioning_rbsp( ) 2, 3, 4 VCL VCL VCL 2 Coded slice data partition Aslice_data_partition_a_layer_rbsp( ) 2 VCL not applicable not applicable 3 Coded slice data partition Bslice_data_partition_b_layer_rbsp( ) 3 VCL not applicable not applicable 4 Coded slice data partition Cslice_data_partition_c_layer_rbsp( ) 4 VCL not applicable not applicable 5 Coded slice of an IDR pictureslice_layer_without_partitioning_rbsp( ) 2, 3 VCL VCL VCL 6 Supplemental enhancement information(SEI)sei_rbsp( ) 5 non-VCL non-VCL non-VCL 7 Sequence parameter setseq_parameter_set_rbsp( ) 0 non-VCL non-VCL non-VCL 8 Picture parameter setpic_parameter_set_rbsp( ) 1 non-VCL non-VCL non-VCL 9 Access unit delimiteraccess_unit_delimiter_rbsp( ) 6 non-VCL non-VCL non-VCL 10 End of sequenceend_of_seq_rbsp( ) 7 non-VCL non-VCL non-VCL 11 End of streamend_of_stream_rbsp( ) 8 non-VCL non-VCL non-VCL 12 Filler datafiller_data_rbsp( ) 9 non-VCL non-VCL non-VCL 13 Sequence parameter set extensionseq_parameter_set_extension_rbsp( ) 10 non-VCL non-VCL non-VCL 14 Prefix NAL unitprefix_nal_unit_rbsp( ) 2 non-VCL suffix dependent suffix dependent 15 Subset sequence parameter setsubset_seq_parameter_set_rbsp( ) 0 non-VCL non-VCL non-VCL 16 Depth parameter setdepth_parameter_set_rbsp( ) 11 non-VCL non-VCL non-VCL 17 â€“ 18 Reserved non-VCL non-VCL non-VCL 19 Coded slice of an auxiliary coded picture without partitioningslice_layer_without_partitioning_rbsp( ) 2, 3, 4 non-VCL non-VCL non-VCL 20 Coded slice extensionslice_layer_extension_rbsp( ) 2, 3, 4 non-VCL VCL VCL 21 Coded slice extension for depth viewcomponent or a 3D-AVC texture view component slice_layer_extension_rbsp( ) 2, 3, 4 non-VCL non-VCL VCL 22 â€“ 23 Reserved non-VCL non-VCL VCL 24 â€“ 31 Unspecified non-VCL non-VCL non-VCL åŸºç¡€çŸ¥è¯†è®²å¾—å·®ä¸å¤šäº†ï¼Œä¸‹é¢è¿›å…¥æ­£é¢˜ï¼Œçœ‹ä¸‹ä»€ä¹ˆæ˜¯avccå’Œannexæ‰“åŒ…æ–¹å¼å‘¢ã€‚ ä»¥ä¸Šå·²ç»æè¿‡ï¼ŒH264çš„ç æµæœ‰å¤šä¸ªNALUç»„æˆï¼Œé‚£è¾¹NALUæ˜¯å¦‚ä½•ç»„æˆAVCCçš„å‘¢ï¼Œæ¯ä¸ªNALUåˆè¯¥å¦‚ä½•åŽ»åˆ†éš”å‘¢ï¼Œæ­¤å¤„ä¾¿æ¶‰åŠåˆ°äº†AVCCå’Œannex-Bä¸¤ç§æ ¼å¼ã€‚ avcCavcCçš„ç æµæ‰“åŒ…æ–¹å¼æ˜¯åœ¨æ¯ä¸ªNALUå‰é¢æ·»åŠ ä¸€ä¸ªæ ‡è®°NALUé•¿åº¦çš„å­—æ®µï¼Œè¯¥å­—æ®µå¯èƒ½çš„é•¿åº¦ä¸º1å­—èŠ‚æˆ–è€…2å­—èŠ‚æˆ–è€…4å­—èŠ‚ï¼Œé€šå¸¸ä¸ºäº†ä¿è¯è¯¥å­—æ®µå¯ä»¥è¶³å¤Ÿæè¿°NALUçš„é•¿åº¦ï¼Œä¼šè®¾ç½®ä¸º4ä¸ªå­—èŠ‚ã€‚ è€Œè¯¥å­—èŠ‚çš„é•¿åº¦å¯ä»¥é€šè¿‡è§£æžextradataï¼ˆä¹Ÿç§°ä¸ºsequence headerï¼‰çš„å¤´ä¿¡æ¯æ¥èŽ·å–ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„avcå¤´ã€‚ä»¥ä¸‹ä¸ºè¯¥å¤´éƒ¨ä¿¡æ¯çš„è§£æžæ ¼å¼ï¼š aligned(8) class AVCDecoderConfigurationRecord { unsigned int(8) configurationVersion = 1; unsigned int(8) AVCProfileIndication; unsigned int(8) profile_compatibility; unsigned int(8) AVCLevelIndication; bit(6) reserved = â€˜111111â€™b; unsigned int(2) lengthSizeMinusOne; bit(3) reserved = â€˜111â€™b; unsigned int(5) numOfSequenceParameterSets; for (i=0; i&lt; numOfSequenceParameterSets; i++) { unsigned int(16) sequenceParameterSetLength ; bit(8*sequenceParameterSetLength) sequenceParameterSetNALUnit; } unsigned int(8) numOfPictureParameterSets; for (i=0; i&lt; numOfPictureParameterSets; i++) { unsigned int(16) pictureParameterSetLength; bit(8*pictureParameterSetLength) pictureParameterSetNALUnit; } if( profile_idc == 100 || profile_idc == 110 || profile_idc == 122 || profile_idc == 144 ) { bit(6) reserved = â€˜111111â€™b; unsigned int(2) chroma_format; bit(5) reserved = â€˜11111â€™b; unsigned int(3) bit_depth_luma_minus8; bit(5) reserved = â€˜11111â€™b; unsigned int(3) bit_depth_chroma_minus8; unsigned int(8) numOfSequenceParameterSetExt; for (i=0; i&lt; numOfSequenceParameterSetExt; i++) { unsigned int(16) sequenceParameterSetExtLength; bit(8*sequenceParameterSetExtLength) sequenceParameterSetExtNALUnit; } } } å…¶ä¸­ç¬¬äº”ä¸ªå­—èŠ‚çš„æœ€åŽä¸¤ä½unsigned int(2) lengthSizeMinusOne;ä¾¿æ˜¯ä¸Šè¿°æ ‡è®°NALUé•¿åº¦çš„å­—æ®µçš„é•¿åº¦ã€‚ åœ¨extrdataä¸­è¿˜åŒ…å«äº†SPSçš„ä¸ªæ•°ï¼ŒSPSçš„é•¿åº¦å’ŒSPSï¼Œä»¥åŠPPSçš„ä¸ªæ•°ï¼ŒPPSçš„é•¿åº¦å’ŒPPSã€‚å¯¹äºŽè§£ç å™¨æ¥è¯´ï¼Œä¸Šè¿°å‚æ•°éƒ½ååˆ†é‡è¦ã€‚ Annex-BAnnex-Bæ˜¯æŒ‡H264çš„æ ‡å‡†æ–‡æ¡£ä¸­çš„é™„å½•Bä¸­ç»™çš„H264ç æµæ‰“åŒ…æ–¹å¼ã€‚ç›¸å¯¹äºŽavcCæ¥è¯´ï¼ŒAnnex-Bæ‰“åŒ…æ–¹å¼æ²¡æœ‰å›ºå®šé•¿åº¦çš„å­—æ®µæ¥è¡¨æ˜ŽNALUçš„é•¿åº¦ï¼Œè€Œæ˜¯ä½¿ç”¨å›ºå®šå­—ç¬¦ä¸²æ¥ä½œä¸ºä¸åŒNALUçš„åˆ†éš”ç¬¦ï¼Œæœ‰0x000001å’Œ0x00000001ï¼Œä¹Ÿå°±æ˜¯å‰æ–‡æåˆ°RBSPæ—¶æåˆ°è¿‡çš„START CODESã€‚ä¸ºäº†ä¸ºäº†é˜²æ­¢NALUä¸­æœ¬èº«å¸¦æœ‰0x000001æˆ–è€…0x00000001è€Œå¯¼è‡´çš„è§£æžåˆ†éš”å¤±è´¥ï¼Œå¼•å…¥äº†0x03çš„é˜²æ­¢ç«žäº‰å­—èŠ‚ã€‚è¿™ç§é˜²æ­¢ç«žäº‰æ“ä½œåŒæ ·é€‚ç”¨ä¸ŽavcCæ ¼å¼ã€‚ Annex-Bæ ¼å¼ä¸­çš„SPSå’ŒPPSä¹Ÿä»¥NALUçš„æ–¹å¼æ”¾åœ¨ç æµçš„é¦–éƒ¨ï¼Œä¸åƒavcCéœ€è¦å°†SPSå’ŒPPSæ ¼å¼åŒ–åœ¨extrdataä¸­ã€‚ åŽç»­è´´å‡ å¼ åå…­è¿›åˆ¶çš„å›¾ æ–°å¢žflvå®žä¾‹åˆ†æž2018å¹´1æœˆ25æ—¥AVCsequenceheader 00 00 09 onMetadataç»“æŸä½ 00 00 02 F8 previousTagSize 000002F8H=760Dï¼Œä»£è¡¨å‰tagé•¿åº¦ä¸º760å­—èŠ‚ 09 TagType 09H=09Dï¼Œä»£è¡¨videoï¼ˆ12H=18Dï¼Œscriptï¼›08H=08Dï¼Œaudioï¼‰ 00 00 2D DataSize 00002DH=45Dï¼Œä»£è¡¨å®žé™…çš„TagSizeé•¿åº¦ä¸º45ä¸ªå­—èŠ‚ 00 00 00 æ—¶é—´æˆ³ï¼Œå•ä½æ¯«ç§’ AVCå¤´æ—¶é—´æˆ³ä¸º0 00 æ‰©å±•æ—¶é—´æˆ³ï¼Œå•ä½æ¯«ç§’ï¼Œä½œä¸ºåŸºæœ¬æ—¶é—´æˆ³çš„è¡¥ä½ï¼Œè¡¥åœ¨åŸºæœ¬æ—¶é—´æˆ³çš„é«˜ä½ AVCå¤´æ‰©å±•æ—¶é—´æˆ³ä¸º0 00 00 00 StreamIdï¼Œé»˜è®¤ä¸º0ï¼Œä½œç”¨ä¸æ˜Ž 17 å‰å››ä½ä¸ºFrameTypeï¼Œæ­¤å¤„ä¸º1ï¼Œä»£è¡¨å…³é”®å¸§ 1: keyframe (for AVC, a seekableframe) 2: inter frame(for AVC, a non -seekable frame) 3 : disposable inter frame(H.263only) 4 : generated keyframe(reserved forserver use only) 5 : video info / command frame åŽå››ä½ä¸ºCodecIDï¼Œæ­¤å¤„ä¸º7ï¼Œä»£è¡¨AVCç¼–ç  1: JPEG (currently unused) 2: Sorenson H.263 3 : Screen video 4 : On2 VP6 5 : On2 VP6 with alpha channel 6 : Screen video version 2 7 : AVC ç”±äºŽä¸Šè¿°çš„CodecIDä¸º7ï¼Œæ‰€ä»¥ä¸‹é¢ä¸ºAVCVIDEOPACKET 00 AVCPacketTypeï¼Œæ­¤å¤„ä¸º0ï¼Œä»£è¡¨AVCsequenceheader 0â€“AVC sequence header 1â€“AVC NALU 2â€“AVC end of sequence 00 00 00 ç”±äºŽæ­¤å¤„æ˜¯AVCVIDEOPACKETå†…å®¹ï¼Œè§£æžä¸ºCompositionTime Offsetï¼Œå«ä¹‰ä¸æ˜Ž æŽ¥ä¸‹æ¥ä¸€ä¸²åˆ°ä¸‹ä¸€ä¸ªtagä¹‹å‰çš„PreviousTagSizeéƒ½æ˜¯AVCçš„å†…å®¹ï¼ŒAVCDecoderConfigurationRecordã€‚æ ¹æ®14496-15æ ‡å‡†è§£æžã€‚ 00 00 00 38 è¿™ä¸ªtagçš„å¤§å°ã€‚38H=56Dï¼Œä»£è¡¨è¿™ä¸ªtagé•¿åº¦ä¸º56å­—èŠ‚ã€‚ NAL units 27 AVCçš„éžinter frame 01 AVC NALUæ•°æ® 00 00 00 ç”±äºŽæ­¤å¤„æ˜¯AVCVIDEOPACKETå†…å®¹ï¼Œè§£æžä¸ºCompositionTime Offsetï¼Œå«ä¹‰ä¸æ˜Ž 00 00 00 09 ä¸‹ä¸€ä¸ªNALUçš„é•¿åº¦ä¸º9å­—èŠ‚ 06 NALU headerä¸º6ï¼Œä»£è¡¨ä¸ºNALU typeä¸ºSEI 00 00 0F 61 1B 9B D9 39 NALä¸­çš„å®žé™…å†…å®¹ï¼Œæ­¤é¡¹ä¸ºSEIçš„å†…å®¹ã€‚ 00 00 02 23 ä¸‹ä¸€ä¸ªNALUçš„é•¿åº¦ä¸º223H=563Då­—èŠ‚ 41 9A â€¦ 7E E0 NALUçš„å†…å®¹ å…¶ä¸­ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ºnal headerï¼ŒåŒ…å«ä»¥ä¸‹ä¸‰ä¸ªå†…å®¹ forbidden_zero_bit nal_ref_idc nal_unit_type æ­¤å¤„41H=â€­01 00 00 01â€¬Bï¼Œ é¦–ä½æ˜¯0ï¼Œç¬¦åˆè¦æ±‚ï¼Œè¯­æ³•æ— é”™è¯¯ ç¬¬äºŒä½åˆ°ç¬¬ä¸‰ä½æ˜¯10ï¼Œä»£è¡¨ä¼˜å…ˆçº§æ˜¯2 ç¬¬å››ä½åˆ°ç¬¬å…«ä½ä¸º00001B=1Dï¼Œè¡¨ç¤ºè¯¥nal_unit_header=1ï¼Œä»£è¡¨éžIDRä¸å¯åˆ†åŒºçš„slice 00 00 02 54 ä»£è¡¨å‰é¢flv tag sizeæ˜¯254H=596Då­—èŠ‚ã€‚]]></content>
      <tags>
        <tag>live</tag>
        <tag>video_codec</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[FFmpegæµ‹è¯•åºåˆ—]]></title>
    <url>%2F2018%2F01%2F01%2Fffmpeg-test-stream%2F</url>
    <content type="text"><![CDATA[ç»å¸¸éœ€è¦åšæµ‹è¯•ä»¥åŠåŠŸèƒ½éªŒè¯ï¼Œæ¯æ¬¡éƒ½è¦æ‰¾ä¸ªè§†é¢‘æ–‡ä»¶æˆ–è€…çº¿ä¸Šæ‹‰ä¸€è·¯æµæŽ¨æµã€‚åœ¨æŸäº›æµ‹è¯•åœºæ™¯ä¸‹ï¼Œè§†é¢‘æ–‡ä»¶å’Œçº¿ä¸Šçš„æµéƒ½å­˜åœ¨ä¸€å®šçš„ç çŽ‡æ³¢åŠ¨ï¼Œå¯¹äºŽå®žé™…çš„æµ‹è¯•æ•°æ®æœ‰ä¸€å®šçš„å½±å“ã€‚æ‰€ä»¥éœ€è¦ä¸€è·¯ç çŽ‡ã€å¸§çŽ‡ã€GOPç­‰å‚æ•°å¯è°ƒä¸”å°½å¯èƒ½æ ‡å‡†çš„æµ‹è¯•æµï¼Œå¹¶ä¸”ä½¿ç”¨æ–¹å¼è¦å°½å¯èƒ½çš„ç®€ç­”ï¼Œé€‚ç”¨å¤§å¤šæ•°çš„åœºæ™¯ã€‚ ä¸€èˆ¬æœºå™¨éƒ½å®‰è£…FFmpegï¼Œæ‰€ä»¥æ‰“ç®—ç”¨FFmpegå®žçŽ°æµ‹è¯•æµçš„ç”Ÿæˆã€‚æŸ¥é˜…èµ„æ–™å‘çŽ°FFmpegçš„lavfiè‡ªå¸¦ç®€å•çš„æµ‹è¯•è§†é¢‘ï¼Œåˆ©ç”¨ffmpegæœ¬èº«çš„ä¸€å †ç¼–ç å‚æ•°ä¾¿å¯ä»¥å¾—åˆ°æƒ³è¦çš„æ ‡å‡†æµ‹è¯•æµã€‚ FFmpegå®‰è£…FFmpegçš„å®‰è£…ï¼Œå‚è€ƒå®˜ç½‘çš„æŒ‡å—è¶³çŸ£ã€‚å…¶ä»–çš„å®‰è£…æŒ‡å—å†™å¾—å†å¥½ï¼Œè¿˜æ˜¯æ²¡æœ‰å®˜æ–¹çš„å¥½ï¼Œè€Œä¸”é™„å¸¦ä¸­æ–‡ç‰ˆï¼Œé›†æˆäº†å‡ ä¹Žå¹³æ—¶ç”¨åˆ°çš„æ‰€æœ‰libã€‚ CentOSå®‰è£…FFmpegæŒ‡å— æˆ‘åœ¨ä¸€å°VPSä¸Šå®‰è£…X265åº“çš„æ—¶å€™å‡ºäº†ä¸ªé—®é¢˜ï¼š æˆ‘é€šè¿‡ä»¥ä¸‹æ“ä½œè§£å†³ï¼š å¸è½½yumåŽŸæœ¬çš„yasm yum remove yasm å°†æŒ‰ç…§å®˜æ–¹æŒ‡å—ä¸­å®‰è£…çš„é«˜ç‰ˆæœ¬çš„yasmé“¾æŽ¥åˆ°PATH ln -s /root/bin/yasm/usr/bin/yasm å®‰è£…å®Œæ¯• æµ‹è¯•æµç”Ÿæˆè§†é¢‘åˆ©ç”¨lavfiç”Ÿæˆæµ‹è¯•è§†é¢‘ï¼ŒæŸ¥åˆ°ä»¥ä¸‹è¯´æ˜Žï¼ŒæŒ‰å›¾ç´¢éª¥å³å¯ç”Ÿæˆæµ‹è¯•å›¾åƒã€‚ http://www.bogotobogo.com/FFMpeg/ffmpeg_video_test_patterns_src.php æ­¤å¤„æˆ‘é‡‡ç”¨çš„å‚æ•°å¦‚ä¸‹ï¼Œä½¿ç”¨testsrcè¿™ä¸ªå›¾åƒï¼Œå¾ˆæœ‰å°æ—¶å€™å‘¨äºŒä¸‹åˆçš„å›žå¿†ã€‚ -f lavfi -i "testsrc=size=1920x1080:rate=30:duration=5" å‚æ•°å«ä¹‰ï¼š å‚æ•° å«ä¹‰ testsrc ä½¿ç”¨testsrcä½œä¸ºæµ‹è¯•ç”»é¢ size åˆ†è¾¨çŽ‡ rate å¸§çŽ‡ duration æŒç»­æ—¶é—´ éŸ³é¢‘æµ‹è¯•éŸ³é¢‘é‡‡ç”¨sineæ­£å¼¦æ³¢ã€‚å¯æ¡ä»¶é¢‘çŽ‡ï¼Œé‡‡æ ·çŽ‡ç­‰å‚æ•°ã€‚å…·ä½“å‚è€ƒå®˜ç½‘è¯´æ˜Ž https://lists.ffmpeg.org/pipermail/ffmpeg-cvslog/2013-March/062382.html æ­¤å¤„æˆ‘é‡‡ç”¨çš„å‚æ•°æ˜¯ï¼š -f lavfi -i "sine=frequency=440:sample_rate=44100:beep_factor=4:duration=5" å‚æ•°å«ä¹‰ï¼š å‚æ•° å«ä¹‰ sine ä½¿ç”¨æ­£å¼¦æ³¢ä¿¡å·ä½œä¸ºè¾“å…¥ frequency æ­£å¼¦æ³¢é¢‘çŽ‡ sample_rate éŸ³é¢‘é‡‡æ ·çŽ‡ beep_factor æ¯ç§’äº§ç”Ÿä¸€ä¸ªèœ‚é¸£ï¼Œèœ‚é¸£é¢‘çŽ‡ä¸ºæ­£å¼¦æ³¢é¢‘çŽ‡çš„å››å€ duration æŒç»­æ—¶é—´ åˆæˆæµ‹è¯•æµå°†ä»¥ä¸Šè§†é¢‘å’ŒéŸ³é¢‘ä½œä¸ºFFmpegçš„è¾“å…¥ï¼Œé€šè¿‡ffmpegè‡ªå¸¦çš„ä¸€äº›ç¼–ç å‚æ•°å’Œç çŽ‡æŽ§åˆ¶å‚æ•°è¾“å‡ºã€‚ ffmpeg -f lavfi -i testsrc=duration=5:size=1920x1080:rate=300 \ -f lavfi -i sine=frequency=440:sample_rate=44100:beep_factor=4:duration=5 \ -acodec libfdk_aac \ -vcodec libx264 -bf 0 -b:a 100k -b:v 1900k -bufsize 1000k \ -r 30 -g 30 -sc_threshold 0 \ -profile baseline -pix_fmt yuv420p \ -f flv test.flv è¾“å‡ºç”»é¢å¦‚ä¸‹ï¼š è§‚å¯Ÿç”Ÿæˆçš„test.flvï¼Œå‘ç”Ÿå…¶ç çŽ‡å¹¶ä¸æ˜¯æŒ‡å®šçš„éŸ³é¢‘100kbpsï¼Œè§†é¢‘1900kbpsï¼Œè€Œæ˜¯åªæœ‰730kbpsã€‚ # ffmpeg -i test.flv ... Input #0, flv, from 'test.flv': Metadata: encoder : Lavf58.3.100 Duration: 00:00:05.08, start: 0.000000, bitrate: 730 kb/s Stream #0:0: Video: h264 (Constrained Baseline), yuv420p(progressive), 1920x1080 [SAR 1:1 DAR 16:9], 1900 kb/s, 30 fps, 30 tbr, 1k tbn, 60 tbc Stream #0:1: Audio: aac (LC), 44100 Hz, mono, fltp, 100 kb/s æ— è®ºå¦‚ä½•ä¿®æ”¹æŒ‡å®šçš„ç çŽ‡çš„å€¼ï¼Œè¾“å‡ºç çŽ‡æ€»æ˜¯æ˜Žæ˜¾å°äºŽæŒ‡å®šå€¼ã€‚ æŸ¥é˜…èµ„æ–™åŽï¼Œä½¿ç”¨x264çš„å‚æ•°ï¼Œå¯ç”¨CBRæ¨¡å¼ï¼Œè§£å†³é—®é¢˜ï¼Œç çŽ‡ç¨³å®šåœ¨2000kbpså·¦å³ï¼š ffmpeg -f lavfi -i testsrc=duration=5:size=1920x1080:rate=30 \ -f lavfi -i sine=frequency=440:sample_rate=44100:beep_factor=4:duration=5 \ -acodec libfdk_aac -b:a 100k \ -vcodec libx264 -x264opts bitrate=1900:vbv-maxrate=1900:vbv-bufsize=1000:nal_hrd=cbr \ -r 30 -g 30 -sc_threshold 0 \ -profile baseline -pix_fmt yuv420p \ -f flv test.flv ä»¥ä¸ŠFFmpegå‚æ•°å«ä¹‰ï¼š å‚æ•° å«ä¹‰ -acodec libfdk_aac æŒ‡å®šéŸ³é¢‘ç¼–ç ä¸ºaacæ ¼å¼ -b:a 100k æŒ‡å®šéŸ³é¢‘ç¼–ç è¾“å‡ºç çŽ‡ä¸º100kbps -vcodec libx264 æŒ‡å®šè§†é¢‘ç¼–ç ä¸ºh264æ ¼å¼ -x264opts å¯ç”¨x264å‚æ•° -x264opts bitrate=1900 x264å‚æ•°ï¼šæŒ‡å®šè§†é¢‘è¾“å‡ºç çŽ‡ä¸º1900kbps -x264opts vbv-maxrate=1900 x264å‚æ•°ï¼šæŒ‡å®šè§†é¢‘è¾“å‡ºçš„æœ€é«˜ç çŽ‡ä¸º1900kbps -x264opts vbv-bufsize=1000 x264å‚æ•°ï¼šæŒ‡å®šè§†é¢‘ç¼–ç çš„bufferä¸º1000kb -x264opts nal_hrd=cbr x264å‚æ•°ï¼šè®¾ç½®HRDä¸ºCBRï¼Œä¸¥æ ¼æŒ‰ç…§æŒ‡å®šç çŽ‡è½¬ç  -r 30 æŒ‡å®šè¾“å‡ºå¸§çŽ‡ä¸º30fps -g 30 æŒ‡å®šè¾“å‡ºè§†é¢‘GOPä¸º30å¸§ -sc_threshold 0 è§†é¢‘ç¼–ç å…³é—­ scenecutæ¨¡å¼ï¼Œç”¨ä»¥ä¸å†è‡ªåŠ¨ç”ŸæˆIå¸§ -profile baseline æŒ‡å®šè§†é¢‘ç¼–ç è§„åˆ™ä¸ºbaseline -pix_fmt yuv420p æŒ‡å®šè¾“å‡ºæ•°æ®æ ¼å¼ä¸ºyuv420pï¼Œbaselineåªæ”¯æŒè¿™ç§ -f flv æŒ‡å®šè¾“å‡ºå°è£…ä¸ºflvæ ¼å¼ # ffmpeg -i test1.flv ... Input #0, flv, from 'test1.flv': Metadata: encoder : Lavf58.3.100 Duration: 00:00:05.05, start: 0.000000, bitrate: 1975 kb/s Stream #0:0: Video: h264 (Constrained Baseline), yuv420p(progressive), 1920x1080 [SAR 1:1 DAR 16:9], 1900 kb/s, 30 fps, 30 tbr, 1k tbn, 60 tbc Stream #0:1: Audio: aac (LC), 44100 Hz, mono, fltp, 100 kb/s At least one output file must be specified æ­¤å¤„è§‚å¯ŸFFmpegæ‰“å°çš„æ—¥å¿—å‘çŽ°ï¼Œä¸¤æ¬¡è½¬ç åªåœ¨x264çš„å‚æ•°ä¸Šå·®äº†ä¸€ä¸ªæŒ‡æ ‡ï¼Œå¦‚ä¸‹ä¸¤å›¾ï¼Œä¸‹å›¾æŒ‡å®šäº†nal_hrd=cbrã€‚ é‚£ä¹ˆè¿™ä¸ªnal_hrd=cbråˆæ˜¯ä»€ä¹ˆé¬¼å‘¢ï¼Ÿ HRDï¼Ÿæ²¡æžæ˜Žç™½ä¸Šè¿°ä¸¤è€…çš„å”¯ä¸€åŒºåˆ«ä¾¿æ˜¯nal_hrdæ˜¯å¦æœ‰è®¾ç½®æˆCBRï¼ŒCBR(Constant Bitrate, å¸¸æ•°æ¯”ç‰¹çŽ‡ ) ABR(Average Bitrate)VBR(Variable Bitrate)åªæ˜¯x264æŒ‰ä¸‹ä¸è¡¨ã€‚å¹¶æ²¡æœ‰æŸ¥åˆ°ç›¸å…³èµ„æ–™ï¼Œæ²¡æœ‰æžæ˜Žç™½è¿™äº›è·ŸHRDæœ‰å•¥å…³ç³»ã€‚ å‡æƒ³ç æµè°ƒåº¦å™¨(hypothetical reference decoder, HRD)ï¼Œwikiä¸Šè¯´åœ¨264æ ‡å‡†ä¸­ï¼ŒHRDå·²ç»è¢«VBVä»£æ›¿äº†ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®çš„vbv-maxrateå’Œvbv-bufsizeä¸¤ä¸ªå‚æ•°ã€‚ä¸æ¸…æ¥šä¸ºä»€ä¹ˆè¿˜éœ€è¦è®¾ç½®HRDä¸ºCBRæ¨¡å¼ã€‚ å…³äºŽVBVä¸­vbv-maxrateå’Œvbv-bufsizeä¸¤ä¸ªå‚æ•°çš„å…³ç³»ï¼Œè¿™ä¸ªæ–‡ç« ä¸­æœ‰æ‰€è§£é‡Šï¼šhttp://www.bretl.com/mpeghtml/VBV.HTM å®žé™…ä½¿ç”¨ffmpeg -re -f lavfi -i testsrc=duration=5:size=1920x1080:rate=30 \ -re -f lavfi -i sine=frequency=440:sample_rate=44100:beep_factor=4:duration=5 \ -acodec libfdk_aac -b:a 100k \ -vcodec libx264 -x264opts bitrate=1900:vbv-maxrate=1900:vbv-bufsize=1000:nal_hrd=cbr \ -r 30 -g 30 -sc_threshold 0 \ -profile baseline -pix_fmt yuv420p \ -f flv rtmp://127.0.0.1:1935/xujk.test.com/live/stream]]></content>
      <tags>
        <tag>live</tag>
        <tag>FFmpeg</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç½‘å¡ç¼“å†²å€¼é—®é¢˜-ç»­]]></title>
    <url>%2F2017%2F12%2F23%2FNIC-buffer-issue-Cotinued%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨ipå‘½ä»¤æŸ¥çœ‹ç½‘çŠ¶æ€ã€‚ifconfigå‘½ä»¤å·²å¤šå¹´ä¸å†æ›´æ–°ï¼Œä»ŽCentOS7å¼€å§‹ï¼Œå‘è¡Œç‰ˆçš„miniç³»ç»Ÿå·²ä¸å†è‡ªå¸¦ifconfigå·¥å…·ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ipå‘½ä»¤ã€‚ å…¶å®žè´¨æ˜¯iproute2å¥—ä»¶å–ä»£äº†net-toolså¥—ä»¶ï¼Œifconfigä¾¿æ˜¯åŽè€…ä¸­ä¸€ä¸ªå·¥å…·ã€‚ä¸¤è€…çš„ç®€å•å¯¹æ¯”ï¼Œä»Žç½‘ä¸Šæ‰¾åˆ°å¼ å›¾ï¼š æŸ¥çœ‹ç½‘å¡ç»Ÿè®¡æ•°æ®ä½¿ç”¨ip -s linkæŸ¥çœ‹linkçš„ç»Ÿè®¡æ•°æ®ï¼š ä»¥ä¸Šå„ä¸ªç»Ÿè®¡æŒ‡æ ‡çš„å«ä¹‰ä¸ºï¼š æŒ‡æ ‡ å«ä¹‰ errors ç½‘çº¿æŸåæˆ–è€…ç½‘å¡åå•†æ¨¡å¼é”™è¯¯æˆ–è€…é€ŸçŽ‡ä¸åŒ¹é…å¯¼è‡´çš„é”™è¯¯ã€‚ dropped iptablesæˆ–è€…å…¶ä»–è§„åˆ™æˆ–è€…å†…æ ¸è¯»å–ç½‘å¡æ•°æ®çš„bufferæ»¡å¯¼è‡´çš„ä¸¢åŒ…ã€‚ overrun ç½‘å¡çš„é©±åŠ¨bufferæ»¡å¯¼è‡´çš„overrunsã€‚ carrier ç½‘çº¿æŽ¥è§¦ä¸è‰¯æˆ–è€…ç½‘çº¿æŸåæˆ–è€…äº¤æ¢æœºæ•…éšœã€‚ collsns ä¸€èˆ¬è€Œè¨€æ˜¯0ã€‚è‹¥éžé›¶ï¼Œä»£è¡¨åŒå·¥æ¨¡å¼çš„åå•†é—®é¢˜ã€‚è‹¥æ•°å€¼å¾ˆå°ä¸”ä¸å†å¢žé•¿ï¼Œä»£è¡¨åªæ˜¯åˆšæŽ¥å…¥çš„æ—¶å€™æ•…éšœï¼ŒçŽ°å·²æ­£å¸¸ã€‚ ç½‘å¡bufferç½‘å¡bufferè®¾ç½®ä¸Šç¯‡å·²æåˆ°ï¼Œåœ¨ç½‘å¡ç»Ÿè®¡ä¸­å‡ºçŽ°overrunsæ—¶ï¼Œéœ€è¦ç¡®å®šæ˜¯å¦æ˜¯ç”±äºŽç½‘å¡bufferè®¾ç½®ä¸å½“å¯¼è‡´çš„ã€‚ä½¿ç”¨ethtool -g eth0æŸ¥çœ‹å½“å‰è®¾ç½®ï¼Œå…·ä½“æŸ¥çœ‹ä¸Šç¯‡ã€‚ å€¼å¾—è¯´æ˜Žçš„æ˜¯ï¼Œæ­¤å¤„çš„æ•°å€¼å¤§å°å¹¶ä¸æ˜¯ä»£è¡¨å¯ä»¥ç¼“å†²å¤šå¤§çš„æ•°æ®ï¼Œè€Œæ˜¯æŒ‡å¯ä»¥ç¼“å†²çš„æ•°æ®å¸§(frame)çš„æ•°é‡ã€‚ ç½‘å¡bufferå·¥ä½œåŽŸç†ç½‘å¡bufferä¼šé‡‡ç”¨çŽ¯å½¢ç¼“å†²(ring buffer)çš„å½¢å¼ï¼Œå…¶ä¹Ÿæ˜¯FIFOçš„ä¸€ç§å®žçŽ°æ–¹å¼ï¼Œè®¾è®¡éžå¸¸ç®€å•ï¼Œä¹Ÿæ¯”è¾ƒç¨³å®šï¼Œåœ¨è¾ƒä¸ºåº•å±‚çš„æ•°æ®ä¼ è¾“ä¸­ä½¿ç”¨å¹¿æ³›ã€‚å…¶å·¥ä½œåŽŸç†å¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹wikiã€‚ å…¶ä»–æ³¨æ„äº‹é¡¹æœ‰ä¸¤ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š bufferè®¾ç½®ä½¿ç”¨ethtool -G eth0 rx 256è®¾ç½®æŽ¥æ”¶bufferåŽï¼ŒNICä¼šæœ‰ä¸ªdown/upçš„æ“ä½œï¼Œä¼šå‡ºçŽ°çž¬æ—¶çš„æ–­ç½‘ï¼Œåœ¨ç½‘å¡åžåé‡è¾ƒå¤§æ—¶ï¼Œå‰¯ä½œç”¨æ˜Žæ˜¾ã€‚ å¦å¤–æ¯æ¬¡ç³»ç»Ÿé‡å¯ä¹‹åŽï¼Œè¯¥è®¾ç½®ä¼šå¤±æ•ˆï¼Œéœ€è¦å°†è¯¥è®¾ç½®å‘½ä»¤å†™å…¥å¼€æœºå¯åŠ¨è„šæœ¬/etc/rc.localä¸­ã€‚ å»¶è¿Ÿç½‘å¡çš„bufferå¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œåœ¨æŽ¥å…¥å¸¦å®½è¾ƒä½Žçš„æƒ…å†µä¸‹ï¼Œè®¾ç½®å¾ˆå¤§çš„å¸¦å®½å¯¼è‡´æ•°æ®åŒ…ä¼ è¾“çš„å»¶è¿Ÿã€‚ å¦‚åœ¨1MbpsæŽ¥å…¥å¸¦å®½ï¼ŒMTU=1500å­—èŠ‚çš„æƒ…å†µä¸‹ï¼Œè®¾ç½®tx buffer=256å¸§ã€‚å‡è®¾æ¯ä¸ªåŒ…åˆšå¥½éƒ½æ˜¯1500å­—èŠ‚ï¼Œåˆ™å¡«å……æ»¡bufferéœ€è¦1500*256=384,000å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯3,072,000æ¯”ç‰¹ã€‚1Mbpsæ¯ç§’æœ€å¤šä¼ è¾“1024*1024=1,048,000æ¯”ç‰¹çš„æ•°æ®ï¼Œå½“æœ€æ–°çš„ä¸€ä¸ªåŒ…è¿›å…¥åˆ°bufferçš„æ—¶å€™ï¼Œéœ€è¦3sæ‰èƒ½å‘é€å‡ºåŽ»ï¼Œä¼šé€ æˆ3sçš„æ•°æ®å»¶è¿Ÿã€‚ åœ¨æœ‰å·¨åž‹å¸§(Jumbo Frame)æ—¶ï¼Œæ¯ä¸ªå¸§é•¿åº¦æ›´é•¿ï¼Œå¯¼è‡´éœ€è¦æ›´å¤šçš„æ—¶é—´å……æ»¡bufferï¼Œå»¶è¿Ÿæ›´ä¹…ã€‚ å†…æ ¸å‚æ•°ä»¥ä¸Šæ‰€è¯´çš„bufferå‡æŒ‡çš„æ˜¯ç½‘å¡åŠå…¶é©±åŠ¨ç¨‹åºæ‰€ä½¿ç”¨çš„bufferï¼Œå¦å¤–è¿˜æœ‰ä¸ªå†…æ ¸ä½¿ç”¨çš„bufferï¼Œç”¨ä»¥ä»Žç½‘å¡è¯»å–æ•°æ®å¸§æ‰€ç”¨ï¼Œåœ¨å†…æ ¸å‚æ•°ä¸­è®¾ç½®ã€‚ BQLæ­¤å¤„æœ‰ä¸ªæ¦‚å¿µå«starvation)ï¼Œä¸­æ–‡æœ‰ç¿»è¯‘æˆé¥¿æ­»ï¼Œå³ç½‘å¡ä»Žring bufferè¯»å–æ•°æ®çš„æ—¶å€™ï¼Œbufferä¸­æ²¡æœ‰æ•°æ®ï¼Œæ¬¡æ—¶è®¾å¤‡ç©ºè½¬ä¸€æ¬¡ï¼Œé€ æˆæµªè´¹ï¼Œç§°ä¸ºstarvationã€‚é¿å…starvationæ˜¯ä¸ªååˆ†å¤æ‚çš„é—®é¢˜ï¼Œä¸€ä¸ªæœ‰æ•ˆçš„åŠžæ³•ä¾¿æ˜¯å¢žå¤§ring bufferçš„é•¿åº¦ï¼Œä½¿å¾—å†…æ ¸å¯ä»¥å­˜æ”¾è·Ÿå¤šçš„æ•°æ®åˆ°é˜Ÿåˆ—ä¸­ï¼Œå‡å°‘starvationäº§ç”Ÿçš„æ¦‚çŽ‡ã€‚ ä½†æ˜¯å¢žå¤§ring bufferé•¿åº¦å¯èƒ½ä¼šå¯¼è‡´ä¸ŠèŠ‚ä¸­æè¿°çš„å‘åŒ…å»¶è¿ŸçŽ°è±¡ï¼Œå› æ­¤å‡ºçŽ°äº†BQLã€‚ åœ¨3.3.0å†…æ ¸ä¹‹åŽï¼Œlinux å†…æ ¸è‡ªèº«ä¼šé€šè¿‡å­—èŠ‚é˜Ÿåˆ—é™åˆ¶(Byte Queue Limits,BQL)è‡ªåŠ¨è°ƒæ•´æ•°æ®åŒ…æŽ’é˜Ÿçš„æ•°é‡ï¼Œä»¥é¿å…åœ¨ring bufferä¸­æŽ’é˜Ÿçš„æ•°æ®åŒ…å¤ªå¤šå¯¼è‡´çš„å‘é€å»¶è¿Ÿã€‚å®žè´¨ä¸Šæ˜¯åœ¨IPæ ˆå’Œdrive queueä¹‹é—´åŠ äº†ä¸€å±‚ï¼Œå¯¹è¿›å…¥drive queueçš„æ•°æ®è¿›è¡Œè°ƒåº¦ï¼Œé¿å…é˜Ÿåˆ—æ»¡è€Œå¯¼è‡´å»¶è¿Ÿï¼ŒåŒæ—¶ä¹Ÿå‡å°‘bufferé•¿åº¦ã€‚ è¿™è¾¹æœ‰äº›ç›¸å…³èµ„æ–™ï¼Œç•™ä½œå¤‡ä»½ï¼Œæš‚æ—¶çœ‹ä¸æ‡‚ï¼Œä¹Ÿæ²¡éœ€æ±‚ï¼Œå…ˆä¸çœ‹äº†ã€‚ https://www.linuxplumbersconf.org/2012/wp-content/uploads/2012/08/bql_slide.pdf http://www.linuxplumbersconf.org/2011/ocw/sessions/171 /proc/sys/netIPæ ˆå…è®¸åˆ°ring bufferæŽ’é˜Ÿçš„æ•°æ®åŒ…æ•°é‡å¯ä»¥åœ¨proc/sys/net/core/netdev_max_backlogä¸­è®¾ç½®ã€‚å¦å¤–åœ¨/proc/sys/netå’Œ/etc/sysctl.confä¸­æœ‰å¾ˆå¤šç½‘ç»œç›¸å…³çš„å†…æ ¸å‚æ•°ï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™ç¯‡åšæ–‡ã€‚ å‚æ•°ï¼ˆè·¯å¾„+æ–‡ä»¶ï¼‰ æè¿° é»˜è®¤å€¼ ä¼˜åŒ–å€¼ /proc/sys/net/core/rmem_default é»˜è®¤çš„TCPæ•°æ®æŽ¥æ”¶çª—å£å¤§å°ï¼ˆå­—èŠ‚ï¼‰ã€‚ 229376 256960 /proc/sys/net/core/rmem_max æœ€å¤§çš„TCPæ•°æ®æŽ¥æ”¶çª—å£ï¼ˆå­—èŠ‚ï¼‰ã€‚ 131071 513920 /proc/sys/net/core/wmem_default é»˜è®¤çš„TCPæ•°æ®å‘é€çª—å£å¤§å°ï¼ˆå­—èŠ‚ï¼‰ã€‚ 229376 256960 /proc/sys/net/core/wmem_max æœ€å¤§çš„TCPæ•°æ®å‘é€çª—å£ï¼ˆå­—èŠ‚ï¼‰ã€‚ 131071 513920 /proc/sys/net/core/netdev_max_backlog åœ¨æ¯ä¸ªç½‘ç»œæŽ¥å£æŽ¥æ”¶æ•°æ®åŒ…çš„é€ŸçŽ‡æ¯”å†…æ ¸å¤„ç†è¿™äº›åŒ…çš„é€ŸçŽ‡å¿«æ—¶ï¼Œå…è®¸é€åˆ°é˜Ÿåˆ—çš„æ•°æ®åŒ…çš„æœ€å¤§æ•°ç›®ã€‚ 1000 2000 /proc/sys/net/core/somaxconn å®šä¹‰äº†ç³»ç»Ÿä¸­æ¯ä¸€ä¸ªç«¯å£æœ€å¤§çš„ç›‘å¬é˜Ÿåˆ—çš„é•¿åº¦ï¼Œè¿™æ˜¯ä¸ªå…¨å±€çš„å‚æ•°ã€‚ 128 2048 /proc/sys/net/core/optmem_max è¡¨ç¤ºæ¯ä¸ªå¥—æŽ¥å­—æ‰€å…è®¸çš„æœ€å¤§ç¼“å†²åŒºçš„å¤§å°ã€‚ 20480 81920 /proc/sys/net/ipv4/tcp_mem ç¡®å®šTCPæ ˆåº”è¯¥å¦‚ä½•åæ˜ å†…å­˜ä½¿ç”¨ï¼Œæ¯ä¸ªå€¼çš„å•ä½éƒ½æ˜¯å†…å­˜é¡µï¼ˆé€šå¸¸æ˜¯4KBï¼‰ã€‚ç¬¬ä¸€ä¸ªå€¼æ˜¯å†…å­˜ä½¿ç”¨çš„ä¸‹é™ï¼›ç¬¬äºŒä¸ªå€¼æ˜¯å†…å­˜åŽ‹åŠ›æ¨¡å¼å¼€å§‹å¯¹ç¼“å†²åŒºä½¿ç”¨åº”ç”¨åŽ‹åŠ›çš„ä¸Šé™ï¼›ç¬¬ä¸‰ä¸ªå€¼æ˜¯å†…å­˜ä½¿ç”¨çš„ä¸Šé™ã€‚åœ¨è¿™ä¸ªå±‚æ¬¡ä¸Šå¯ä»¥å°†æŠ¥æ–‡ä¸¢å¼ƒï¼Œä»Žè€Œå‡å°‘å¯¹å†…å­˜çš„ä½¿ç”¨ã€‚å¯¹äºŽè¾ƒå¤§çš„BDPå¯ä»¥å¢žå¤§è¿™äº›å€¼ï¼ˆæ³¨æ„ï¼Œå…¶å•ä½æ˜¯å†…å­˜é¡µè€Œä¸æ˜¯å­—èŠ‚ï¼‰ã€‚ 94011 125351 188022 131072 262144 524288 /proc/sys/net/ipv4/tcp_rmem ä¸ºè‡ªåŠ¨è°ƒä¼˜å®šä¹‰socketä½¿ç”¨çš„å†…å­˜ã€‚ç¬¬ä¸€ä¸ªå€¼æ˜¯ä¸ºsocketæŽ¥æ”¶ç¼“å†²åŒºåˆ†é…çš„æœ€å°‘å­—èŠ‚æ•°ï¼›ç¬¬äºŒä¸ªå€¼æ˜¯é»˜è®¤å€¼ï¼ˆè¯¥å€¼ä¼šè¢«rmem_defaultè¦†ç›–ï¼‰ï¼Œç¼“å†²åŒºåœ¨ç³»ç»Ÿè´Ÿè½½ä¸é‡çš„æƒ…å†µä¸‹å¯ä»¥å¢žé•¿åˆ°è¿™ä¸ªå€¼ï¼›ç¬¬ä¸‰ä¸ªå€¼æ˜¯æŽ¥æ”¶ç¼“å†²åŒºç©ºé—´çš„æœ€å¤§å­—èŠ‚æ•°ï¼ˆè¯¥å€¼ä¼šè¢«rmem_maxè¦†ç›–ï¼‰ã€‚ 4096 87380 4011232 8760 256960 4088000 /proc/sys/net/ipv4/tcp_wmem ä¸ºè‡ªåŠ¨è°ƒä¼˜å®šä¹‰socketä½¿ç”¨çš„å†…å­˜ã€‚ç¬¬ä¸€ä¸ªå€¼æ˜¯ä¸ºsocketå‘é€ç¼“å†²åŒºåˆ†é…çš„æœ€å°‘å­—èŠ‚æ•°ï¼›ç¬¬äºŒä¸ªå€¼æ˜¯é»˜è®¤å€¼ï¼ˆè¯¥å€¼ä¼šè¢«wmem_defaultè¦†ç›–ï¼‰ï¼Œç¼“å†²åŒºåœ¨ç³»ç»Ÿè´Ÿè½½ä¸é‡çš„æƒ…å†µä¸‹å¯ä»¥å¢žé•¿åˆ°è¿™ä¸ªå€¼ï¼›ç¬¬ä¸‰ä¸ªå€¼æ˜¯å‘é€ç¼“å†²åŒºç©ºé—´çš„æœ€å¤§å­—èŠ‚æ•°ï¼ˆè¯¥å€¼ä¼šè¢«wmem_maxè¦†ç›–ï¼‰ã€‚ 4096 16384 4011232 8760 256960 4088000 /proc/sys/net/ipv4/tcp_keepalive_time TCPå‘é€keepaliveæŽ¢æµ‹æ¶ˆæ¯çš„é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œç”¨äºŽç¡®è®¤TCPè¿žæŽ¥æ˜¯å¦æœ‰æ•ˆã€‚ 7200 1800 /proc/sys/net/ipv4/tcp_keepalive_intvl æŽ¢æµ‹æ¶ˆæ¯æœªèŽ·å¾—å“åº”æ—¶ï¼Œé‡å‘è¯¥æ¶ˆæ¯çš„é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰ã€‚ 75 30 /proc/sys/net/ipv4/tcp_keepalive_probes åœ¨è®¤å®šTCPè¿žæŽ¥å¤±æ•ˆä¹‹å‰ï¼Œæœ€å¤šå‘é€å¤šå°‘ä¸ªkeepaliveæŽ¢æµ‹æ¶ˆæ¯ã€‚ 9 3 /proc/sys/net/ipv4/tcp_sack å¯ç”¨æœ‰é€‰æ‹©çš„åº”ç­”ï¼ˆ1è¡¨ç¤ºå¯ç”¨ï¼‰ï¼Œé€šè¿‡æœ‰é€‰æ‹©åœ°åº”ç­”ä¹±åºæŽ¥æ”¶åˆ°çš„æŠ¥æ–‡æ¥æé«˜æ€§èƒ½ï¼Œè®©å‘é€è€…åªå‘é€ä¸¢å¤±çš„æŠ¥æ–‡æ®µï¼Œï¼ˆå¯¹äºŽå¹¿åŸŸç½‘é€šä¿¡æ¥è¯´ï¼‰è¿™ä¸ªé€‰é¡¹åº”è¯¥å¯ç”¨ï¼Œä½†æ˜¯ä¼šå¢žåŠ å¯¹CPUçš„å ç”¨ã€‚ 1 1 /proc/sys/net/ipv4/tcp_fack å¯ç”¨è½¬å‘åº”ç­”ï¼Œå¯ä»¥è¿›è¡Œæœ‰é€‰æ‹©åº”ç­”ï¼ˆSACKï¼‰ä»Žè€Œå‡å°‘æ‹¥å¡žæƒ…å†µçš„å‘ç”Ÿï¼Œè¿™ä¸ªé€‰é¡¹ä¹Ÿåº”è¯¥å¯ç”¨ã€‚ 1 1 /proc/sys/net/ipv4/tcp_timestamps TCPæ—¶é—´æˆ³ï¼ˆä¼šåœ¨TCPåŒ…å¤´å¢žåŠ 12ä¸ªå­—èŠ‚ï¼‰ï¼Œä»¥ä¸€ç§æ¯”é‡å‘è¶…æ—¶æ›´ç²¾ç¡®çš„æ–¹æ³•ï¼ˆå‚è€ƒRFC 1323ï¼‰æ¥å¯ç”¨å¯¹RTT çš„è®¡ç®—ï¼Œä¸ºå®žçŽ°æ›´å¥½çš„æ€§èƒ½åº”è¯¥å¯ç”¨è¿™ä¸ªé€‰é¡¹ã€‚ 1 1 /proc/sys/net/ipv4/tcp_window_scaling å¯ç”¨RFC 1323å®šä¹‰çš„window scalingï¼Œè¦æ”¯æŒè¶…è¿‡64KBçš„TCPçª—å£ï¼Œå¿…é¡»å¯ç”¨è¯¥å€¼ï¼ˆ1è¡¨ç¤ºå¯ç”¨ï¼‰ï¼ŒTCPçª—å£æœ€å¤§è‡³1GBï¼ŒTCPè¿žæŽ¥åŒæ–¹éƒ½å¯ç”¨æ—¶æ‰ç”Ÿæ•ˆã€‚ 1 1 /proc/sys/net/ipv4/tcp_syncookies è¡¨ç¤ºæ˜¯å¦æ‰“å¼€TCPåŒæ­¥æ ‡ç­¾ï¼ˆsyncookieï¼‰ï¼Œå†…æ ¸å¿…é¡»æ‰“å¼€äº†CONFIG_SYN_COOKIESé¡¹è¿›è¡Œç¼–è¯‘ï¼ŒåŒæ­¥æ ‡ç­¾å¯ä»¥é˜²æ­¢ä¸€ä¸ªå¥—æŽ¥å­—åœ¨æœ‰è¿‡å¤šè¯•å›¾è¿žæŽ¥åˆ°è¾¾æ—¶å¼•èµ·è¿‡è½½ã€‚ 1 1 /proc/sys/net/ipv4/tcp_tw_reuse è¡¨ç¤ºæ˜¯å¦å…è®¸å°†å¤„äºŽTIME-WAITçŠ¶æ€çš„socketï¼ˆTIME-WAITçš„ç«¯å£ï¼‰ç”¨äºŽæ–°çš„TCPè¿žæŽ¥ ã€‚ 0 1 /proc/sys/net/ipv4/tcp_tw_recycle èƒ½å¤Ÿæ›´å¿«åœ°å›žæ”¶TIME-WAITå¥—æŽ¥å­—ã€‚ 0 1 /proc/sys/net/ipv4/tcp_fin_timeout å¯¹äºŽæœ¬ç«¯æ–­å¼€çš„socketè¿žæŽ¥ï¼ŒTCPä¿æŒåœ¨FIN-WAIT-2çŠ¶æ€çš„æ—¶é—´ï¼ˆç§’ï¼‰ã€‚å¯¹æ–¹å¯èƒ½ä¼šæ–­å¼€è¿žæŽ¥æˆ–ä¸€ç›´ä¸ç»“æŸè¿žæŽ¥æˆ–ä¸å¯é¢„æ–™çš„è¿›ç¨‹æ­»äº¡ã€‚ 60 30 /proc/sys/net/ipv4/ip_local_port_range è¡¨ç¤ºTCP/UDPåè®®å…è®¸ä½¿ç”¨çš„æœ¬åœ°ç«¯å£å· 32768 61000 1024 65000 /proc/sys/net/ipv4/tcp_max_syn_backlog å¯¹äºŽè¿˜æœªèŽ·å¾—å¯¹æ–¹ç¡®è®¤çš„è¿žæŽ¥è¯·æ±‚ï¼Œå¯ä¿å­˜åœ¨é˜Ÿåˆ—ä¸­çš„æœ€å¤§æ•°ç›®ã€‚å¦‚æžœæœåŠ¡å™¨ç»å¸¸å‡ºçŽ°è¿‡è½½ï¼Œå¯ä»¥å°è¯•å¢žåŠ è¿™ä¸ªæ•°å­—ã€‚ 2048 2048 /proc/sys/net/ipv4/tcp_low_latency å…è®¸TCP/IPæ ˆé€‚åº”åœ¨é«˜åžåé‡æƒ…å†µä¸‹ä½Žå»¶æ—¶çš„æƒ…å†µï¼Œè¿™ä¸ªé€‰é¡¹åº”è¯¥ç¦ç”¨ã€‚ 0 /proc/sys/net/ipv4/tcp_westwood å¯ç”¨å‘é€è€…ç«¯çš„æ‹¥å¡žæŽ§åˆ¶ç®—æ³•ï¼Œå®ƒå¯ä»¥ç»´æŠ¤å¯¹åžåé‡çš„è¯„ä¼°ï¼Œå¹¶è¯•å›¾å¯¹å¸¦å®½çš„æ•´ä½“åˆ©ç”¨æƒ…å†µè¿›è¡Œä¼˜åŒ–ï¼Œå¯¹äºŽWAN é€šä¿¡æ¥è¯´åº”è¯¥å¯ç”¨è¿™ä¸ªé€‰é¡¹ã€‚ 0 /proc/sys/net/ipv4/tcp_bic ä¸ºå¿«é€Ÿé•¿è·ç¦»ç½‘ç»œå¯ç”¨Binary Increase Congestionï¼Œè¿™æ ·å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨ä»¥GBé€Ÿåº¦è¿›è¡Œæ“ä½œçš„é“¾æŽ¥ï¼Œå¯¹äºŽWANé€šä¿¡åº”è¯¥å¯ç”¨è¿™ä¸ªé€‰é¡¹ã€‚ 1 1 å‚è€ƒèµ„æ–™QUEUEING IN THE LINUX NETWORK STACK è¿™è¾¹æ–‡ç« åŒ…ç½—äº†å¾ˆå¤šå†…å®¹ï¼Œéžå¸¸å€¼å¾—ç»†åº¦ã€‚]]></content>
      <tags>
        <tag>LINUX</tag>
        <tag>network</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç½‘å¡ç¼“å†²å€¼é—®é¢˜]]></title>
    <url>%2F2017%2F12%2F17%2FNIC-buffer-issue%2F</url>
    <content type="text"><![CDATA[è¿‘æœŸé‡åˆ°ä¸€å°æŽ¨æµçš„æœºå™¨ï¼Œåé¦ˆæŽ¨æµå¡é¡¿ï¼ŒæŸ¥çœ‹ç¡®å®žæ•´ä½“ä¸¢å¸§çŽ‡è¾ƒé«˜ã€‚ä½†æœºå™¨æ€§èƒ½æ­£å¸¸ï¼Œæœªè§æ˜Žæ˜¾è·‘é«˜çŽ°è±¡ã€‚ifconfigå‘çŽ°ç½‘å¡droppedå’Œoverrunsé«˜ï¼Œå¹¶ä¸”æœ‰æŒç»­å¢žé«˜çš„çŽ°è±¡ã€‚ ç¡®è®¤äº¤æ¢æœºä»¥åŠç½‘çº¿æ— å¼‚å¸¸åŽï¼Œæœ€ç»ˆå‘çŽ°ç½‘å¡ç¼“å­˜å€¼è®¾ç½®è¿‡å°ï¼Œå¯¼è‡´åœ¨å¤§é‡æŽ¥æ”¶æ•°æ®çš„æƒ…å†µä¸‹ï¼Œå‡ºçŽ°overrunsçš„çŽ°è±¡ã€‚ ç½‘ç»œé€»è¾‘æ¨¡åž‹åŠè·¯å‡ºå®¶ï¼Œå¯¹äºŽç½‘ç»œçš„ä¸œè¥¿ä¸€ç›´ä¸€çŸ¥åŠè§£ï¼Œé¡ºä¾¿å­¦ä¹ ä¸‹ç½‘ç»œæ¨¡åž‹å§ã€‚ ç½‘ç»œçš„é€»è¾‘æ¨¡åž‹ï¼Œæœ€è¿‘åœ¨è±†ç“£è¯»ä¹¦çœ‹åˆ°ä¸€ä¸ªå¾ˆå¥½çš„ä»‹ç»ï¼Œç‚¹å‡»é˜…è¯»ï¼Œæƒ³ä¸åˆ°è±†ç“£ä¹Ÿæœ‰æŠ€æœ¯æ–‡ç« ã€‚ ç‰©ç†å±‚å„ç§ç‰©ç†ä¿¡å·ï¼Œå¦‚ç”µåŽ‹ã€äº®åº¦ï¼ŒæŒ¯å¹…ç­‰è¡¨ç¤º0101010çš„äºŒè¿›åˆ¶ä¿¡æ¯ã€‚ é“¾æŽ¥å±‚ä¹Ÿç§°ä¸ºæ•°æ®é“¾è·¯å±‚ï¼Œé€šè¿‡ç‰©ç†å¯»å€ï¼Œå°†æ¯”ç‰¹æµè½¬åŒ–ä¸ºé€»è¾‘æ•°æ®ï¼Œä½¿ç”¨åˆ°macåœ°å€ã€‚å°†æ¯”ç‰¹æµåŒ…è£…ä¸ºå¸§ï¼Œå¸§ä¸­åŒ…å«æœ‰æ¥æºåœ°å€(Source, SRC)å’Œç›®çš„åœ°å€(Destination, DST)ï¼Œèƒ½å¤ŸæŽ¢æµ‹é”™è¯¯çš„æ ¡éªŒåºåˆ—(Frame Check Sequence)ã€æ•°æ®åŒº (payload)ä¸Žæ•°æ®ç›¸é…å¥—çš„æ•°æ®ç±»åž‹(Type)ä¿¡æ¯ã€‚ ç½‘ç»œå±‚é€šè¿‡ç½‘å…³(gateway)ï¼ˆé€šå¸¸ç”±è·¯ç”±å™¨æˆ–è€…ä¸‰å±‚äº¤æ¢æœºå®žçŽ°ï¼‰ï¼Œæ”¹å†™å¸§çš„æ ¼å¼ï¼Œå°†ä¸€ä¸ªå­ç½‘çš„æ•°æ®å¸§è½¬å‘åˆ°å¦ä¸€ä¸ªå­ç½‘ï¼Œå®žçŽ°ä¸åŒå­ç½‘ä¹‹é—´çš„é€šä¿¡ï¼Œä½¿ç”¨åˆ°IPåœ°å€ã€‚ ä¼ è¾“å±‚è¿›ç¨‹é—´é€šä¿¡ï¼Œå¦‚TCPå’ŒUDPä½¿ç”¨ç«¯å£å·åŒºåˆ†ä¸åŒè¿›ç¨‹ã€‚ åº”ç”¨å±‚HTTPï¼ŒFTPç­‰ï¼Œæ›´ä¸ºé«˜çº§çš„æœ‰å„ä¸ªç¨‹åºè‡ªå®šä¹‰çš„é€»è¾‘ã€‚ ç½‘å¡æ”¶åŒ…åŠŸèƒ½ç½‘å¡æ˜¯ç‰©ç†å±‚å’Œæ•°æ®é“¾è·¯å±‚è®¾å¤‡ã€‚ç”±äºŽå‘æ•°æ®åŸºæœ¬ä¸ä¼šå‡ºçŽ°ä¸¢åŒ…çš„çŽ°è±¡ï¼Œæ­¤å¤„æ”¯æŒæ”¶æ•°æ®çš„é—®é¢˜ã€‚ ç½‘å¡æŽ¥æ”¶åˆ°å¸§æ•°æ®åŽï¼Œé¦–å…ˆæ ¹æ®å¤´éƒ¨çš„åºè¨€(preamble)ï¼ˆç”¨äºŽè°ƒæ•´æ—¶é’Ÿï¼‰ã€å¸§çš„èµ·å§‹ä¿¡å·(SFD, start frame delimiter)ã€ç›®çš„åœ°(DST, destination)å’Œå‘å‡ºåœ°(SRC, source)ã€ç±»åž‹(Type)å’Œå°¾éƒ¨çš„æ ¡éªŒåºåˆ—(CRC)ï¼ˆç”¨äºŽæ ¡éªŒæ•°æ®æ˜¯å¦å®Œæ•´ï¼‰è¿™äº›ä¿¡æ¯è¿›è¡Œæ ¡éªŒï¼ŒéšåŽé€šè¿‡ç¡¬ä¸­æ–­å°†å¸§copyåˆ°å†…å­˜ï¼Œäº¤ç”±å†…æ ¸å¤„ç†ã€‚ ç½‘å¡ç¼“å†²å€¼æ­¤å¤„æ¶‰åŠåˆ°çš„ç¼“å†²æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªä¸ºç½‘å¡çš„ç¡¬ä»¶ç¼“å†²ï¼Œå¦ä¸€ä¸ªæ˜¯å†…æ ¸çš„ç¼“å†²ã€‚ç½‘å¡é©±åŠ¨ä¼šé‡‡ç”¨ç¡¬ä¸­æ–­çš„æ–¹å¼å°†æŽ¥æ”¶åˆ°çš„æ•°æ®ä»Žç¡¬ä»¶ç¼“å†²copyåˆ°å†…æ ¸ç¼“å†²ã€‚ ä½¿ç”¨ethtoolå·¥å…·å¯ä»¥æŸ¥çœ‹è®¾ç½®å½“å‰ç½‘å¡ç¼“å†²å€¼çš„å¤§å°ã€‚ethtool -g eth0 å›¾ä¸­ä¸Šé¢çš„æ•°å€¼è¡¨ç¤ºç½‘å¡æ”¯æŒçš„æœ€å¤§ç¼“å†²å€¼ï¼Œä¸‹é¢çš„è¡¨ç¤ºç›®å‰è®¾ç½®çš„å€¼ã€‚å¯ä»¥ä½¿ç”¨ethtool -G eth0 rx 128 ç½‘ä¸Šèµ„æ–™åé¦ˆè®¾ç½®ç¼“å†²å€¼ä¼šå¯¼è‡´ç½‘ç»œdown/upï¼Œçž¬æ—¶ç½‘ç»œä¸­æ–­ã€‚å®žé™…è®¾ç½®æ—¶ï¼Œæ¦‚çŽ‡æ€§å‡ºçŽ°ç½‘ç»œä¸­æ–­ã€‚åŽŸå› ä¸æ˜Žã€‚ å¦å¤–æ³¨æ„çš„æ˜¯ï¼Œæ”¹è®¾ç½®åªæ˜¯ä¸´æ—¶ç”Ÿæ•ˆï¼Œæ¯æ¬¡ç³»ç»Ÿé‡å¯æ—¶ï¼Œä¼šé‡æ–°è®¾ç½®ï¼Œæœ€å¥½çš„åŠžæ³•æ˜¯å°†å‘½ä»¤åŠ å…¥å¼€æœºæ‰§è¡Œrc.localã€‚ å¦å¦å¤–ï¼šç½‘å¡ç¼“å†²å€¼åˆ†ä¸ºæ™®é€šfifo bufferå’Œring buffer çŽ¯å½¢ç¼“å†²ï¼Œç­‰å­¦ä¹ ä¹‹åŽå†è¡¥å……ã€‚]]></content>
      <tags>
        <tag>LINUX</tag>
        <tag>network</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åä¸€æœˆçš„ä¸€äº›å°æƒ³æ³•ï¼ˆä¸‰ï¼‰]]></title>
    <url>%2F2017%2F11%2F25%2Fmeander-in-November-3%2F</url>
    <content type="text"><![CDATA[ä¹¦æŽ¥ä¸Šå›žã€‚ æƒ³è¿™ä¹ˆå¤šæœ‰çš„æ²¡çš„ï¼Œå®žåœ¨æ˜¯ä¸¢äººçŽ°çœ¼ï¼Œè®²ç‚¹æ­£äº‹å§ã€‚ å…³äºŽç¬”è®°ä¸ŠåŠå¹´ä»¥æ¥ï¼Œå…¬å¸å¼€å§‹å¯¹äºŽå‘˜å·¥æƒé™åšå„ç§é™åˆ¶ä¸Žè§„èŒƒï¼Œå¯¹äºŽç½‘ç›˜å’ŒUSBä¹Ÿæœ‰é™åˆ¶ã€‚å¯¹äºŽå·¥ä½œæ•ˆçŽ‡å’Œå…¬å¸å†…éƒ¨èµ„æ–™å®‰ä¿çš„å–èˆä¸åšè¯„ä»·ã€‚è¦åæ§½çš„æ˜¯ï¼Œå…¬å¸ä¹Ÿç¦æ­¢äº†å„ç§äº‘ç¬”è®°ï¼Œç¡®å®žä¸æ–¹ä¾¿çš„å¾ˆã€‚äº’è”ç½‘è¯žç”ŸäºŽè‡ªç”±åˆ†äº«ï¼Œç¡®ä¹ŽçŽ°ä»Šçš„ä¸»é¢˜æ—©å·²ä¸æ˜¯è‡ªç”±åˆ†äº«äº†ã€‚ å…³äºŽç¬”è®°è½¯ä»¶ï¼Œå…¶å®žæŽ¥è§¦å¾—è¿˜æ˜¯è›®æ—©çš„ï¼Œåœ¨12å¹´å°±å¼€å§‹ä½¿ç”¨æœ‰é“äº‘ç¬”è®°è®°å½•äº›å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿äº†ã€‚ä¸è¿‡å­¦ç”Ÿæ—¶ä»£çœŸçš„è¦è®°çš„ä¸œè¥¿å°‘å¾—å¯æ€œï¼Œå¤šçš„å€’æ˜¯äº›æ— ç—…å‘»åŸçš„çµ®å¨ã€‚çŽ°åœ¨å·²ç»ä¸å¿å¿ƒæ‰“å¼€çœ‹äº†ï¼Œå¤ªç¾žè€»ðŸ˜…ã€‚ 13å¹´çš„æ—¶å€™ï¼Œå‚åŠ ä¸€åœºå…³äºŽè®¾è®¡çš„è®²åº§åˆ†äº«ï¼Œä¸€ä½å§‘å¨˜çš„æ¡ˆä¾‹æ˜¯å°è±¡ç¬”è®°ã€‚Evernoteä¸­æ–‡ç¿»è¯‘æˆå°è±¡ç¬”è®°ï¼Œä¸ä»…è·Ÿlogoå¥‘åˆï¼Œè€Œä¸”æœ‰ä¸ªè¯´æ³•æ˜¯å¤§è±¡æ°¸è¿œä¸ä¼šå¿˜è®°ï¼Œç¿»è¯‘æˆå°è±¡ç¬”è®°ååˆ†å·§å¦™ï¼Œæµ‘ç„¶å¤©æˆã€‚è¿™ç‚¹æˆ‘å€’æ˜¯ä¹Ÿæ°¸è¿œä¸ä¼šå¿˜è®°äº†ã€‚äºŽæ˜¯ä¹Žï¼Œä¹Ÿç”¨äº†æ®µæ—¶é—´çš„å°è±¡ç¬”è®°ã€‚éšç€å°è±¡ç¬”è®°æ…¢æ…¢æ›´æ–°è¿­ä»£ï¼Œå…¶åŠŸèƒ½è¶Šæ¥è¶Šå¤æ‚ï¼Œä¹Ÿè¶Šæ¥è¶Šåƒèµ„æºï¼Œç”¨å¾—è¶Šæ¥è¶Šå°‘ã€‚ 15å¹´ï¼Œå¤§ä¸‰å¥½å¤šè¯¾æ²¡é€‰ä¸Šï¼Œæ²¡äº‹å¹²ï¼Œå±…ç„¶èŒç”Ÿäº†å†™æœ¬å°è¯´çš„å¦„æƒ³ðŸ˜‚ã€‚å’¸é±¼æ·˜äº†å°Microsoftçš„surfaceï¼Œæœ‰ç©ºå°±åŽ»å›¾ä¹¦é¦†ç å­—ã€‚å°è¯´è‚¯å®šæµäº§äº†ã€‚ä¸è¿‡surfaceç¡®å®žæƒŠè‰³åˆ°æˆ‘äº†ï¼Œè¢«åˆ«äººé—®èµ·è®¾å¤‡æ˜¯ä»€ä¹ˆçš„æ—¶å€™ä¹Ÿæ˜¯é€¼æ ¼æ»¡æ»¡ã€‚ä¹Ÿè®©æˆ‘ç¬¬ä¸€æ¬¡æŽ¥è§¦äº†åˆ°OneNoteã€‚ ä¸å¾—ä¸è¯´ï¼Œofficeçš„ç”Ÿæ€å¤ªæ— æ•Œï¼ŒOneNoteå‡ºç”Ÿå°±æ˜¯å«ç€é‡‘æ±¤åŒ™çš„ã€‚ä½œä¸ºAndroidå’ŒIOSçš„é¡¶çº§å¼€å‘è€…å’Œè‡ªå®¶UWPå¹³å°çš„ä¸€èˆ¬èˆ¬å¼€å‘è€…ï¼ŒOneNoteæœ¬èº«å¤šå¹³å°çš„åº”ç”¨è´¨é‡è¿˜æ˜¯éžå¸¸ä¸é”™çš„ã€‚linuxå°±ä¸ç®¡äº†ï¼Œæ‰ä¸è£…é€¼çš„ç”¨linuxç³»ç»ŸåŠžå…¬å‘¢ã€‚é™¤äº†ä¸æ”¯æŒmarkdownä»¥åŠå¤åˆ¶é»˜è®¤ç²˜è´´å›¾ç‰‡å¤–ï¼Œå¯¹äºŽæˆ‘æ¥è¯´åŸºæœ¬å·²ç»æ»¡è¶³äº†ã€‚markdownæ²¡æœ‰ä¹Ÿé—®é¢˜ä¸å¤§ï¼ŒåŸºæœ¬æŽ’ç‰ˆOneNoteä¹Ÿæ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚é‡è¦çš„æ˜¯å…è´¹å’ŒåŽé¢æœ‰å¾®è½¯çˆ¸çˆ¸ï¼Œæ”¾å¿ƒã€‚ ä¹‹åŽåˆ°å·¥ä½œè‡³ä»Šï¼Œä¸€ç›´ä½¿ç”¨çš„æ˜¯OneNoteï¼Œéšç€ç¬”è®°æ¡æ•°è¶Šæ¥è¶Šå¤šï¼Œæƒ¯æ€§ä¹Ÿéšä¹‹å˜å¤§ï¼Œå·²ç»ä¸èƒ½åƒä»¥å‰ä¸€æ ·éšä¾¿ä»Žäº‘ç¬”è®°Aè¿åˆ°äº‘ç¬”è®°Bäº†ã€‚å› æ­¤ç¬”è®°åŠæ—¶æ•´ç†å’Œç¬”è®°çš„åˆ†é—¨åˆ«ç±»å˜å¾—å°¤ä¸ºé‡è¦ã€‚ å·¥ä½œä»¥åŽOneNoteé‡Œå¡žäº†ä¸€å †ä¸œè¥¿ï¼ŒåŸºæœ¬éƒ½æ”¾åœ¨å‡ ä¸ªtabé‡Œï¼Œæ•°é‡å¤šäº†ä¹‹åŽä¸¥é‡å½±å“äº†åŽç»­æŸ¥é˜…ï¼Œç»ˆäºŽè¿˜æ˜¯èŠ±äº†ä¸€ä¸ªå‘¨å…­ï¼ŒæŠŠOneNoteæ•´ç†äº†ä¸‹ï¼Œåˆ é™¤äº†å¤§é‡ä¹±ä¸ƒå…«ç³Ÿå·²ç»æ²¡æœ‰ç”¨çš„è®°å½•ï¼Œå°†ä¸€äº›è®°å½•è¿›è¡Œå½’æ¡£ï¼Œä½¿å¾—æ•´ä¸ªç¬”è®°æœ¬æ›´æœ‰å±‚æ¬¡ã€‚å…·ä½“æ€Žä¹ˆæ•´ç†æ˜¯æ¯ä¸ªäººè‡ªå·±çš„æƒ³æ³•é—®é¢˜äº†ï¼Œä»Žæ²¡æœ‰å®šè®ºã€‚è´´å¼ å›¾ðŸ˜œ å·¥å…·æŠ€èƒ½å·¥ä½œå½“ä¸­ï¼Œç»å¸¸éœ€è¦ä»Žå¤§é‡çš„æ—¥å¿—ä¸­åˆ†æžæŸäº›æŒ‡æ ‡ï¼ŒæŽ’æŸ¥é—®é¢˜ã€‚å¸¸è§„çš„å·¥å…·ï¼ŒExcelå’Œshellå·²ç»è¶³å¤Ÿã€‚linuxå†…ç½®çš„awkã€sedç­‰å·¥å…·å·²ç»è¶³å¤Ÿå¼ºå¤§åˆ°å¯ä»¥æ»¡æ—å‡ ä¹Žæ‰€æœ‰çš„æ—¥å¸¸æ—¥å¿—æ•°æ®å¤„ç†éœ€è¦ã€‚ æ‰€ä»¥ä¹Ÿä¸€ç›´æ²¡æœ‰è€ƒè™‘æ˜¯å¦è¦å­¦ä¹ å¦å¤–çš„å·¥å…·ã€‚ è¿‘æœŸé‡åˆ°ä¸ªåœºæ™¯æ˜¯ï¼Œéœ€è¦å°†å¤šä¸ªç»ˆç«¯çš„æ•°æ®å®žæ—¶åŒæ­¥ä¸€å°ä¸­å¿ƒæœºå™¨ä¸Šã€‚è€Œå…¬å¸çš„æœºå™¨éƒ½æœ‰å®‰å…¨é™åˆ¶ï¼Œæ— æ³•è‡ªè¡Œå®‰è£…è½¯ä»¶ï¼Œä¸”ç»ˆç«¯æ•°é‡è¾ƒå¤šï¼Œä¸æ–¹ä¾¿æ“ä½œã€‚è€ƒè™‘è¿‡å°†æ•°æ®è½åœ°åˆ°ç£ç›˜ï¼Œå®šæ—¶èµ·ä¸ªrsyncå°†æ•°æ®åŒæ­¥åˆ°ä¸­å¿ƒæœºå™¨ä¸Šã€‚ç”±äºŽå®‰å…¨é™åˆ¶ï¼Œç»ˆç«¯ä¹‹é—´æ— æ³•ç›´æŽ¥è¿›è¡Œrsyncæ“ä½œï¼ˆèŽ·å–ä¸åˆ°ç”¨æˆ·æƒé™ï¼‰ã€‚ æ°å¥½æœ€è¿‘åœ¨è€ƒè™‘æ˜¯ä¸æ˜¯å­¦ä¹ ä¸‹pythonï¼Œè§‰å¾—pythonç¡®å®žåœ¨æŸäº›æ–¹é¢æœ‰ç‹¬åˆ°çš„ä¼˜åŠ¿ã€‚è€Œä¸”pythonè¿™ä¹ˆå¤šmodulesï¼Œå®žçŽ°æŸäº›åŠŸèƒ½æ¯”shellç®€å•å¤ªå¤šäº†ã€‚ ç»åŒäº‹æŽ¨èï¼Œå¤§æ¦‚çœ‹äº†ä¸‹å»–é›ªå³°çš„pythonæ•™ç¨‹ï¼Œåœ¨ä¸­å¿ƒæœºå™¨ä¸Šç”¨pythonèµ·äº†ä¸ªç®€å•çš„HTTPServerï¼ŒæŽ¥æ”¶ç»ˆç«¯æœºå™¨postè¿‡æ¥çš„æ•°æ®ï¼Œå¹¶åšäº†ç®€å•å¤„ç†ã€‚åœ¨ç»ˆç«¯æœºæ•°é‡ä¸€å®šçš„æƒ…å†µï¼Œå¯ä»¥æ»¡è¶³è¦æ±‚äº†ã€‚ ä¸€äº›æ„Ÿæ‚Ÿï¼š èº«ä¸ºäº§å“å·¥ç¨‹å¸ˆï¼ˆå…¬å¸çš„èŒä½è¿™ä¹ˆå†™çš„ðŸ˜‚ï¼‰ï¼Œæœ‰äº›å·¥å…·è¿˜æ˜¯æœ€å¥½æŽŒæ¡ä¸‹çš„ï¼Œå¯¹äºŽå®žé™…å·¥ä½œå¸®åŠ©å¾ˆå¤§ã€‚ pythonç¡®å®žæ˜¯å¼ºå¤§çš„å¾ˆï¼Œä½†æ˜¯é€šç”¨æ€§å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œåœ¨ç±»ä¼¼å…¬å¸è¿™é‡Œé™åˆ¶å¾ˆå¼ºçš„æœºå™¨ä¸Šå¹¶ä¸ä¸€å®šéƒ½èƒ½è·‘èµ·æ¥ã€‚è€Œshellè™½ç„¶æœ‰äº›åŠŸèƒ½éš¾ä»¥å®žçŽ°ï¼Œä½†æ˜¯é€šç”¨æ€§éžå¸¸å¼ºï¼ŒåŸºæœ¬è„šæœ¬å®žåœ¨å¦ä¸€å°æœºå™¨ä¸Šè·‘ã€‚ å·¥å…·åªæ˜¯å·¥å…·è€Œå·²ï¼Œå¹¶ä¸éœ€è¦æ‰§ç€æŸä¸ªå·¥å…·ï¼ŒæŠ±æœ‰ä¸€ä¸ªå·¥å…·åƒéå¤©ä¸‹çš„æƒ³æ³•ã€‚ä¹Ÿä¸ç”¨ä»€ä¹ˆå·¥å…·éƒ½æƒ³è¦çŸ¥é“ï¼Œæžå¾—å­¦äº†ä¸€å †æ‚ä¸ƒæ‚å…«çš„ä¸œè¥¿ã€‚å®žé™…è¿˜æ˜¯éœ€æ±‚é©±åŠ¨æ˜¯æœ€å¥½ï¼Œèƒ½å¤Ÿå¿«é€Ÿè§£å†³é—®é¢˜çš„å·¥å…·å°±æ˜¯æœ€å¥½çš„ã€‚ å…¶ä»–ä¼ è¾“åè®®ç›´æ’­å‘å±•è‡³ä»Šï¼ŒåŠŸèƒ½ä¸Šæ¥è¯´ï¼Œå„å®¶è§£å†³æ–¹æ¡ˆæä¾›å•†ä¹Ÿè¶‹äºŽä¸€è‡´ã€‚å·²ç»åˆ°äº†å¼€å§‹æ¯”æ‹¼è´¨é‡çš„é˜¶æ®µäº†ã€‚æ¯”å¦‚ä¼ è¾“å±‚åè®®ï¼Œtcp/ipåè®®ç°‡ã€‚ tcpå†…æ ¸ä¼ è¾“ä¸€äº›ç­–ç•¥å¯èƒ½ä¼šå½±å“åˆ°å®¢æˆ·ç«¯æŽ¥æ”¶æ•°æ®ï¼Œåœ¨ç›´æ’­è¿™æ ·è¾ƒä¸ºæ•æ„Ÿçš„åœºæ™¯ä¸‹ï¼Œå¯¼è‡´äº†å¡é¡¿ã€‚å› ä¸ºtcpå†…æ ¸çš„ä¸€äº›å‚æ•°ä¹Ÿéœ€è¦è¿›è¡Œç‰¹å®šçš„è°ƒæ•´ã€‚googleçš„tcp/ipæ‹¥å¡žæŽ§åˆ¶ç®—æ³•æ˜¯æ¯”è¾ƒæµè¡Œçš„ä¸€å¥—æ–¹æ¡ˆï¼Œå¯ä»¥å®žæ—¶åŸºäºŽå‘é€é€ŸçŽ‡å’ŒRTTè°ƒæ•´tcpçª—å£å’Œé€ŸçŽ‡ï¼Œå®žçŽ°å¯¹æ‹¥å¡žçš„å¿«é€Ÿå“åº”ã€‚ ç”±äºŽå¹¶ä¸æ˜¯ç§‘ç­å‡ºèº«ï¼Œå¯¹è¿™äº›ä¸œè¥¿åŸºæœ¬å°±çŸ¥é“å‡ ä¸ªæ¦‚å¿µï¼Œæ—¢ç„¶ç”¨å¾—ç€ï¼Œå¾—æ‰¾æ—¶é—´å¥½å¥½äº†è§£ä¸‹ç½‘ç»œä¼ è¾“çš„åè®®ã€‚è¿™ç¯‡ã€Šåè®®æ£®æž—ã€‹å¯ä»¥å¥½å¥½çœ‹çœ‹ï¼Œå¾ˆé€‚åˆæˆ‘è¿™æ ·æ²¡æœ‰åŸºç¡€çš„ã€‚ å¦å¤–httpå’Œrtmpè¿™ç±»æ›´é«˜çº§çš„åè®®ä¹Ÿåº”è¯¥å¤šå¤šäº†è§£äº›ã€‚å¯ä»¥æ›´å¥½åœ°ç†è§£æ•´ä¸ªæ•°æ®ä¼ è¾“è¿‡ç¨‹ã€‚ å·¥ä½œæˆæžœå±•ç¤ºæ¯å‘¨äº”éƒ½è¦å†™å‘¨æŠ¥ã€‚æœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œç»å¸¸å‘çŽ°æ¯”è¾ƒé‡è¦çš„äº‹æƒ…ï¼Œé¢†å¯¼ä¼¼ä¹Žéƒ½ä¸å¤ªå…³å¿ƒï¼Œè€Œéšä¾¿æäº†ä¸€å¥çš„äº‹æƒ…ï¼Œé¢†å¯¼å¯èƒ½ä¼šç§èŠæ¥äº†è§£æƒ…å†µã€‚çœ‹æ¥æ¯ä¸ªäººçš„å…³æ³¨ç‚¹éƒ½ä¸å¤ªä¸€æ ·ï¼Œå†™å‘¨æŠ¥è¿™ç±»å·¥ä½œè¿›å±•çš„ä¸œè¥¿ï¼Œå¹¶ä¸èƒ½æŒ‰ç…§è‡ªå·±çš„å®žé™…å·¥ä½œæ—¶é—´æ¥ä¾§é‡ã€‚å…·ä½“å†™å•¥ï¼Œæ˜¯é—¨è‰ºæœ¯ï¼Œå¾—å¥½å¥½ç¢ç£¨ã€‚ å‘æ•£æ€ç»´è¿‘æœŸæœ‰ä¸ªå®¢æˆ·ä¸€ç›´æŠ•è¯‰è´¨é‡å·®ï¼Œéœ€è¦è¿›è¡Œè°ƒä¼˜ã€‚å¸¸è§„çš„è°ƒæ•´ç­–ç•¥éƒ½ä½¿ç”¨äº†ï¼Œæ²¡å•¥ç”¨ã€‚ æ„Ÿè§‰å·²ç»é»”é©´æŠ€ç©·äº†ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ï¼Œéœ€è¦å„ç§å¤´è„‘é£Žæš´å’Œå¥‡æ€å¦™æƒ³äº†ã€‚å¾ˆå¤šäº‹æƒ…å¹¶ä¸æ˜¯éƒ½æœ‰å¥—è·¯çš„ï¼Œè¯´ä¸å®šç­”æ¡ˆå°±åœ¨æ‹‰ðŸ’©çš„çµå…‰ä¸€é—ªã€‚ WebRTCæœ€è¿‘è¿™ä¸ªè¯ç»å¸¸çœ‹åˆ°ï¼Œè¿™å¥—æ–¹æ¡ˆä¼¼ä¹Žç‰¹åˆ«é€‚åˆåšç›´æ’­è¿žéº¦ï¼Œæ‰¾æ—¶é—´å¯ä»¥äº†è§£ä¸‹ã€‚ï¼ˆåˆæ˜¯googleçš„ï¼Œè¿™ä¹ˆå¼ºï¼‰]]></content>
      <tags>
        <tag>ç—´äººè¯´æ¢¦</tag>
        <tag>å·¥ä½œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åä¸€æœˆçš„ä¸€äº›å°æƒ³æ³•ï¼ˆäºŒï¼‰]]></title>
    <url>%2F2017%2F11%2F19%2Fmeander-in-November-2%2F</url>
    <content type="text"><![CDATA[ä¹¦æŽ¥ä¸Šå›žã€‚ ä»Šå¤©è®²ä¸‹æœ€è¿‘å…³äºŽç”µå½±å’ŒéŸ³ä¹çš„ä¸€äº›æƒ³æ³•ã€‚ ç”µå½±çœ‹ç”µå½±æ¯”çœ‹ä¹¦æ˜¯å‹¤å¿«å¤šäº†ã€‚äººå‘ï¼Œæ€»æ˜¯çˆ±æŒ‘ç®€å•çš„äº‹åšï¼Œæ‡’èƒšã€‚ é™¢çº¿æ¡£æœŸçš„å¤§ç‰‡å’Œå…¶ä»–ä¸€äº›ç½‘ä¸Šçš„ç›—ç‰ˆç”µå½±å€’æ˜¯éƒ½çœ‹äº†ä¸å°‘ï¼Œå¤§æ¦‚ä»¥ä¸‹å‡ éƒ¨è®©äººå°è±¡å¾ˆæ˜¯æ·±åˆ»ï¼š é™ä¸´ ã€Šé™ä¸´ã€‹æ˜¯ä»Šå¹´å¹´åˆåœ¨å¤§é™†ä¸Šæ˜ çš„ä¸€éƒ¨ç§‘å¹»ç‰‡ã€‚ä¸Šæ˜ æ—¶ï¼Œéœ¸å±æœ‹å‹åœˆè›®ä¹…çš„ï¼Œè¢«å¾ˆå¤šäººç§°ä¸ºç¡¬ç§‘å¹»ã€‚å½“æ—¶æ²¡æœ‰åŽ»ç”µå½±é™¢æ”¯æŒï¼ŒçŽ°åœ¨åªèƒ½ä¸‹è½½ç›—ç‰ˆBTäº†ã€‚ æ•…äº‹è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œåœ°çƒçªç„¶å‡ºçŽ°ä¸€æ‰¹å¤–æ˜Ÿæ–‡æ˜Žçš„é£žèˆ¹ï¼Œèº«ä¸ºäººç±»è¯­è¨€å­¦å®¶çš„å¥³ä¸»å’Œèº«ä¸ºç‰©ç†å­¦ï¼ˆè¿˜æ˜¯æ•°å­¦ï¼‰å®¶çš„ç”·ä¸»ä¸€èµ·è¿›å…¥é£žèˆ¹è¯•å›¾ä¸Žå¤–æ˜Ÿäººäº¤æµã€‚æœ€ç»ˆå¥³ä¸»åœ¨å’Œå¤–æ˜Ÿäººçš„æŽ¥è§¦è¿‡ç¨‹ä¸­é€æ¸å­¦ä¼šäº†å¤–æ˜Ÿæ–‡å­—ã€‚è€Œå¤–æ˜Ÿæ–‡å­—è·³å‡ºæ—¶é—´çš„é™åˆ¶çŸ¥æ™“æœªæ¥ä¸Žè¿‡åŽ»ã€‚å¥³ä¸»å› æ­¤é¢„è§åˆ°äº†æœªæ¥ï¼šå’Œç”·ä¸»ç»“åˆï¼Œè‚²æœ‰ä¸€å¥³ï¼Œå¥³å„¿åŽæ¥å¾—ä¸æ²»ä¹‹ç—‡æ­»äº¡ï¼Œç”·ä¸»æ— æ³•æŽ¥å—ç¦»åŽ»ã€‚ å…¶å®žè¿™ç‰‡å¹¶ä¸ç®—çº¯ç²¹çš„ç§‘å¹»ç‰‡ï¼Œåº”è¯¥ç®—æ˜¯ç§‘å¹»ç‰‡ä¸Žæ–‡è‰ºç‰‡çš„ç»“åˆï¼Œå½±ç‰‡æ›´å¤šçš„æŽ¢è®¨äº†ä¸€äº›å“²å­¦çš„æ¦‚å¿µï¼Œå…³äºŽæ—¶é—´ï¼Œäººç±»å‘å±•ï¼Œæœªæ¥ã€‚ ç‰‡å­ä¸­å¤–æ˜Ÿäººä½¿ç”¨çš„æ–‡å­—å€’æ˜¯å¾ˆç¥žå¥‡ï¼Œè·Ÿä¸­å›½çš„æ°´å¢¨ç”»ååˆ†ç›¸ä¼¼ï¼Œå…¶ä¸­çš„æ„æ€åŒ…å«åœ¨ä¸åŒçš„æ™•æŸ“ä¹‹ä¸­ï¼ˆæ˜¯ä¸æ˜¯æƒ³è¯´æˆ‘ä»¬ä¸­å›½æ‰èƒ½æ‹¯æ•‘ä¸–ç•Œï¼Œå•Šå“ˆå“ˆå“ˆï¼‰ã€‚ è±†ç“£æœ‰ä¸€ç¯‡è„‘æ´žå¾ˆå¤§çš„å½±è¯„ï¼Œä½ ä¸çŸ¥é“çš„ã€Šé™ä¸´ã€‹èƒŒåŽçš„ææ€–çœŸç›¸ï¼Œé—²æš‡æ—¶å¯ä»¥è¯»è¯»ã€‚ä½œè€…æ„æ·«äº†ä¸€æŠŠå¤§çš„ï¼Œè®¤ä¸ºå¤–æ˜Ÿæ–‡å­—å°±æ˜¯ä¸­æ–‡çš„æ¼”å˜ï¼Œç¡®å®žæ˜¯ç‰›é€¼çš„ä¸­æ–‡å‘€ã€‚ ç‰‡å°¾æœ‰ä¸ªæœ‰è¶£çš„æƒ…èŠ‚æ˜¯ï¼Œå¥³ä¸»é€šè¿‡å¤–æ˜Ÿæ–‡å­—çŸ¥é“äº†è‡ªå·±çš„æœªæ¥ï¼šå¥¹ä¼šå’Œç”·ä¸»ä¼šåœ¨ä¸€èµ·ï¼Œæ‰€ç”Ÿçš„å¥³å„¿ä¼šå› ä¸ºæ€ªç—…è€Œæ­»åŽ»ï¼Œç”·ä¸»å› æ­¤è€Œç¦»åŽ»ã€‚ä½†æ˜¯æœ€åŽï¼Œå¾—çŸ¥äº†ä¸€åˆ‡æœªæ¥çš„å¥³ä¸»è¿˜æ˜¯æ·±æƒ…çš„æœ›ç€ç”·ä¸»ï¼Œä¸Žä»–æ‹¥æŠ±åœ¨ä¸€èµ·ã€‚è¿™ç§æ˜ŽçŸ¥å‰é€”è†æ£˜ä¸›ç”Ÿï¼Œä¾ç„¶æ— ç•å‰è¡Œçš„å‹‡æ°”ä¼°è®¡ä¹Ÿæ˜¯äººç±»å¯ä»¥ç”Ÿå­˜è‡³ä»Šçš„åŽŸå› å§ã€‚ è¶…ä½“ã€Šè¶…ä½“ã€‹è®²è¿°äº†å¥³ä¸»æ„å¤–å¸æ”¶äº†è¶…å¤§é‡çš„äººç±»èƒšèƒŽæ—¶æœŸçš„åŽŸå§‹ç‰©è´¨CHåŽï¼Œå¤§è„‘ä½¿ç”¨çŽ‡é€æ¸è¾¾åˆ°100%çš„æ•…äº‹ã€‚éšç€äººè„‘åˆ©ç”¨çŽ‡çš„æå‡ï¼Œå¥³ä¸»å¼€å§‹å¯ä»¥æŽ§åˆ¶è‡ªå·±çš„èº«ä½“ï¼ŒæŽ§åˆ¶èº«è¾¹çš„ç‰©è´¨ï¼Œæœ€åŽå’Œæ—¶é—´ç©ºé—´èžä¸ºä¸€ä½“ã€‚ æœ¬æ¥åªæ˜¯åƒçœ‹ä¸‹Scarlett Johanssonçš„è„¸ï¼ˆé¡ºä¾¿åæ§½Scarlettçš„èº«æç¡®å®žä¸å’‹åœ°å‘€ï¼Œä¸æ™“å¾—ä¸ºä»€ä¹ˆä½ ä»¬éƒ½è¿™ä¹ˆçˆ±å¥¹ï¼‰ï¼Œæƒ³ä¸åˆ°è¿™ç”µå½±å€’æ˜¯å’ŒåŒæ ·æ˜¯Scarlettâ€œä¸»æ¼”â€çš„ã€Šå¥¹ã€‹ä¸€æ ·æƒŠè‰³åˆ°æˆ‘äº†ã€‚ç‰‡ä¸­å¯¹äºŽäººç±»èµ·æºï¼Œå‘å±•ä¸Žæœªæ¥çš„æ€è€ƒï¼Œè¿™ä¸€å¥—å¾ˆæ˜¯æˆ‘çš„èœã€‚ æˆ‘æœ¬èº«è¿˜æ˜¯è›®æ‹œæœä¸­å›½å¤ä»£é‚£ä¸€å¥—å“²å­¦ç†è®ºçš„ã€‚å¤äººè®¤ä¸ºçš„å¤©åœ°ä¹‹é—´çš„è§„å¾‹ä¸Žç§©åºæ˜¯â€œé“â€ï¼Œã€Šè€å­ã€‹ä¸­æ‰€è¿°çš„â€œé“ç”Ÿä¸€ï¼Œä¸€ç”ŸäºŒï¼ŒäºŒç”Ÿä¸‰ï¼Œä¸‰ç”Ÿä¸‡ç‰©â€ï¼Œæ‰€è®²è¿°çš„æ˜¯äººæ˜¯é“çš„è½¬æ¢è€Œæˆçš„ä¸€ç§äº§ç‰©ï¼Œè€Œäººåˆè¦è¿½æ±‚é“ï¼Œå¸Œå†€å¾—â€œé“â€ã€‚ è¶…ä½“ç”µå½±ä¸­ï¼Œå¥³ä¸»è§’æ„å¤–å¾—ä»¥å¿«é€Ÿè¿›åŒ–ï¼Œä»¥è‡³äºŽå¯ä»¥æŽ§åˆ¶èº«è¾¹çš„ç‰©è´¨ï¼Œæœ€åŽè¶…è„±æ—¶é—´å’Œç©ºé—´ï¼ŒåŒ–å…¥å…¶ä¸­ã€‚è€Œå½±ç‰‡ä¸­ä¸€ç›´å‡ºçŽ°çš„ç”»é¢æ˜¯äººç±»çš„èµ·æºï¼Œç”Ÿå‘½çš„èµ·æºï¼Œä»Žä¸€ç‰‡æ— æœºç‰©è´¨ä¸­å­•è‚²å‡ºç»†èƒžå’Œç”Ÿå‘½ã€‚ä¸¤è¾¹ä¸€å¯¹æ¯”ï¼Œä¼¼ä¹Žæˆ‘ä»¬è¿½æ±‚çš„æžè‡´ä¾¿æ˜¯è™šæ— ï¼Œè€Œæˆ‘ä»¬åˆæ˜¯ä»Žè™šæ— ä¸­è€Œæ¥ã€‚è¿™ä¸Žä¸­å›½å¤ä»£çš„ä¸–ç•Œè§‚ä½“ç³»ï¼Œä¸‡ç‰©å­•äºŽé“ï¼Œè€Œäººåˆæ±‚é“æœ‰ç‚¹ç±»ä¼¼ã€‚ å¯¼æ¼”å•å…‹Â·è´æ¾æˆ–è®¸åªæ˜¯åƒè¡¨è¿°ä»–æ‰€ç†è§£çš„æœªæ¥ï¼Œä»–æ‰€ç†è§£çš„äººä»¬æ‰€è¿½æ±‚çš„ç»ˆæžç›®æ ‡çš„æ ·å­ã€‚è€Œæ¯ä¸ªè§‚ä¼—æ‰€ä½“ä¼šåˆ°çš„æˆ–è®¸åˆæ˜¯å¦å¤–çš„æ ·å­ã€‚ æµªæ½® ã€Šæµªæ½®ã€‹ï¼Œæ®è¯´æ˜¯æ ¹æ®å®žé™…äº‹ä»¶æ”¹ç¼–ï¼Œè®²è¿°äº†ä¸€ä½å¾·å›½æ•™å¸ˆï¼Œåœ¨æ•™æŽˆç‹¬è£æ”¿æ²»è¯¾ç¨‹æ—¶ï¼Œä¸ºäº†è®©å­¦ç”Ÿä»¬å¯¹ç‹¬è£ç»Ÿæ²»æœ‰æ›´å½¢è±¡çš„è®¤è¯†ï¼Œåœ¨è¯¾å ‚ä¸Šæ¨¡æ‹Ÿäº†ç‹¬è£ç»Ÿæ²»çš„ä¸€äº›æ–¹å¼ï¼ŒåŒ…æ‹¬å‘è¨€è¦èµ·ç«‹ï¼Œä¸Šä¸‹è¯¾æœ‰ä»ªå¼ï¼Œç§°å‘¼è€å¸ˆç‰¹å®šç§°è°“ç­‰ã€‚åŽæ¥æ„ˆå‘ä¸å¯æ”¶æ‹¾ï¼Œæœ‰äº†ç»Ÿä¸€æœé¥°ï¼Œç»Ÿä¸€å£å·ï¼Œç»Ÿä¸€çš„logoï¼Œæœ€ç»ˆå¤§éƒ¨åˆ†å­¦ç”Ÿæœ‰äº†ç»Ÿä¸€çš„æ€æƒ³å½¢æ€ï¼Œç»Ÿä¸€çš„è¡ŒåŠ¨ï¼Œé…¿æˆå¤§ç¥¸ã€‚ å½±ç‰‡æœ¬èº«è¦è¯´çš„åº”è¯¥æ˜¯ç‹¬è£ç»Ÿæ²»å¾ˆå®¹æ˜“é‡æ¼”ï¼Œå¸Œæœ›ä¿æŒè­¦æƒ•è¿™æ ·å§ã€‚ä½†æ˜¯èº«ä¸ºä¸€ä¸ªåœ¨ä¸­å›½æˆé•¿çš„äººæ¥è¯´ï¼Œè¿™ä¸å°±æ˜¯æˆ‘ä»¬çš„å°å­¦ï¼Œåˆä¸­ï¼Œé«˜ä¸­ï¼Œç”šè‡³å¤§å­¦å˜›ã€‚æˆ‘ä»¬ä¸æ˜¯ä¸€ç›´è¢«è¦æ±‚ç©¿æ ¡æœï¼Œä¸Šè¯¾éµå®ˆçºªå¾‹ï¼Œå–Šç»Ÿä¸€å£å·å˜›ã€‚è®°å¾—å°æ—¶å€™è€å¸ˆç»å¸¸è¯´çš„ä¹Ÿæ˜¯ä¸è¦æžç‰¹æ®Šï¼Œæ¯ä¸ªäººä¸ç®¡åœ¨å®¶å¦‚ä½•ï¼Œåœ¨å­¦æ ¡å¤§å®¶éƒ½è¦ä¸€æ ·ï¼Œè¿™æ ·æƒ³æƒ³ï¼Œå¥½å¯æ€•ï¼Œå¯æ€•ï¼Œå¯æ€•ã€‚ éŸ³ä¹ä»Šæ—¥æ‰“ç®—å¼ƒå‘ç½‘æ˜“äº‘éŸ³ä¹äº†ï¼Œçœ‹ç€æ­Œå•é‡Œä¸€æ‰¹ä¸€æ‰¹å˜ç°ï¼Œå®žåœ¨æ˜¯éš¾å—å¾—å¾ˆã€‚å¯æƒœè¿˜æœ‰åä¸ªæœˆçš„ä¼šå‘˜å‘¢ã€‚ æ‰€ä»¥è¯´è¿™ç§ç½‘ç»œéŸ³ä¹æä¾›å•†è·ŸéŸ³ä¹ç‰ˆæƒå…¬å¸ç­¾ä»€ä¹ˆç‹¬å®¶ç‰ˆæƒå®žåœ¨æ˜¯ä¸å‹å¥½å¾—å¾ˆï¼Œä¸ä»…ä¸åˆ©äºŽè¡Œä¸šå†…ç«žäº‰ï¼Œä¹Ÿè®©æ¶ˆè´¹è€…å°‘äº†å¾ˆå¤šé€‰æ‹©é¡¹å˜›ã€‚æžä¸ªä¼šå‘˜æœºåˆ¶ï¼Œæˆ–è€…å…¶ä»–æ”¶è´¹æ–¹å¼éƒ½æ˜¯å¾ˆä¸é”™çš„å˜›ã€‚å”‰~ åæ§½å®Œäº†ï¼Œè°ˆä¸‹æœ€è¿‘å‡ é¦–æ­Œã€‚ çŽ°è±¡ä¸ƒåäºŒå˜ç½—å¤§ä½‘çš„è¿™é¦–æ­Œå®žåœ¨æ˜¯å¤ªå¦™ã€‚æ­Œè¯å¼€å¤´å°±è®©æˆ‘çœ¼å‰ä¸€äº®ã€‚ é»„èŠ±å²—æœ‰ä¸ƒåäºŒä¸ªçƒˆå£« å­”è€å¤«å­æœ‰ä¸ƒåäºŒä¸ªå¼Ÿå­ å­™æ‚Ÿç©ºçš„é­”æ³•ä¸ƒåäºŒå˜ æˆ‘ä»¬åˆç­‰åˆ°æ°‘å›½ä¸ƒåäºŒå¹´ â€¦â€¦ è™½ç„¶ç²—çœ‹ä¸å°±æ˜¯å››ä¸ªä¸ƒåäºŒå˜›ï¼Œä½†æ˜¯ç»†æƒ³ï¼Œæ—¶ç©ºäº¤é”™ï¼Œè™šå®žä¸å®šï¼Œå¼€å¤´å°±ç‰¹æ®Šå¾—å¾ˆã€‚ æ­Œè¯è®½åˆºäº†å¾ˆå¤šçŽ°ä»Šçš„è™šå‡çŽ°è±¡ï¼Œäººä»¬é“è²Œå²¸ç„¶ï¼Œç§ä¸‹é‡Œå´å„ç§å°å¿ƒæ€ã€‚ç½—å¤§ä½‘è¢«ä¸€äº›äººç§°ä¸ºä¸­å›½çš„Bob Dylanï¼Œä¹Ÿä¸æ˜¯æ²¡æœ‰åŽŸå› ã€‚ é«˜æ™“æ¾åœ¨ã€Šæ™“è¯´ã€‹é‡Œç»å¸¸è¯´ä¸­å›½äººå†™è¯çš„æ°´å¹³å¤©ä¸‹æ— æ•Œï¼Œè°±æ›²çš„æ°´å¹³ç¡®å®žå®žåœ¨ä¸€èˆ¬èˆ¬ã€‚æœ¬äººå®žåœ¨æ˜¯æ²¡å•¥éŸ³ä¹å¤©èµ‹ï¼Œå¬äº†å‡ é¦–æµè¡ŒéŸ³ä¹ï¼Œå¯¹äºŽæ›²è°±å¾—æ€Žä¹ˆæ ·ï¼Œå®žåœ¨èµæžä¸æ¥ï¼Œä¸è¿‡æ­Œè¯èµæžçš„èƒ½åŠ›ï¼Œæƒ³æ¥ä¸­å›½äººåº”è¯¥éƒ½æ˜¯å¯ä»¥è°ˆä¸‹çš„ã€‚ ç½—å¤§ä½‘çš„å¾ˆå¤šéŸ³ä¹çš„æ­Œè¯åœ¨ä»–é‚£ä¸ªé¸­èˆ¬çš„å¥‡æ€ªå—“éŸ³å”±å‡ºæ¥ç¡®å®žè®©äººçœ¼å‰ä¸€äº®ã€‚ã€Šå°†è¿›é…’ã€‹ï¼Œã€Šé¹¿æ¸¯å°é•‡ã€‹ï¼Œã€Šä¹‹ä¹Žè€…ä¹Ÿã€‹éƒ½æ˜¯å†™å¯ä»¥å•æ›²å¾ªçŽ¯å‡ åéçš„ä½³ä½œã€‚ä¹Ÿä¸åœ¨æ­¤è£…é€¼çš„åˆ†æžï¼Œè¿™ç§ä¸œè¥¿è‡ªå·±çˆ±å¬å°±å¥½ã€‚ èƒ¡å¾·å¤«å­¦ç”Ÿçš„æ—¶å€™ï¼Œåœ¨å¹¿æ’­é‡Œå¬åˆ°èƒ¡å¾·å¤«çš„ã€ŠåŒ†åŒ†ã€‹ï¼Œè¿™ä½å¤§çˆ·çš„ç‹¬ç‰¹å”±è…”è®©äººç¥žæ¸…æ°”çˆ½ï¼Œä¼¼ä¹Žæ”¾ä¸‹äº†ä¸€åˆ‡ï¼Œååœ¨æµ·è¾¹å¹é£Žèˆ¬èˆ’ç•…ã€‚è¿™ä¸ªå¹¿æ’­èŠ‚ç›®çŽ°åœ¨è¿˜è®°å¾—å‘¢ï¼Œæµ™æ±Ÿä¹‹å£°çš„ã€Šæ–¹é›¨å¤§æœç´¢ã€‹ï¼Œè™½ç„¶ç‹¬åœ¨å¼‚ä¹¡ï¼Œæœ‰æ—¶å€™ä¹Ÿå¬ä¸‹æ•…ä¹¡çš„ç”µå°ã€‚ èƒ¡å¾·å¤«æœ€è¿‘åº”è¯¥å¾ˆå¤šäººéƒ½çŸ¥é“äº†å§ï¼Œçœ‹åˆ°è±†ç“£æœ‰ä»–çš„èŠ‚ç›®ï¼Œä¸Šäº†é¦–é¡µã€‚ä»–çš„éŸ³ä¹åŸºæœ¬å°±ä»–çš„è‡ªå¼¹é’¢ç´ï¼Œä¸€å£å—“å­ï¼Œæ— å®ƒã€‚å”±è…”å¾ˆç‹¬ç‰¹ï¼Œä¸çŸ¥é“æ€Žä¹ˆå½¢å®¹ï¼Œç»å¸¸ä¼šæ··å…¥å°æ¹¾åŽŸä½æ°‘çš„ä¸€äº›ç‹¬ç‰¹çš„æ–¹è¨€çš„å‘éŸ³ï¼Œä¸€äº›ç®€å•çš„â€å•Šâ€œï¼Œ â€å“ˆâ€œï¼Œ â€å“¦â€œä¹‹ç±»çš„ã€‚æˆ‘è¿™ä¸ªå†œæ‘è¿›åŸŽåŠ¡å·¥äººå‘˜ï¼Œå¸¸å¹´å¾…åœ¨åŸŽå¸‚é‡Œï¼Œåªå¬åˆ°æ™®é€šè¯çš„ï¼Œä»–çš„éŸ³ä¹ç¡®å®žå¾ˆé€‚åˆåœ¨æµ®èºæ—¶ï¼Œæ”¾ç©ºä¸€åˆ‡ï¼Œå®‰é™å‘å‘†ã€‚ èƒ¡å¾·å¤«æœ‰å¾ˆå¤šç»å…¸çš„éŸ³ä¹ï¼Œã€ŠåŒ†åŒ†ã€‹ï¼Œã€Šå¤ªå¹³æ´‹çš„é£Žã€‹ï¼Œã€Šç‰›èƒŒä¸Šçš„å°å­©ã€‹ï¼Œæˆ‘æœ€å–œæ¬¢çš„æ˜¯ä»–ç¿»å”±çš„Leonard Cohençš„ã€Šhallelujahã€‹ï¼Œæˆ‘ä¸çŸ¥é“è¿™æ˜¯ä¸æ˜¯ç®—æ˜¯ä¸€é¦–ä¸Šå¸é¢‚æ­Œï¼Œä¸è¿‡æˆ‘å¬æ¥ç¡®å®žå‡€åŒ–å¿ƒçµä¹‹æ­Œã€‚ç›¸å¯¹Cohenï¼Œèƒ¡å¾·å¤«æ›´ä¸ºçº¯ç²¹ï¼Œå¦‚æžœæ˜¯åœ¨èµžé¢‚ä¸Šå¸æ¥çœ‹ï¼Œä¹Ÿæ›´ä¸ºçº¯æ´äº›å§ã€‚ ç‚¹å‡»ä¸‹é¢å¯ä»¥å°è¯•ä¸‹~æ‹œè°¢ã€‚ var ap = new APlayer({ element: document.getElementById("aplayer0"), narrow: false, autoplay: false, showlrc: 0, music: { title: "hallelujah", author: "èƒ¡å¾·å¤«", url: "https://nuaaeducn-my.sharepoint.com/:u:/g/personal/toneytonight_nuaa_edu_cn/EXPRJSNKBM9KtbN9ESmsWvkBDGWocD8aYc-xxjiwEUupug?e=Kb6BvR", pic: "/music/èƒ¡å¾·å¤«-Hallelujah.jpg", } }); window.aplayers || (window.aplayers = []); window.aplayers.push(ap); ä½“è‚²å…¶å®žå¹¶ä¸æ˜¯è°ˆä½“è‚²ï¼Œæˆ‘è¿™ç¾¸å¼±çš„èº«ä½“ï¼Œä»Žå°å°±æ²¡å¯¹å“ªé¡¹ä½“è‚²æ´»åŠ¨æ„Ÿå…´è¶£è¿‡ã€‚åªæ˜¯è®²äº†è¯»ä¹¦ï¼Œç”µå½±ï¼ŒéŸ³ä¹ä¹‹ç±»çš„ä¸œè¥¿ä¹‹åŽï¼Œæ‰“ç®—è®²ä¸‹èº«ä½“çš„ï¼Œä¸è¿‡æ„Ÿè§‰æ ‡é¢˜ä¸ºä½“è‚²æ¯”è¾ƒå’Œè°ã€‚æ ‡é¢˜å…šï¼æ ‡é¢˜å…šï¼ï¼æ ‡é¢˜å…šï¼ï¼ï¼å®žåœ¨æ˜¯å¯æ¶ã€‚ å¥½äº†ï¼Œè®²ä¸‹èº«ä½“å§ã€‚ å”‰ï¼Œæˆ‘è¿™ç¾¸å¼±çš„èº«ä½“ï¼Œä½“åŠ›ä¸è¡Œå°±ç®—äº†ï¼Œå·¥ä½œä¸€å¹´ï¼Œæ¸¸æ³³åœˆå‡ºæ¥äº†ä¹Ÿå°±ç®—äº†ï¼Œå±…ç„¶æœ‰äº†è„‚è‚ªè‚ï¼Œè¿˜æ˜¯è½»-ä¸­åº¦è„‚è‚ªè‚ã€‚ç®€ç›´æ¶æžï¼Œç®€ç›´æ¶æžï¼Œç®€ç›´æ¶æžã€‚ ä½“æ£€Bè¶…çš„é‚£ä¸ªå§‘å¨˜ï¼Œä½ çŸ¥é“ä½ æ·¡æ·¡çš„é‚£å¥â€œæœ‰ç‚¹è„‚è‚ªè‚â€å¯¹æˆ‘æœ‰å¤šå¤§ä¼¤å®³å˜›ã€‚(â•¯ï¸µâ•°) æ‰‹æœºä¸Šè£…äº†ä¸ªkeepï¼Œè£…äº†ä¸ªå›šå¾’å¥èº«ï¼Œè£…äº†ä¸ªè–„è·ï¼Œä½ è¯´è¯´ï¼Œæœ‰å•¥ç”¨ï¼Œæœ‰å•¥ç”¨ï¼Œæœ‰å•¥ç”¨ã€‚ å“Žï¼Œä¸å†™äº†ï¼ŒåŽ»åšä¸ªåä¸ªä»°å§èµ·åå§ã€‚ æœ€åŽç¦åˆ©æ—¶é—´ï¼Œä¼ æŽˆä¸ªå°æŠ€å·§ï¼Œä¸Žè¯¸å›å…±å‹‰ï¼š]]></content>
      <tags>
        <tag>ç—´äººè¯´æ¢¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åä¸€æœˆçš„ä¸€äº›å°æƒ³æ³•ï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2017%2F11%2F18%2Fmeander-in-November-1%2F</url>
    <content type="text"><![CDATA[17å¹´çš„å…‰æ£èŠ‚è¿‡äº†ï¼Œæœ‰ç§è¿˜åœç•™åœ¨ä¸–çºªå¤§å…‰æ£èŠ‚çš„é‚£å¤©çš„é”™è§‰ã€‚ å·¥ä½œä¸€å¹´å¤šï¼Œå¯¹äºŽâ€œè„±å…‰â€æ—©å·²ä¸åœ¨æœŸå¾…ï¼Œç¥žå¥‡çš„æ˜¯å¯¹äºŽæŠ¢è´­ä¹Ÿä¸å†çƒ­æƒ…ï¼Œçœ‹æ¥ä¿ƒé”€åŠ›åº¦è¿˜ä¸å¤Ÿå‘€ã€‚ è¿™æ ·ï¼ŒæŠŠè„‘è¢‹é‡Œçš„å°æƒ³æ³•è®°å½•ä¸‹æ¥ï¼Œè¯­è¨€ç»„ç»‡èƒ½åŠ›è–„å¼±å¾—å¾ˆï¼Œæƒå½“ç»ƒä¹ ä¸‹æ‰“å­—æ°´å¹³å§ã€‚ å…‰æ£èŠ‚æ‰€æœ‰çš„èŠ‚æ—¥ä¸å¤–ä¹Žä¸¤ç±»ï¼šçºªå¿µå¾ˆæœ‰åœ°ä½æˆ–è€…çŸ¥ååº¦çš„äººç‰©æˆ–è€…äº‹ä»¶ï¼Œçºªå¿µåœ°ä½å¤ªä½Žæˆ–è€…é­é‡å‡„æƒ¨çš„äººç‰©æˆ–è€…äº‹ä»¶ã€‚ å…‰æ£èŠ‚æ˜¾ç„¶å±žäºŽåŽè€…ã€‚ä»Žå­—é¢æœ¬èº«çœ‹å°±å¯¹æˆ‘ä»¬æ±ªç±»æœ‰ç€æ·±æ·±çš„æ¶æ„ã€‚ è´­ç‰©è™½ç„¶æ²¡ä¹°ä»€ä¹ˆï¼Œä½†å…¶å®žè¿˜æ˜¯æƒ³ä¹°çš„ã€‚æƒ³ä¹°ä¸ªkindleè£…é€¼ã€‚æƒ³ä¹°ä¸ªæœ€è´µçš„kindleè£…é€¼ã€‚æƒ³ä¹°ä¸ªç¾Žç‰ˆçš„å¸¦3Gä¸Šç½‘åŠŸèƒ½çš„æœ€è´µçš„kindle oasisè£…é€¼ã€‚ æ²¡é’±ï¼ï¼ï¼ä¹°ä¸èµ·ï¼Œå¤ªè´µäº†ã€‚ å…‰æ£å†é—²è°ˆä¸‹å…‰æ£å§ï¼Œæœ‰ä¸ªæ®µå­ï¼š ä»Žå‰å–œæ¬¢ä¸€ä¸ªäººï¼ŒçŽ°åœ¨å–œæ¬¢ä¸€ä¸ªäººã€‚ ä¸­æ–‡è¿˜æ˜¯åšå¤§ç²¾æ·±å‘€ã€‚è¿™æ®µå­æ€Žä¹ˆçœ‹éƒ½æ˜¯å…‰æ£ä¿®ç‚¼ç€ä¿®ç‚¼ç€ï¼Œæå‡äº†ä¸€ä¸ªå¢ƒç•Œã€‚å†ä¿®ç‚¼ä¸‹åŽ»æ˜¯ä¸æ˜¯è¦å˜æˆé­”æ³•å¸ˆäº†ã€‚ä¸çž’ä½ è¯´ï¼Œæœ¬äººç›®å‰å·²ç»æ˜¯åˆ°äº†â€çŽ°åœ¨å–œæ¬¢ä¸€ä¸ªäººâ€œçš„å¢ƒç•Œäº†ï¼Œä¹Ÿç®—æ˜¯æœ‰ç‚¹å°èµ„æ ¼æ¥è°ˆä¸‹è¿™ä¸ªäº‹æƒ…äº†ã€‚ ä»Žå‰å–œæ¬¢ä¸€ä¸ªäººä»Žå‰å“ªåªå–œæ¬¢ä¸€ä¸ªäººå‘€ï¼Œç”·äººéƒ½æ˜¯å¾ˆèŠ±å¿ƒçš„ï¼Œå°¤å…¶æ˜¯å¹´è½»çš„ç”·å­©ï¼Œè§å‡ ä¸ªçˆ±å‡ ä¸ªã€‚ å“Žï¼Œå›žå¿†çªç„¶å¡žæ»¡äº†è„‘å­ï¼Œä½†æ˜¯å•¥ä¹Ÿå†™ä¸å‡ºæ¥ã€‚ä¸å†™äº†ã€‚ çŽ°åœ¨å–œæ¬¢ä¸€ä¸ªäººçŽ°åœ¨ç¡®å®žå–œæ¬¢ä¸€ä¸ªäººã€‚ æ¯å‘¨ä¸€å¬åŒäº‹ç‚«è€€å‘¨æœ«è·Ÿå¦¹çº¸åŽ»é€›è¡—çš„â€œä¹è¶£â€ï¼Œç§ä¸‹åº†å¹¸è‡ªå·±æ²¡æœ‰å¦¹çº¸ã€‚åªæ€¨è‡ªå·±å¤©ç”Ÿæ˜¯å¹³è¶³ï¼Œé€›è¡—äºŽæˆ‘å®žåœ¨é¡¶æ®‹å¿çš„é…·åˆ‘ã€‚ å†è€…ï¼Œæˆ‘ä»¬è¯»ä¹¦äººï¼Œå‘æ¥æ˜¯ä»¥è¿½æ±‚è‡ªç”±ç‹¬ç«‹ä¸ºç›®æ ‡çš„ï¼Œç»æµŽè‡ªç”±ç‹¬ç«‹ï¼Œæ´»åŠ¨è‡ªç”±ç‹¬ç«‹ï¼Œæ€æƒ³è‡ªç”±ç‹¬ç«‹ã€‚å€˜ä½¿äº¤äº†æœ‹å‹ï¼Œæ€»è¦æœ‰æ‰€å¦¥åï¼Œç»æµŽè¦å—å…¶ç®¡åˆ¶ï¼Œå‡æœŸæ´»åŠ¨è¢«å…¶å®‰æŽ’ï¼Œè„‘å­è¦æ±‚åªæœ‰å¥¹ï¼Œä½•æ¥è‡ªç”±ç‹¬ç«‹ä¹‹æ€æƒ³ï¼Œç”šè‡³å¯æ€•ï¼Œå¯æ€•ï¼Œå¯æ€•ã€‚ é‚£ä¸€ç›´æ˜¯ä¸€ä¸ªäººï¼Œéƒ½è‡ªç”±ç‹¬ç«‹äº†å˜›ï¼Ÿæ²¡æœ‰ï¼è¿™æ‰æ˜¯æ‚²å‰§æ‰€åœ¨ã€‚ å…¶å®žå†…å¿ƒè¿˜æ˜¯æ¸´æœ›çˆ±æƒ…ï¼Œä½†æ˜¯å·²æ²¡æœ‰å¹´å°‘æ—¶åªè¦å§‘å¨˜ç‚¹å¤´ï¼Œå…¶ä»–å…¨éƒ¨æŠ›æŽ‰çš„å‹‡æ°”äº†ã€‚çŽ°åœ¨å–œæ¬¢ä¸€ä¸ªäººçš„åŽŸå› ä¹Ÿåªæ˜¯ä¸çˆ±é‚£ä½åŒäº‹æ‰€â€œç‚«è€€â€çš„é‚£ç§ç”Ÿæ´»ï¼ˆæˆ‘ä»¬æ±ªç±»çœ‹æ¥é‚£å°±æ˜¯ç‚«è€€ï¼‰ã€‚ æ‰€ä»¥ä¸€ç›´å¯¹å¤–å®£ç§°è‡ªå·±æ˜¯å§å§æŽ§ï¼Œåªæ˜¯å› ä¸ºæ„Ÿè§‰ä¸Šçš„å§å§éƒ½æ˜¯é‚£ä¹ˆå¾—ç‹¬ç«‹è‡ªä¸»ï¼Œå³ä½¿ä¸¤ä¸ªäººï¼Œä¹Ÿä¸ç”¨ä¸€ç›´è…»æ­ªåœ¨ä¸€èµ·ï¼Œä¾ç„¶å¯ä»¥æœ‰å¯ä»¥è‡ªå·±çš„ç©ºé—´ä¸Žæ—¶é—´ã€‚ ä½†æ˜¯éƒ½ä¸è…»æ­ªåœ¨ä¸€èµ·äº†ï¼Œè¿˜æ€Žä¹ˆè°ˆæœ‹å‹ï¼Œç®€ç›´æ˜¯å¤ªå¯æ¶ï¼Œå¯æ¶ï¼Œå¯æ¶ã€‚ è¿™æ ·çš„çŸ›ç›¾ï¼Œä¼°è®¡æ˜¯æ³¨å®šå­¤ç‹¬ä¸€ç”Ÿäº†ã€‚ ä¹¦è¯»å¾—è¶Šå¤šè¶Šè ¢è®°å¾—çœ‹è¿‡ä¸€å¼ å›¾ï¼Œæ‰¾äº†ä¸‹æ²¡æ‰¾åˆ°ï¼Œå¤§æ¦‚æç»˜ä¸‹ï¼šå›¾ç‰‡ä¸€è¾¹æ˜¯ä¸€æ‘žä¹¦ï¼Œå †å¾ˆé«˜ã€‚å¦ä¸€è¾¹å¯¹åº”ä¸‰å±‚å¤§æ°”ï¼Œè‡ªä¸‹è€Œä¸Šæ˜¯è¿‘åœ°é¢ï¼šé£Žæ™¯ç§€ä¸½ï¼Œå¯¹æµå±‚ï¼šç”µé—ªé›·é¸£ï¼Œå¹³æµå±‚ï¼šæ‹¨äº‘è§æ—¥ã€‚å¤§æ¦‚çš„æ„æ€æ˜¯ï¼Œå¦‚æžœç¨å¾®è¯»ç‚¹ä¹¦ï¼Œä¼šç»åŽ†é‚£ä¸€å±‚ç”µé—ªé›·é¸£ï¼Œæœ‰è¶³å¤Ÿçš„ç§¯ç´¯çš„äººæ‰å¯ä»¥å†²ç ´ä¹Œäº‘ï¼Œçœ‹åˆ°äº‘ä¸Šçš„å£®é˜”æ™¯è±¡ã€‚ é—®é¢˜æ˜¯ï¼Œå±€ä¸­äººæ°¸è¿œçœ‹æ­¥åˆ°è‡ªå·±æ‰€å¤„ä½ç½®çš„ï¼Œæ‰€ä»¥æ— æ³•çŸ¥æ™“è‡ªå·±è¿˜ç¦»ç©¹é¡¶æœ‰å¤šå°‘æ­¥ã€‚æ‚²å“€å‘€æ‚²å“€ã€‚ å¥½äº†ï¼Œç»ˆäºŽä¸ºè‡ªå·±çš„è¶Šæ¥è¶Šæ„šè ¢æ‰¾äº†ä¸ªé«˜å¤§ä¸Šçš„å€Ÿå£ã€‚ å·¥ä½œåŽçœ‹ä¹¦ä¹Ÿä¸å¤ªçœ‹äº†ï¼ŒåŸºæœ¬ä¹Ÿå°±æ˜¯ç”µå½±ç”µè§†å‰§çœ‹å¤ªå¤šæ„Ÿåˆ°ç¾žæ„§çš„æ—¶å€™ï¼Œæ§èµ·æœ¬ç²—æµ…çš„å°è¯´æ¥çœ‹å‡ çœ¼ï¼Œå†æ‹¿èµ·ä¸€æ—æ‰‹æœºçœ‹å‡ åçœ¼ã€‚æ–­æ–­ç»­ç»­ä¹Ÿç®—çœ‹äº†å‡ ä¸ªå°æ•…äº‹å§ã€‚ é˜¿åŸŽé˜¿åŸŽä¹‹å‰ä¹Ÿæ²¡å¬è¿‡ï¼Œè®°å¾—å¤§å››é‚£å¹´çœ‹äº†æ¢æ–‡é“çš„ä¸€æ¡£èŠ‚ç›®ï¼Œå…¶ä¸­æœ‰ä¸€æœŸæŽ¨èé˜¿åŸŽçš„ã€Šé˜¿åŸŽç²¾é€‰é›†ã€‹ï¼Œå°±ä¸€ç›´æ”¾åœ¨æƒ³è¯»çš„æ¸…å•é‡Œã€‚16å¹´ä¸‹åŠå¹´çš„æŸä¸€å¤©å§ï¼ŒæŸä¸œæžå›¾ä¹¦ç±»çš„ä¿ƒé”€æ´»åŠ¨ï¼Œå‡‘äº†å‡ æœ¬ï¼Œå…¶ä¸­ä¾¿æœ‰è¿™æœ¬ã€‚ é˜¿åŸŽæœ¬èº«ä¹Ÿæ˜¯ä¸ªå¾ˆæƒœå­—çš„äººï¼Œè¿™ä¹¦ä¹Ÿä¸åŽšï¼Œå¤§æ¦‚åå‡ ä¸‡å­—å§ï¼Œæ¢æˆç‹—è¡€çš„ç½‘æ–‡ï¼Œä¼°è®¡ä¹Ÿå°±ä¸¤ä¸ªå°æ—¶çœ‹å®Œäº†å§ã€‚ä¹Ÿæ€ªæˆ‘ä¸æ˜¯æœ‰æ’å¿ƒä¸€å£æ°”çœ‹å®Œï¼Œå±…ç„¶æ–­æ–­ç»­ç»­çœ‹äº†ä¸€å¹´ï¼Œä¹Ÿæ˜¯ç½ªè¿‡ã€‚äºå¾—é‡Œé¢éƒ½æ˜¯äº›ä¸€ä¸¤é¡µçš„å°çŸ­æ–‡ã€‚ é˜¿åŸŽçš„æ–‡å­—å®žåœ¨æ˜¯æœ‰ç‰¹ç‚¹å¾—å¾ˆï¼Œæå†™å«è€Œä¸å‘ï¼Œååˆ†éšå¿ï¼ŒåŠ ä¸Šå…¶è‡ªèº«ä¸­è¥¿è´¯é€šï¼Œåˆä¸Šå±±ä¸‹ä¹¡è¿‡ï¼Œå¯è°“è§è¯†è¿œåšã€‚æ–‡ç« çš„æƒ…èŠ‚è®¾ç½®çœ‹ä¼¼æœ´å®žæ— åŽï¼Œå´åˆäº”å‘³æ— ç©·ï¼Œè¿™ç­‰å‡ºç¥žå…¥åŒ–çš„åŠŸåŠ›å®žåœ¨æ˜¯å¹ä¸ºè§‚æ­¢ã€‚å…¶ä¸­ã€Šæ£‹çŽ‹ã€‹ï¼Œã€Šæ ‘çŽ‹ã€‹ï¼Œã€Šå­©å­çŽ‹ã€‹æœ€ä¸ºè‘—åï¼Œè™½ç„¶æ¯ç¯‡éƒ½å¾ˆçŸ­ï¼Œé¡¶å¤šç®—ä¸ªä¸­ç¯‡ï¼Œä½†æ€»æ˜¯å¯ä»¥å‡­å‡ å¥çœ‹ä¼¼éšæ„çš„ä¸€ä¸ªç»†èŠ‚æˆ–è€…ä¸€ä¸ªåŠ¨ä½œçš„æå†™ï¼ŒæŠŠäººç‰©å’Œæƒ…èŠ‚æå†™çš„å…¥æœ¨ä¸‰åˆ†ã€‚ é˜¿åŸŽçš„æ–‡å­—åˆè¯»æ„Ÿè§‰åªæ˜¯æè¿°äº†æƒ…èŠ‚ï¼Œç»†æƒ³å´ä¼¼æç»˜äº†ä½†æ˜¯ç¤¾ä¼šä¸‹äººä»¬çš„ç”Ÿæ´»çŠ¶æ€ï¼Œå†æƒ³ä¸‹å°±è¦è”ç³»åˆ°æµ©è¡çš„åŽ†å²é•¿æ²³äº†ã€‚å®žåœ¨æ˜¯åƒæœ‰é­”æ³•ä¸€èˆ¬ã€‚ ç™½å…ˆå‹‡ç™½å…ˆå‹‡ä¹‹å‰ä¹Ÿä¸å¤ªäº†è§£ï¼Œå¯èƒ½æœ‰æ—¶ä¼šçœ‹åˆ°ä»–å’Œçº¢æ¥¼æ¢¦ç»å¸¸è”ç³»åœ¨ä¸€èµ·å§ã€‚å·²ç»è®°ä¸æ¸…æ˜¯ä»€ä¹ˆæ—¶å€™å¬çš„ã€Šé”µé”µä¸‰äººè¡Œã€‹ä¸­ï¼Œæœ‰è°ˆåˆ°äº†ç™½å…ˆå‹‡ã€Šå°åŒ—äººã€‹ä¸­çš„ä¸€äº›æƒ…èŠ‚ï¼Œè®²è¿°éšå›½æ°‘å…šåŽ»å°æ¹¾çš„ä¸€äº›è€å…µçš„æ•…äº‹ï¼Œè§‰å¾—æœ‰äº›æ„æ€ï¼Œå°±æ”¾åœ¨äº†æƒ³è¯»çš„æ¸…å•é‡Œã€‚ 16å¹´æ˜¥èŠ‚è¿‡å®ŒåŽï¼Œå›žåŽ¦é—¨çš„åŠ¨è½¦ä¸Šï¼Œçœ‹å®Œäº†ã€Šå°åŒ—äººã€‹ã€‚ ç™½å…ˆå‹‡å…ˆç”Ÿçš„çˆ¶äº²æ˜¯è‘—åçš„å›½æ°‘å…šè‘—åå°†é¢†ç™½å´‡ç¦§ï¼Œæ›¾ä»»â€œä¸­åŽæ°‘å›½å›½é˜²éƒ¨éƒ¨é•¿â€ï¼ŒåŽéšå›½æ°‘å…šé€€å±…å°æ¹¾ã€‚ç™½å…ˆå‹‡ç»åŽ†äº†å’Œæ›¹é›ªèŠ¹ç±»ä¼¼çš„å®¶æ—ä»Žå·…å³°æ…¢æ…¢è¡°è½çš„è¿‡ç¨‹ï¼Œå¯èƒ½ä¹Ÿå› æ­¤ç™½å…ˆå‹‡ååˆ†æŽ¨å´‡çº¢æ¥¼æ¢¦ã€‚ ã€Šå°åŒ—äººã€‹ä¸»è¦è®²è¿°äº†ä»Žå¤§é™†éšå›½æ°‘å…šè¿å±…åˆ°å°æ¹¾çš„å„å±‚é˜¶çº§ï¼Œå„ç±»èŒä¸šçš„æ•…äº‹ã€‚é€šç¯‡è¿˜æ˜¯éžå¸¸æ‚²æƒ…çš„ï¼Œå„ç§æ€ä¹¡ç¦»æ„ï¼Œç”Ÿæ´»è‰°è¾›ï¼Œå„ç§å¾€æ˜”ç¾Žå¥½ç”Ÿæ´»å’Œå½“å‰æ®‹è´¥ç”Ÿæ´»çš„å¯¹æ¯”ï¼Œç™½å…ˆå‹‡æœ¬èº«ç‰¹æ®Šçš„èº«ä»½è®©ä»–å¯ä»¥è§‚å¯Ÿåˆ°å„ç§äººç¾¤çš„ç”Ÿæ´»çŠ¶æ€ï¼Œå¹¶è¿°è¯¸äºŽæ–‡å­—ã€‚ ç™½å…ˆå‹‡æå†™ä¸ä»…æœ‰ç”»é¢æ„Ÿï¼Œè€Œä¸”è¿˜æœ‰å£°éŸ³ã€‚å¼€ç¯‡å‡ ç¯‡å‡æ˜¯è¿å±…å°æ¹¾æœ€åŽå®¢æ­»ä»–ä¹¡çš„ä¸Šæµ·äººçš„æ•…äº‹ï¼Œå…¶å¯¹è¯ç”¨ä¸Šæµ·è¯æ¼”ç»Žä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚å¯ä»¥è¯´æ˜¯ä¼ ç¥žçš„å¾ˆã€‚é€šç¯‡åŸºæœ¬æ²¡æœ‰ç›´æŽ¥æŠ’æƒ…ï¼Œå‡æ˜¯æå†™æ€§å’Œè®°å½•æ€§çš„æ–‡å­—ï¼Œä½†æ˜¯é‚£ç§å¤±è½æ„Ÿå’Œè¿½å¿†å¾€æ˜”çš„æ„Ÿæƒ…ç¼ºå¤±æ‰‘é¢è€Œæ¥ã€‚è¿™ç‚¹å¯ä»¥è¯´è·Ÿé˜¿åŸŽæœ‰ç‚¹åƒã€‚ æˆ‘æ˜¯æ²¡æœ‰çœ‹è¿‡ã€Šçº¢æ¥¼æ¢¦ã€‹ï¼Œä¸€ç›´çœ‹äº†å‡ ç« å°±æ”¾å¼ƒäº†ï¼Œä½†æ˜¯ç™½å…ˆå‹‡çš„å†™æ³•è·Ÿã€Šçº¢æ¥¼æ¢¦ã€‹è¿˜æœ‰äº›ç±»ä¼¼çš„ï¼Œå…¶ä¸­å¯¹äºŽäººç‰©ï¼Œè¡£ç€ï¼Œå®¶å…·çš„æå†™å’Œã€Šçº¢æ¥¼æ¢¦ã€‹çš„â€œå¤´ä¸Šæˆ´ç€æŸå‘åµŒå®ç´«é‡‘å† â€¦â€å¾ˆæ˜¯ç±»ä¼¼çš„ã€‚ï¼ˆæ—¢ç„¶å¦‚æ­¤ï¼Œä¸ºä»€ä¹ˆã€Šå°åŒ—äººã€‹å¯ä»¥çœ‹å®Œï¼Œã€Šçº¢æ¥¼æ¢¦ã€‹æ€Žä¹ˆçœ‹ä¸ä¸‹ã€‚ï¼‰ å…¶ä»–Samsungç‰ˆçš„kindleé€äº†ä¸€æœ¬ã€Šå¹³åŽŸä¸Šçš„æ‘©è¥¿ã€‹ï¼Œä½œè€…æ˜¯åŒé›ªæ¶›ã€‚è¿™ä¸ªåå­—å®žåœ¨æ˜¯æ²¡å¬è¿‡ï¼Œç™¾åº¦äº†ä¸‹ï¼Œç®—æ˜¯æ–°é”ä½œå®¶ã€‚ä¸è¿‡è¿™ç¯‡ã€Šå¹³åŽŸä¸Šçš„æ‘©è¥¿ã€‹å®žåœ¨æ˜¯ç²¾å½©å¾—å¾ˆã€‚æ–‡å­—ä¸Šæœ‰äº›å…ˆé”‹æ–‡å­¦çš„æ„Ÿè§‰ï¼Œè¿˜å¸¦äº›é˜¿åŸŽçš„æ„Ÿè§‰ï¼Œæƒ…èŠ‚è™½è¯´ä¸æ˜¯ç‰¹åˆ«çš„å·§å¦™ï¼Œä½†æ˜¯å™è¿°çš„æ–¹æ³•å¾ˆæ˜¯é«˜æ˜Žã€‚éžå¸¸æŽ¨èã€‚ ã€Šåˆ°ç¯å¡”åŽ»ã€‹ï¼Œä½œè€…æ˜¯å¼—å‰å°¼äºšÂ·ä¼å°”å¤«ï¼Œä»¥å‰åº”è¯¥å­¦è¿‡å¥¹çš„ã€Šå¢™ä¸Šçš„æ–‘ç‚¹ã€‹ã€‚æ„è¯†æµå°è¯´æµæ´¾çš„ä»£è¡¨ä½œä¹‹ä¸€ã€‚æ²¡çœ‹å®Œï¼Œè¿˜åœ¨çœ‹ã€‚ç¬¬ä¸€æ¬¡çœ‹æ„è¯†æµçš„å°è¯´ï¼ˆä¹‹å‰å°±çœ‹å‡ é¡µçš„ã€Šè¿½å¿†é€æ°´å¹´åŽã€‹å’Œã€Šç¹åŽä¸ŽéªšåŠ¨ã€‹ä¸ç®—ï¼‰ï¼Œè·Ÿæˆ‘æƒ³çš„è¿˜ä¸ä¸€æ ·ã€‚æœ¬æ¥ä»¥ä¸ºæ„è¯†æµå°±æ˜¯ä½œè€…æƒ³ä»€ä¹ˆå°±å†™ä»€ä¹ˆï¼Œå®žé™…ä¸Šæ˜¯åœ¨æƒ…èŠ‚é‡Œï¼Œæ•…äº‹ä¸­çš„äººç‰©æƒ³ä»€ä¹ˆï¼Œå°±å†™ä»€ä¹ˆã€‚æœ¬èº«æ„è¯†æµå°è¯´è¿˜æ˜¯ä¸ªå°è¯´ï¼Œåªæ˜¯å¿ƒç†æ´»åŠ¨çš„æå†™æ›´å¤šäº›è€Œå·²ã€‚çŽ°åœ¨æ‰è®¤è¯†åˆ°è¿™ä¸ªç‚¹ï¼Œæƒ­æ„§ã€‚ ã€Šä¸‰ä½“ã€‹ï¼Œåœ¨å¤§åˆ˜èŽ·é›¨æžœå¥–ä¹‹å‰ï¼Œå°±å·²ç»å°è¯•äº†ä¸ä¸‹ä¸‰æ¬¡åŽ»çœ‹è¿™å¥—ä¹¦äº†ï¼Œæ¯æ¬¡éƒ½çœ‹åˆ°å¶æ–‡æ´åˆ°ç§˜å¯†å†›äº‹åŸºåœ°å°±çœ‹ä¸‹ä¸åŽ»äº†ã€‚å¤§åˆ˜çš„å…¶ä»–çš„çŸ­ç¯‡å°è¯´å€’æ˜¯éƒ½è¢«æˆ‘çœ‹å®Œäº†ã€‚ç¡®å®žååˆ†å¾—ç²¾å½©ã€‚åº”è¯¥æ‰¾æ—¶é—´å†ä¸€æ¬¡å°è¯•ã€Šä¸‰ä½“ã€‹äº†ã€‚ æœ€è¿‘åœ¨çœ‹éƒè¾¾å¤«çš„ä¸€äº›ä¸­çŸ­ç¯‡çš„å°è¯´ï¼Œä¸»è¦æŒ‰ç…§è¿™æœ¬é›†å­çœ‹ã€‚éƒè¾¾å¤«çš„å°è¯´æ€Žä¹ˆè¿™ä¹ˆé¢“ä¸§ï¼Œè·Ÿä»¥å‰è¯¾æœ¬çš„ã€Šæ•…éƒ½çš„ç§‹ã€‹æ„Ÿè§‰å®Œå…¨ä¸ä¸€æ ·ã€‚å€’æ˜¯è®©æˆ‘è”æƒ³åˆ°ä¹‹å‰å…³äºŽé—½å—è¯­æ­Œæ›²çš„ä¸€ä¸ªæ®µå­ï¼š é—½å—è¯­æ­Œæ›²ä¸‰å¤§ä¸»é¢˜ï¼šè€å¨˜è¦ç”·äººã€æˆ‘å‘½æ€Žä¹ˆé‚£ä¹ˆè‹¦ã€è€å­ä¸€å®šä¼šæˆåŠŸã€‚ éƒè¾¾å¤«çš„å°è¯´çš„ä¸»é¢˜å€’æ˜¯è·Ÿé—½å—è¯­æ­Œæ›²å‰ä¸¤ä¸ªä¸»é¢˜å¾ˆç›¸ä¼¼ï¼šæˆ‘è¦å¥³äººï¼Œæˆ‘å¥½è‹¦ã€‚å…³é”®æ²¡æœ‰æœ€åŽé‚£ä¸ªæˆ‘ä¸€å®šä¼šæˆåŠŸã€‚å•Šå“ˆå“ˆ~ çœ‹äº†å‡ ç¯‡ï¼Œæ„æ€éƒ½æ˜¯ï¼šå¥½æƒ³è·Ÿé‚£ä¸ªå¥³äººå‘ç”Ÿå…³ç³»ï¼Œä½†æ˜¯æˆ‘ä¸èƒ½ç¥¸å®³å¥¹ï¼Œè¿™éƒ½æ˜¯è¿™ä¸ªç¤¾ä¼šçš„é”™ï¼Œæˆ‘è¦å¤ä»‡ã€‚æœ‰è¶£ï¼Œæœ‰è¶£ï¼Œæœ‰è¶£ã€‚ å¦å¤–è¿˜æœ‰äº›æå†™æˆ˜äº‰å¹´ä»£ä¸‹çš„äººä»¬ç”Ÿæ´»çš„å°è¯´ï¼Œç”±äºŽéƒè¾¾å¤«ä¹Ÿæ˜¯æµ™æ±Ÿäººï¼Œæœ‰äº›æå†™çœ‹äº†ä¹Ÿæ˜¯ç‰¹åˆ«çš„äº²åˆ‡ã€‚éƒè¾¾å¤«çš„æ–‡å­—è¿˜æ˜¯å¾ˆæœ‰æ°´å¹³çš„ï¼Œå¦‚æžœæƒ…ç»ªä¸æ˜¯å¾ˆæ¶ˆæžçš„æƒ…å†µä¸‹ï¼Œçœ‹ä¸‹è¿˜æ˜¯å¯ä»¥çš„ï¼Œå¦‚æžœè‡ªèº«å¾ˆé¢“ä¸§ï¼Œå†çœ‹éƒè¾¾å¤«çš„å°è¯´ï¼Œä¼°è®¡è¦å¿§éƒç—‡äº†ã€‚ è‹±è¯­é—®é¢˜è‹±è¯­æ˜¯åŸºæœ¬è’åºŸäº†ï¼Œå°è¯•æŠ¢æ•‘äº†å‡ æ¬¡ï¼Œæ„Ÿè§‰åƒæ˜¯æŠ¢æ•‘ä¸è¿‡æ¥äº†ã€‚ è¯­è¨€è¯´åˆ°åº•åªæ˜¯ä¸ªå·¥å…·ï¼Œå·¥å…·ä¸ç”¨çš„è¯ï¼Œè‚¯å®šä¼šç”Ÿç–çš„ã€‚çŽ°åœ¨çš„çŠ¶æ€ï¼Œå¬è¯´åŸºæœ¬å°±æ˜¯åºŸäº†ã€‚å†™çš„è¯ï¼ŒåŸºæœ¬é è¯å…¸ï¼ŒåŸºæœ¬åªä¼šç®€å•å•è¯å’Œå¥å­äº†ã€‚ç»ˆäºŽè¯»è¿˜èƒ½è¯»äº›ã€‚å¯æ‚²ï¼Œå¯æ‚²ï¼Œæ€Žä¹ˆæœ‰ç§ä»¥å‰è‹±è¯­å¾ˆå¥½çš„é”™è§‰ã€‚ è‹±è¯­è¿˜æ˜¯å¾ˆé‡è¦æ»´ï¼Œæ‰‹æœºä¸Šä¸‹äº†ä¸ªAPPï¼Œå°±åšæŒä¸€ä¸ªç¤¼æ‹œï¼Œåº”è¯¥è¦é‡æ‹¾èµ·æ¥å‘€ã€‚åºŸç‰©ï¼ŒåºŸç‰©ï¼ŒåºŸç‰©ã€‚]]></content>
      <tags>
        <tag>ç—´äººè¯´æ¢¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ELKåˆä½“éªŒ]]></title>
    <url>%2F2017%2F09%2F24%2Fmeet-ELK%2F</url>
    <content type="text"><![CDATA[â€‹ è¿‘æœŸé‡åˆ°æœ‰åˆ†æ—¥å¿—æ•°æ®éœ€è¦åˆ†æžï¼Œè®¡ç®—éƒ¨åˆ†ä¸ç®—å¤æ‚ï¼Œç›´æŽ¥shellè„šæœ¬è·‘ä¸€éå¤§è‡´ä¹Ÿå¯ä»¥å®Œæˆï¼Œä½†æ˜¯å…¶æ•°æ®ç»´åº¦è¾ƒå¤šï¼Œåˆ†æžç»“æžœä¸æ˜“å±•ç¤ºã€‚å¸Œæœ›å¯ä»¥å¯¼å…¥æ•°æ®åº“ï¼ŒæŒ‰ç…§éœ€è¦sqlæå–æ•°æ®ï¼Œè¿›è¡Œå±•ç¤ºã€‚ â€‹ å¯¹äºŽç¬”è€…è¿™ç§æ²¡æœ‰å¼€å‘ç»éªŒçš„å°ç™½æ¥è¯´ï¼Œåšè¿™ä¹ˆç³»ç»Ÿæ˜¯å¤©æ–¹å¤œè°­äº†ã€‚ï¼ˆè®¤æ¸…çŽ°å®žå‘€ï¼‰ â€‹ æ‰€ä»¥å¿…é¡»å¾—æœ‰çŽ°æˆçš„è§£å†³æ–¹æ¡ˆçš„ï¼Œé™„ä¸Šæ¡ä»¶ï¼š å¼€æºçš„ï¼Œå¯ä¸å¸Œæœ›ä¸ºäº†è¿™ä¸ªä»˜å‡ºå¤§ä»£ä»·ï¼› æ¯”è¾ƒæµè¡Œçš„ï¼Œå¯¹äºŽå°ç™½æ¥è¯´ï¼Œè‚¯å®šä¼šé‡åˆ°å„ç§é—®é¢˜ï¼Œæ‰€ä»¥æœ€å¥½æœ‰å„ç§æ•™ç¨‹ï¼Œæœ‰è®ºå›ï¼› â€‹ç™¾åº¦ã€googleéƒ½å¯ä»¥ï¼Œå¾ˆå®¹æ˜“å°±å¯ä»¥æ‰¾åˆ°ä»Šå¤©çš„ä¸»è§’ï¼ŒELKï¼Œä¹Ÿå°±æ˜¯elasticsearch+logstash+kibanaã€‚ ELKæ˜¯ä»€ä¹ˆï¼Ÿâ€‹ å°ç™½å¯¹äºŽELKçš„ç†è§£æ¯”è¾ƒç®€å•ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·ï¼š â€‹ ELKæ˜¯ä¸‰ä¸ªç‹¬ç«‹ç»„ä»¶ç»„æˆä¸€å¥—æ•°æ®æŽ¥æ”¶ï¼Œå¤„ç†ï¼ˆç®€å•å¤„ç†ï¼‰ï¼Œå­˜å‚¨ï¼Œä»¥åŠå±•ç¤ºçš„ç³»ç»Ÿã€‚ â€‹ å…¶ä¸­çš„ä¼˜ç‚¹æ˜¯ï¼š å®Œæˆéƒ¨ç½²åŽï¼Œæ˜¯å®žæ—¶å¤„ç†æ•°æ®çš„ï¼Œååˆ†ä¾¿æ·ï¼› å¬è¯´elasticsearchå¯ä»¥åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œè¿ä½œï¼Œå¯ç”¨æ€§å’Œæ‰¿è½½é‡å¾ˆé«˜ï¼›ï¼ˆå°ç™½å•¥ä¹Ÿä¸çŸ¥é“ï¼Œä½ è¯´å¥½ç”¨å°±å¥½ç”¨å§ï¼‰ éƒ¨ç½²ç®€å•ï¼ŒåŸºæœ¬å°±è§£åŽ‹å°±å¯ä»¥ç”¨äº†ï¼› å…¶æž¶æž„å¤§æ¦‚å¦‚æ­¤ï¼š å®‰è£…ELKç³»ç»ŸçŽ¯å¢ƒâ€‹ æœ¬æ¬¡ä½¿ç”¨çš„ä¸ºå•å°çš„CentOS 5.8çš„ç‰©ç†æœºã€‚ Distributor ID: CentOS Description: CentOS release 5.8 (Final) Release: 5.8 Codename: Final javaçŽ¯å¢ƒâ€‹ å¦å¤–è¿™å¥—ç³»ç»Ÿå…¨éƒ¨ç”±è¿è¡Œåœ¨javaä¸Šï¼Œæ‰€ä»¥éœ€è¦java1.8çš„çŽ¯å¢ƒï¼Œå…·ä½“å®‰è£…ä¸å†èµ˜è¿°ï¼Œå‚è€ƒè¿™ç¯‡åšæ–‡ã€‚ # java -version java version "1.8.0_144" Java(TM) SE Runtime Environment (build 1.8.0_144-b01) Java HotSpot(TM) 64-Bit Server VM (build 25.144-b01, mixed mode) å®‰è£…ELKâ€‹ å®‰è£…ä¸Šæ–‡å·²ç»ä»‹ç»äº†ï¼Œéžå¸¸ç®€å•ï¼Œåœ¨ELASTICå®˜ç½‘ä¸‹è½½ï¼Œä¸‹è½½è§£åŽ‹å³å¯ã€‚ â€‹ æœ¬æ¬¡ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ï¼š elasticsearch-5.5.2 logstash-5.5.2 kibana-5.5.2 é…ç½®å¯åŠ¨logstashâ€‹ logstashè¿›è¡Œç®€å•çš„é…ç½®ä¹‹åŽï¼Œå°±å¯ä»¥ç›´æŽ¥è¿è¡Œäº†ã€‚ ç®€å•æµ‹è¯•â€‹ æŒ‰ç…§æƒ¯ä¾‹ä¼šä½¿ç”¨æœ€ç®€å•çš„stdè¾“å…¥å’Œstdè¾“å‡ºæµ‹è¯•logstashèƒ½å¦æ­£å¸¸å·¥ä½œã€‚ ./logstash-5.5.2/bin/logstash -e 'input{stdin{}}output{stdout{codec=>rubydebug}}' â€‹ åœ¨æ ‡å‡†è¾“å…¥ä¸­è¾“å…¥å†…å®¹ã€‚æ¯”å¦‚testï¼Œä¼šåœ¨æ ‡å‡†è¾“å‡ºæ‰“å°å…ˆç›¸å…³å†…å®¹ã€‚ { "@timestamp" => 2017-09-19T15:24:24.021Z, "@version" => "1", "host" => "localhost", "message" => "test" } â€‹ å…¶ä¸­@timestampå­—æ®µæ˜¯äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ï¼Œé»˜è®¤ä¼šæ·»åŠ ã€‚ ç®€å•é…ç½®â€‹ ç¼–è¾‘è¯¥é…ç½®æ–‡ä»¶./logstash-5.5.2/config/logstash.confï¼Œå¡«å…¥logstashçš„è¾“å…¥input{}ï¼Œå¤„ç†filter{}ï¼Œè¾“å‡ºoutput{}ä¿¡æ¯ï¼š input{ #è¾“å…¥ç›¸å…³é…ç½® } filter{ #æ•°æ®å¤„ç†ç›¸å…³é…ç½® } output{ #è¾“å‡ºç›¸å…³é…ç½® } input{}â€‹ input{}å³è¾“å…¥ç›¸å…³é…ç½®ï¼Œlogstashæ”¯æŒæ–‡ä»¶å½¢å¼(file)ï¼Œæ ‡å‡†è¾“å…¥(stdin)ï¼Œsyslogåè®®(syslog)ï¼Œtcp(tcp)å››ç§æ–¹å¼ã€‚ â€‹ inputè¿˜æ”¯æŒå¸¸è§çš„æ•°æ®æ ¼å¼ï¼Œå¦‚jsonï¼Œéœ€è¦ä½¿ç”¨codecæ’ä»¶ï¼Œè¯¦ç»†ä¸èµ˜è¿°ã€‚å¯ä»¥æŸ¥çœ‹å®˜ç½‘å­¦ä¹ ã€‚ filter{}â€‹ filter{}å³logstashä¸­çš„æ•°æ®å¤„ç†éƒ¨åˆ†ï¼Œä¸»è¦æœ‰å„ç±»ä¸°å¯Œçš„æ’ä»¶å®Œæˆã€‚è¿™è¾¹ä»‹ç»ä¸‹ä½¿ç”¨çš„å¸¸è§çš„å‡ ä¸ªï¼š grokâ€‹ grokå¯ä»¥ç¼–ç å„ç§æ­£åˆ™æ¥æå–æ‰€éœ€è¦çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šæ•°æ®çš„æ ¼å¼ã€‚å…¶åŸºæœ¬è¯­æ³•ä¸ºï¼š filter { grok { match => { "message" => "Duration: %{NUMBER:duration}" } } } â€‹ å…¶ä¸­NUMBERæ˜¯äº‹å…ˆç¼–å†™å¥½çš„patternï¼Œæˆ–è€…æ˜¯è‡ªå¸¦çš„patternï¼Œä¸Šä¾‹çš„å«ä¹‰ä¸ºï¼Œå°†Duration:åŽç¬¦åˆNUMBERpatternçš„æ•°æ®èµ‹å€¼ç»™durationã€‚ â€‹ grokè¯¦ç»†æ“ä½œä¸Žä»‹ç»å¯ä»¥å‚è€ƒgrokå®˜æ–¹ä»‹ç»ã€‚ dateâ€‹ dateæ’ä»¶å¯ä»¥å°†æ—¥æœŸå’Œæ—¶é—´æ ¼å¼çš„æ•°æ®è½¬åŒ–æˆæƒ³è¦çš„æ ¼å¼ï¼Œå…¶ä¸­ä¹Ÿå†…ç½®å¾ˆå¤šæ ‡å‡†çš„æ ¼å¼ï¼Œå…¶åŸºæœ¬è¯­æ³•ä¸ºï¼š filter { date { match => [ "logdate", "MMM dd yyyy HH:mm:ss" ] } } â€‹ ä¸Šä¾‹çš„å«ä¹‰ä¸ºï¼Œå°†logdateçš„æ—¥å¿—æ ¼å¼è½¬ä¸ºMMM dd yyyy HH:mm:ssçš„å½¢å¼ã€‚ â€‹ dateè¯¦ç»†æ“ä½œä¸Žä»‹ç»å¯ä»¥å‚è€ƒdateå®˜æ–¹ä»‹ç»ã€‚ jsonâ€‹ jsonæ’ä»¶å¯ä»¥å¯¹grokmatchåˆ°çš„å˜é‡è¿›è¡Œjsonè§£æ ¼å¼ï¼Œå…¶åŸºæœ¬ç”¨æ³•ä¸ºï¼š filter { json { source => "message" } } â€‹ ä¸Šä¾‹çš„å«ä¹‰ä¸ºï¼Œå°†sourceè§£jsonã€‚ â€‹ jsonè¯¦ç»†æ“ä½œä¸Žä»‹ç»å¯ä»¥å‚è€ƒjsonå®˜æ–¹ä»‹ç»ã€‚ splitâ€‹ splitå¯ä»¥å°†æŸä¸€äº‹ä»¶æŒ‰ç…§æŸä¸ªå­—ç¬¦è¿›è¡Œæ‹†åˆ†ï¼Œæ¯”å¦‚ï¼š filter { split { field => "message" terminator => "#" } } â€‹ ä¸Šä¾‹çš„å«ä¹‰ä¸ºï¼Œå°†messagefieldæŒ‰ç…§#è¿›è¡Œæ‹†åˆ†ã€‚ â€‹ splitè¯¦ç»†æ“ä½œä¸Žä»‹ç»å¯ä»¥å‚è€ƒsplitå®˜æ–¹ä»‹ç»ã€‚ å…¶ä»–â€‹ å…³äºŽfilterå…¶ä»–æ’ä»¶ä»¥åŠä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥æŸ¥çœ‹è¿™é‡Œã€‚ output{}â€‹ logstashæ”¯æŒéžå¸¸å¤šçš„è¾“å‡ºé€‰é¡¹ï¼Œè¾“å‡ºåˆ°æ–‡ä»¶ï¼Œè¾“å‡ºåˆ°stdoutï¼Œè¾“å‡ºåˆ°ç«¯å£ï¼Œè¾“å‡ºåˆ°emailç­‰ï¼Œæ¯”å¦‚å¸¸è§çš„è¾“å‡ºåˆ°elasticsearchï¼š output { elasticsearch { hosts => ["192.168.0.2:9200"] index => "logstash-%{type}-%{+YYYY.MM.dd}" document_type => "%{type}" flush_size => 20000 idle_flush_time => 10 sniffing => true template_overwrite => true } } â€‹ elasticsearchè¾“å‡ºå‚æ•°éžå¸¸å¤šï¼Œå¯å®šåˆ¶æ€§ä¹Ÿå¾ˆå¼ºï¼Œå¯ä»¥ä»Želasticsearchå®˜æ–¹ä»‹ç» äº†è§£è¯¦ç»†çš„ä¿¡æ¯ã€‚ â€‹ å…¶ä»–å½¢å¼çš„è¾“å‡ºä¹Ÿå¯ä»¥ä»Žoutputå®˜æ–¹ä»‹ç»äº†è§£ã€‚ å…¶ä»–â€‹ å…³äºŽlogstashçš„å…¶ä»–é…ç½®å’ŒåŠŸèƒ½ï¼Œå¯ä»¥æŸ¥çœ‹å…¶å®˜æ–¹æ•™ç¨‹ã€‚ å¯åŠ¨logstash./logstash-5.5.2/bin/logstash -f ./logstash-5.5.2/conf/logstash.conf Elasticsearchâ€‹ elasticsearchç»è¿‡ç®€å•é…ç½®ï¼Œç›´æŽ¥è¿è¡Œå³å¯ã€‚ vi ./config/elasticsearch.yml ... #ä¿®æ”¹clusteråç§° cluster.name: test_cluster #ä¿®æ”¹nodeåç§° node.name: node-1 #å¡«å†™IP network.host: ***.***.***.*** #å¡«å†™ç«¯å£ http.port: 9200 â€‹ å…¶ä»–é…ç½®æ ¹æ®éœ€è¦é…ç½®ã€‚æ€»ä½“æ¥è¯´é…ç½®çš„å†…å®¹è¾ƒå°‘ã€‚ç›´æŽ¥å¯åŠ¨ç¨‹åºï¼Œæµ‹è¯•9200æ˜¯å¦å¯ä»¥æ­£å¸¸è¿è¡Œã€‚ ./bin/elasticsearch curl http://***.***.***.***:9200/ { "name" : "node-1", "cluster_name" : "test_cluster", "cluster_uuid" : "lIW3ERtnQGqoXd_fPZgr6Q", "version" : { "number" : "5.5.2", "build_hash" : "b2f0c09", "build_date" : "2017-08-14T12:33:14.154Z", "build_snapshot" : false, "lucene_version" : "6.6.0" }, "tagline" : "You Know, for Search" } â€‹ è¿”å›žesçš„ä¸€äº›ä¿¡æ¯ï¼Œè¡¨ç¤ºesæ­£å¸¸è¿è¡Œã€‚ æ³¨æ„äº‹é¡¹: â€‹ ESæœ¬èº«ä¸å…è®¸rootè¿è¡Œï¼Œå¹¶ä¸”å¯¹äºŽè¿è¡Œæœ‰äº›æ¡ä»¶ã€‚å¦‚æžœæœºå™¨æ€§èƒ½è¾¾ä¸åˆ°è¦æ±‚ï¼Œå¯ä»¥åœ¨./configjvm.optionsä¸­è°ƒä½Žjavaè¿è¡Œå‚æ•°ã€‚ â€‹ å¦å¤–ï¼Œå¦‚æžœæœ‰ä»¥ä¸‹æŠ¥é”™ï¼Œè¯·æ›´æ”¹å“åº”çš„å‚æ•°ã€‚ ERROR: [3] bootstrap checks failed [1]: max file descriptors [4096] for elasticsearch process is too low, increase to at least [65536] [2]: max number of threads [1024] for user [elk] is too low, increase to at least [2048] [3]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144] sysctl -w vm.max_map_count=262144 vim /etc/security/limits.conf elk soft nofile 65536 elk hard nofile 65536 elk soft nproc 2048 elk hard nproc 4096 â€‹ å‡ºçŽ°ä»¥ä¸‹æŠ¥é”™ system call filters failed to install; check the logs and fix your configuration or disable system call filters at your own risk â€‹ å› ä¸ºCentos6ä¸æ”¯æŒSecCompï¼Œå¯¼è‡´å¯åŠ¨å¤±è´¥ï¼Œè¯¦æƒ…å¯ä»¥çœ‹githubè¿™ä¸ªissueã€‚ â€‹ è§£å†³åŠžæ³•æ˜¯å…³é—­ä¸‹é¢ä¸¤ä¸ªé€‰é¡¹ï¼š vi ./config/elasticsearch.yml bootstrap.memory_lock: false bootstrap.system_call_filter: false kibanaâ€‹ kibanaç»è¿‡ç®€å•é…ç½®ï¼Œç›´æŽ¥è¿è¡Œå³å¯ã€‚ vi ./config/kibana.yml ... #é…ç½®ç«¯å£ server.port: 5601 #é…ç½®host server.host: "***.***.***.***" #é…ç½®esæŸ¥è¯¢åœ°å€ elasticsearch.url: "http://124.164.8.39:9200" â€‹ å…¶ä½™é…ç½®é¡¹å¯ä»¥ä¿ç•™é»˜è®¤å€¼ã€‚ ./bin/kibana #curlæŽ¢æµ‹æˆåŠŸå³å¯ã€‚ curl -I http://124.164.8.39:5601 HTTP/1.1 200 OK kbn-name: kibana kbn-version: 5.5.2 cache-control: no-cache Date: Sun, 24 Sep 2017 08:05:21 GMT Connection: keep-alive ç»“è¯­kibanaç•Œé¢ï¼š kibanaç»˜å›¾ï¼š å…¶ä»–åŠŸèƒ½ç ”ç©¶ä¸­~ st=>start: origin e=>end: browser op1=>operation: logstashå¤„ç†æ•°æ®åŽå‘é€ES op2=>operation: ElasticSearch op3=>operation: kibanaä»ŽESè¯»å–æ•°æ®å±•ç¤º st->op1->op2->op3->e{"theme":"simple","scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12} var code = document.getElementById("flowchart-0-code").value; var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value)); var diagram = flowchart.parse(code); diagram.drawSVG("flowchart-0", options);]]></content>
      <tags>
        <tag>LINUX</tag>
        <tag>analysis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[hexoå®‰è£…ä¸Žè®¾ç½®]]></title>
    <url>%2F2017%2F08%2F26%2Fhexo-setup-and-config%2F</url>
    <content type="text"><![CDATA[æ­¤ç¯‡ç®€å•ä»‹ç»hexoå’Œä¸»é¢˜çš„å®‰è£…ï¼Œä»¥åŠä¸€ä¸ªé…ç½®é¡¹ã€‚ å®‰è£…hexoå®‰è£…Gitå’Œnode.jsåŽï¼Œæ‰“å¼€gitbash npm install -g hexo-cli ä¸€äº›å¿…è¦çš„æ’ä»¶å°†ä¼šè‡ªåŠ¨ä¾èµ–å®‰è£…ï¼Œä¸éœ€è¦å¦è¡Œå®‰è£…ã€‚ åˆå§‹åŒ–hexo hexo init "C:\Users\jingkaixu\OneDrive\GitHub" ä¼šæœ‰å‡ ä¸ªwarningï¼Œä¸å½±å“æœ€ç»ˆçš„å®‰è£…ç»“æžœã€‚æ­¤æ—¶hexoå·²å®Œæˆå®‰è£…ã€‚åˆæ­¥å¯ä»¥ä½¿ç”¨ã€‚ å®‰è£…ä¸»é¢˜ä¸‹è½½å–œæ¬¢çš„ä¸»é¢˜ï¼Œå¹¶é…ç½®å¯ç”¨ã€‚é…ç½®å‚è€ƒä¸»é¢˜æä¾›æ–¹æ‰€ç»™æ–‡æ¡£ã€‚æ­¤å¤„é‡‡ç”¨æ¯”è¾ƒæµè¡Œçš„NexTä¸»é¢˜ã€‚ ä¸»é¢˜é…ç½®æ–‡ä»¶æ³¨æ„æ¯ä¸ªé…ç½®é¡¹çš„ï¼šä¹‹åŽè¦æœ‰ä¸ªç©ºæ ¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ NexTå®‰è£…å¯ä»¥å‚è€ƒå…¶å®˜æ–¹æ–‡æ¡£ï¼Œä¸å†èµ˜è¿°ã€‚NexT ä¸Šä¼ æ–¹å¼é…ç½®deployæ–¹æ³•ï¼Œç”±äºŽä½¿ç”¨äº†githubçš„pageæœåŠ¡ï¼Œæ‰€ä»¥é€‰æ‹©ssh deployã€‚ åœ¨æœ¬åœ°ç”ŸæˆsshæŒ‡çº¹åŽï¼Œæ·»åŠ åˆ°githubçš„deploy keysä¸­ã€‚ å…·ä½“å¯ä»¥å‚è€ƒè¿™æ¡ç™¾åº¦ç»éªŒã€‚ è®¾ç½®apple-touch-iconSafariæµè§ˆå™¨æ”¶è—çš„æ—¶å€™ï¼Œä¸ä¼šé‡‡ç”¨favicon.icoæœ€ä¸ºé»˜è®¤å›¾æ ‡ï¼Œè€Œæ˜¯æœ‰ä¸ªapple-touch-iconä½œä¸ºå›¾æ ‡ï¼Œå¯ä»¥å‚è€ƒè‹¹æžœå®˜æ–¹æ–‡æ¡£ï¼Œæ­¤æ—¶éœ€è¦åœ¨ä¸»é¢˜ç›®å½•ä¸­ä¿®æ”¹\themes\next\layout\_custom\header.swigæ–‡ä»¶ï¼Œåœ¨å…¶ä¸­æ–°å¢žä¸€ä¸ª&lt;linkrel=&quot;apple-touch-icon&quot; href=&quot;apple-touch-icon.png&quot;/&gt;ï¼Œå¦‚æ­¤å†ç”Ÿæˆé™æ€æ–‡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨åŠ å…¥è¿™ä¸€è¡Œä»£ç ã€‚å†åœ¨sourceç›®å½•ä¸­åŠ å…¥ä¿¡å·çš„apple-touch-icon.pngå³å¯ã€‚]]></content>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[grep awkåŒ¹é…å­—ç¬¦ä¸²æ€§èƒ½å¯¹æ¯”]]></title>
    <url>%2F2017%2F08%2F20%2Fgrep-awk-matching-performance%2F</url>
    <content type="text"><![CDATA[è¿‘æœŸé‡åˆ°ä¸ªåœºæ™¯ï¼Œéœ€è¦åœ¨æŸä¸ªè¾ƒå¤§çš„æ–‡æœ¬ä¸­åŒ¹é…ç‰¹å®šçš„ä¸€æ‰¹å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶æ»¤é™¤æˆ–è€…æ‰“å°å‡ºæ¥ã€‚ ä½¿ç”¨äº†shellçš„grepå’Œawkï¼Œå¯¹äºŽè¿™ä¸¤ä¸ªå·¥å…·çš„æ–‡æœ¬å¤„ç†æ•ˆçŽ‡å’Œæ–¹æ³•æœ‰äº†äº›åŸºæœ¬çš„è®¤è¯†ã€‚ grepæœ€åˆçš„æƒ³æ³•æ˜¯grepå‘½ä»¤ï¼Œå³ï¼š grep -Ff A B #æ‰“å°æ–‡ä»¶Aå’Œæ–‡ä»¶Bä¸­æœ‰ç›¸åŒå­—ç¬¦ä¸²çš„è¡Œ grep -vFf A B #æ‰“å°æ–‡ä»¶Bä¸­æœ‰ï¼Œä½†æ˜¯æ–‡ä»¶Aä¸­æ²¡æœ‰çš„è¡Œ ç”±äºŽå¾…å¤„ç†çš„æ–‡ä»¶æœ‰ç™¾ä¸‡ç”šè‡³åƒä¸‡è¡Œï¼Œç›´æŽ¥grepå¯¼è‡´å°†å†…å­˜çˆ†ç‚¸ã€‚æµ‹è¯•ä½¿ç”¨çš„2Gå†…å­˜VPSç›´æŽ¥è¿›ç¨‹killedï¼Œè€Œä½¿ç”¨äº†32Gå†…å­˜çš„ç‰©ç†æœºï¼Œåœ¨è¿è¡Œä¸€æ®µæ—¶é—´åŽï¼Œç›´æŽ¥å®•æœºã€‚ãƒŸï¾ŸÐ”ï¾Ÿå½¡ awkåŽç»­ä½¿ç”¨äº†awkä¸­çš„åŒ¹é…åŠŸèƒ½ï¼Œæ•´ä½“å†…å­˜ä½¿ç”¨åœ¨1Gå·¦å³ï¼Œæ•ˆçŽ‡ä¹Ÿé«˜å¾ˆå¤šã€‚ awk 'ARGIND==1 {a[$0]} ARGIND>1&amp;&amp;($3 in a) {print $0}' A B #ARGINDè¡¨ç¤ºå½“å‰æ–‡ä»¶åºå· #å°†Aæ–‡ä»¶çš„$0èµ‹å€¼åˆ°æ•°ç»„aï¼Œå¦‚æžœBæ–‡ä»¶æŸè¡Œçš„$3æœ‰åœ¨æ•°ç»„aä¸­å‡ºçŽ°ï¼Œåˆ™æ‰“å°è¯¥è¡Œï¼› awk 'ARGIND==1 {a[$0]} ARGIND>1&amp;&amp;!($3 in a) {print $0}' A B #å°†Aæ–‡ä»¶çš„$0èµ‹å€¼åˆ°æ•°ç»„aï¼Œå¦‚æžœBæ–‡ä»¶æŸè¡Œçš„$3æ²¡æœ‰åœ¨æ•°ç»„aä¸­å‡ºçŽ°ï¼Œåˆ™æ‰“å°è¯¥è¡Œï¼› å¦‚æ­¤è¿™èˆ¬ï¼Œawkçš„æ–‡æœ¬å¤„ç†æ•ˆçŽ‡ç¡®å®žå¾ˆé«˜ï¼Œä½¿ç”¨æ–¹æ³•ååˆ†çµæ´»ã€‚å¥½å¥½å­¦ä¹ è¿™ä¸ªå§~]]></content>
      <tags>
        <tag>LINUX</tag>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux+Nginx+MariaDB+PHP_SERVER_BUILDING]]></title>
    <url>%2F2017%2F01%2F03%2FLinux-Nginx-MariaDB-PHP%2F</url>
    <content type="text"><![CDATA[Linux+Nginx+MariaDB+PHP,LNMPæž¶æž„çš„åŠ¨æ€ç½‘ç«™æœåŠ¡å™¨æ˜¯æ¯”è¾ƒæµè¡Œçš„webæœåŠ¡å™¨æ•´ä½“ç»“æž„æ–¹æ¡ˆï¼Œç”±å‰å‡ å¹´æ¯”è¾ƒæµè¡Œçš„LAMPï¼ˆLinux+Apache+Mysql+PHPï¼‰å‘å±•è€Œæ¥ã€‚å…¶ä¸­å°†Apacheæ›¿æ¢æˆå¯¹ç¡¬ä»¶è¦æ±‚æ›´ä½Žï¼Œå¹¶å‘æ•°æ›´é«˜å¹¶ä¸”å¼€æºçš„Nginxï¼›å°†è¢«Oracleæ”¶è´­äº†çš„Mysqlæ¢æˆäº†å®Œå…¨å…¼å®¹Mysqlçš„MariaDBï¼›å…¶ä»–ä¸å˜ã€‚æœ¬æ¬¡çªå‘å¥‡æƒ³å†³å®šçŽ©ä¸€ä¸‹PHPï¼Œæ‰€ä»¥åœ¨VPSä¸Šæ­äº†ä¸ªLNMPçŽ¯å¢ƒã€‚ Linuxé€‰æ‹©VPSæä¾›å•†é•œåƒã€‚KVMæž¶æž„çš„VPSä¹Ÿå¯ä»¥è‡ªè¡Œå®‰è£…å„å¤§Linuxå‘è¡Œç‰ˆã€‚æ­¤å¤„å®‰è£…çš„æ˜¯ # cat /etc/redhat-release CentOS release 6.6 (Final) # uname -a Linux LA 2.6.32-042stab113.21 #1 SMP Wed Mar 23 11:05:25 MSK 2016 i686 i686 i386 GNU/Linux NginxVPSæä¾›çš„é•œåƒçš„yumæºçš„å„ä¸ªè½¯ä»¶ç‰ˆæœ¬éƒ½è¾ƒä½Žï¼Œä¸ºäº†å®‰è£…æ›´æ–°ç‰ˆçš„nginxï¼Œæ­¤å¤„é€‰æ‹©è‡ªè¡Œç¼–è¯‘æºç å®‰è£…nginxã€‚æ­¤å¤„nginxå®‰è£…å‚è€ƒè¿™ç¯‡åšå®¢ éœ€è¦é¦–å…ˆå®‰è£…gccã€gcc-c++ã€opensslæ­¤å¤„é€‰æ‹©ç®€å•çš„yumå®‰è£… yum install -y gcc gcc-c++ openssl ä¸‹è½½nginxæºç å’Œå…¶æ‰€éœ€çš„PCREåº“ä¸Žzlibåº“æºç  mkdir nginx cd nginx wget http://nginx.org/download/nginx-1.8.1.tar.gz wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.38.tar.gz wget https://ncu.dl.sourceforge.net/project/libpng/zlib/1.2.8/zlib-1.2.8.tar.gz tar zxvf nginx-1.8.1.tar.gz tar zxvf pcre-8.38.tar.gz tar zxvf zlib-1.2.8.tar.gz ç¼–è¯‘å®‰è£…nginx cd nginx-1.8.1 ./configure --prefix=/usr/local/nginx --sbin-path=/usr/local/nginx/nginx --conf-path=/usr/local/nginx/nginx.conf --pid-path=/usr/local/nginx/nginx.pid --with-http_ssl_module --with-pcre=../pcre-8.38 --with-zlib=../zlib-1.2.8 make make install å®‰è£…ç›®å½•ä»¥åŠå…¶ä»–é…ç½®ç­‰ç›®å½•å¯ä»¥è‡ªå®šä¹‰ã€‚--with-pcre=å’Œ--with-zlib=æºç è·¯å¾„æ ¹æ®å®žé™…å¡«å†™ã€‚ç›´æŽ¥å¯åŠ¨/usr/local/nginx/nginxå³å¯ã€‚ curl http://localhost &lt;!DOCTYPE html> &lt;html> &lt;head> &lt;title>Welcome to nginx!&lt;/title> ... ... è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚å¦‚æžœæœªæˆåŠŸï¼Œè¯·æŸ¥çœ‹80ç«¯å£æ˜¯å¦å ç”¨ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–ç«¯å£ã€‚/usr/local/nginx/nginxæœ‰ä¸€ä¸‹å‡ ä¸ªå‚æ•°é€‰æ‹©ï¼Œå¯è‡ªè¡Œç ”ç©¶ã€‚ Options: -?,-h : this help -v : show version and exit -V : show version and configure options then exit -t : test configuration and exit -q : suppress non-error messages during configuration testing -s signal : send signal to a master process: stop, quit, reopen, reload -p prefix : set prefix path (default: /usr/local/nginx/) -c filename : set configuration file (default: /usr/local/nginx/nginx.conf) -g directives : set global directives out of configuration file å¯ä»¥åœ¨/etc/rc.localä¸­æ·»åŠ å¼€æœºå¯åŠ¨ PHPæ­¤å¤„MariaDBå®‰è£…å‚è€ƒè¿™ç¯‡åšå®¢ä¸‹è½½PHPæºç ï¼Œè§£åŽ‹ã€‚ wget http://cn2.php.net/distributions/php-7.1.0.tar.gz tar zxvf php-7.1.0.tar.gz å®‰è£…PHPçš„å„ç±»ä¾èµ–åŒ… yum -y install libxml2 libxml2-devel openssl openssl-devel curl curl-devel libjpeg install libjpeg-devel install libpng install libpng-devel install freetype install freetype-devel install pcre install pcre-devel install libxslt install libxslt-devel ç¼–è¯‘å®‰è£… cd php-7.1.0 ./configure --prefix=/usr/local/php --with-curl --with-freetype-dir --with-gd --with-gettext --with-iconv-dir --with-kerberos --with-libdir=lib64 --with-libxml-dir --with-mysqli --with-openssl --with-pcre-regex --with-pdo-mysql --with-pdo-sqlite --with-pear --with-png-dir --with-jpeg-dir --with-xmlrpc --with-xsl --with-zlib --with-bz2 --with-mhash --enable-fpm --enable-bcmath --enable-libxml --enable-inline-optimization --enable-gd-native-ttf --enable-mbregex --enable-mbstring --enable-opcache --enable-pcntl --enable-shmop --enable-soap --enable-sockets --enable-sysvsem --enable-sysvshm --enable-xml --enable-zip make make install æ³¨æ„ç¼–è¯‘æ—¶é—´è¾ƒä¹…ã€‚æŽ¥ä¸‹æ¥é…ç½®PHPå’Œnginxã€‚é¦–å…ˆä»ŽPHPæºç ç›®å½•ä¸­å¤åˆ¶é»˜è®¤é…ç½®åˆ°ç›¸åº”ç›®å½• cp php.ini-development /usr/local/php/php.ini cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf cp sapi/fpm/php-fpm /usr/local/bin åˆ›å»ºwebç”¨æˆ· groupadd www-data useradd -g www-data www-data ä¿®æ”¹php-fpm.confä¸­åŒ…å«çš„php-fpm.dç›®å½•å®žé™…è·¯å¾„ vim /usr/local/php/etc/php-fpm.conf ä¿®æ”¹å…¶ä¸­åŒ…å«é…ç½®çš„è·¯å¾„include=NONE/etc/php-fpm.d/*.confä¸º/usr/local/php/etc/php-fpm.d/ä¸‹ cp /usr/local/php/etc/php-fpm.d/www.conf.default /usr/local/php/etc/php-fpm.d/www.conf vim /usr/local/php/etc/php-fpm.d/www.conf æ·»åŠ ç”¨æˆ·åå’Œç”¨æˆ·ç»„ user = www-data group = www-data æŽ¥ä¸‹æ¥ä¿®æ”¹nginxé…ç½®vim /usr/local/nginx/nginx.confã€‚ä¿®æ”¹nginxçš„è¿è¡Œç”¨æˆ·å’Œç”¨æˆ·ç»„ä¸ºwww-dataï¼šwww-dataã€‚åœ¨server{}ä¸­çš„location / {}æ¨¡å—ä¸­åŠ å…¥index.phpé¡¹ï¼Œå¹¶åˆ é™¤é‡ŠæŽ‰å¯åŠ¨location ~* \.php$ {}æ¨¡å—ï¼Œä½¿phpç”Ÿæ•ˆã€‚ä¿®æ”¹fastcgiè·¯å¾„fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; user www-data www-data; ... ... location / { root html; index index.html index.htm index.php; } ... ... location ~ \.php$ { root html; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; #fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } å¯åŠ¨nginxå’Œphp-fpm /usr/local/nginx/nginx -s restart /usr/local/bin/php-fpm å¯é€šè¿‡æŸ¥çœ‹php-fpmçš„9000ç«¯å£æ˜¯å¦åœ¨ç›‘å¬æ¥åˆ¤æ–­php-fpmæ˜¯å¦å¯åŠ¨ # netstat -tln | grep 9000 tcp 0 0 127.0.0.1:9000 0.0.0.0:* LISTEN æŽ¥ä¸‹é‡Œä¸€èˆ¬ä¼šåœ¨nginxçš„htmlç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªvim info.phpæ¥éªŒè¯phpèƒ½å¦æ­£å¥½è§£æžã€‚ &lt;?php phpinfo(); ?> è®¿é—®http://ip/info.phpå¯ä»¥çœ‹åˆ°å®‰è£…çš„phpçš„ç‰ˆæœ¬å’Œæ”¯æŒåº“ä¹‹ç±»çš„ä¿¡æ¯ã€‚ MariaDBMariaDBæ˜¯Mysqlçš„ä¸€ä¸ªåˆ†æ”¯ï¼Œç›®å‰è¿˜æ˜¯å®Œå…¨å…¼å®¹Mysqlçš„ï¼Œæ‰€ä»¥åœ¨å®‰è£…çš„æ—¶å€™ç›®å½•å’Œåç§°ä¾ç„¶é‡‡ç”¨mysqlçš„åå­—ã€‚æ­¤å¤„MariaDBå®‰è£…å‚è€ƒè¿™ç¯‡åšå®¢ä¸‹è½½MariaDBæºç ï¼Œå¹¶è§£åŽ‹ mkdir mariadb cd mariadb wget https://mirrors.tuna.tsinghua.edu.cn/mariadb//mariadb-10.1.20/source/mariadb-10.1.20.tar.gz tar zxvf mariadb-10.1.20.tar.gz yumå®‰è£…MariaDBä¾èµ–åŒ… yum -y install readline-devel zlib-devel openssl-devel libaio-devel æ•°æ®åº“è®¾è®¡åˆ°åŽŸå§‹æ•°æ®ï¼Œæ‰€ä»¥ä¸€èˆ¬éœ€è¦æ–°å»ºä¸“ç”¨çš„ç”¨æˆ·å’Œç”¨æˆ·æ¥è¿è¡Œã€‚è¿™é‡Œæ–°å»ºmysqlï¼šmysqlç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼Œå¹¶ä¸å…è®¸sshè¿œç¨‹ç™»å½•ã€‚ groupadd -r mysql #åˆ›å»ºç³»ç»Ÿç”¨æˆ·ç»„ useradd -g mysql -s /sbin/nologin mysql #åˆ›å»ºç”¨æˆ·ï¼Œå½’å±žäºŽmysqlç»„ï¼Œä¸å…è®¸è¿œç¨‹ç™»å½• æŽ¥ä¸‹æ¥åˆ›å»ºæ•°æ®åº“ç›®å½•ï¼Œå¹¶æ›´æ”¹ä¸ºæ‹¥æœ‰è€…ã€‚æ­¤å¤„å°†æ•°æ®åº“æ•°æ®å­˜æ”¾åœ¨/data/mysqlç›®å½•ä¸­ã€‚ mkdir -p /data/mysql chown -R mysql:mysql /data/mysql/ çŽ°åœ¨å¯ä»¥å®‰è£…MariaDBäº†ã€‚ cd mariadb-10.1.20 cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_DATADIR=/data/mysql -DSYSCONFDIR=/etc -DWITHOUT_TOKUDB=1 -DMYSQL_UNIX_ADDR=/tmp/mysql.sock -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci make make install æ­¤å¤„ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œéœ€è¦è€å¿ƒç­‰å¾…ï¼Œè‹¥å‡ºçŽ°ç¼–è¯‘å¤±è´¥çš„æƒ…å†µï¼Œè¯·åˆ é™¤ç›®å½•ä¸‹çš„ç¼–è¯‘ç¼“å­˜æ–‡ä»¶CMakeCache.txtåŽï¼Œæ›´æ”¹ç›¸å…³ä¾èµ–å…³ç³»é‡æ–°ç¼–è¯‘ã€‚å®‰è£…æˆåŠŸåŽï¼Œè¿›å…¥å®‰è£…ç›®å½•ï¼Œåˆå§‹åŒ–mysqlæœåŠ¡å™¨ï¼Œå¹¶å®‰è£…æœåŠ¡åˆ°ç³»ç»ŸæœåŠ¡ä¸­ï¼Œè®¾ç½®å¼€æœºå¯åŠ¨æœåŠ¡ã€‚ cd /usr/local/mysql/ chown -R mysql:mysql * scripts/mysql_install_db --user=mysql cp support-files/mysql.server /etc/init.d/mysqld chkconfig --add mysqld # æ·»åŠ è‡³ç³»ç»ŸæœåŠ¡ chkconfig mysqld on # è®¾ç½®å¼€æœºè‡ªå¯åŠ¨ æœ€åŽå°†/var/lib/mysql/mysql.socké“¾æŽ¥åˆ°/tmp/mysql.sockï¼Œå¦è€…æ— æ³•è¿›å…¥mysqlã€‚å¯åŠ¨mysqlæœåŠ¡ã€‚ ln -s /var/lib/mysql/mysql.sock /tmp/mysql.sock service mysqld start åŽç»­æ“ä½œå‚è€ƒmysqlå…¥é—¨æ•™ç¨‹ã€‚]]></content>
      <tags>
        <tag>LINUX</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[nginx-rtmpæµåª’ä½“æœåŠ¡å™¨]]></title>
    <url>%2F2016%2F12%2F25%2Fnginx-rtmp%2F</url>
    <content type="text"><![CDATA[ç®€ä»‹Nginxæ˜¯httpå’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼ŒåŒæ—¶æ”¯æŒé‚®ä»¶åè®®ï¼ˆIMAP/POP3/SMTPï¼‰ï¼Œç”±ä¿„ç½—æ–¯ç¨‹åºè®¾è®¡å¸ˆIgor Sysoevæ‰€å¼€å‘ï¼Œå…¶ä»£ç éµå¾ªBSDè®¸å¯è¯å¼€æºã€‚ç”±äºŽå…¶è½»é‡ï¼Œå ç”¨ç³»ç»Ÿèµ„æºå°‘ï¼Œå¹¶å‘é‡å¼ºçš„ç‰¹ç‚¹ï¼Œè€Œæ‹¥æœ‰ä¸å°‘çš„ç”¨æˆ·ã€‚Nginx-rtmp-moduleæ˜¯nginxçš„ä¸€ä¸ªæ¨¡å—ï¼Œå¼€æºã€‚ä½¿ç”¨è¿™ä¸ªæ¨¡å—å¼€æºåœ¨nginxçš„åŸºç¡€ä¸Šå¿«é€Ÿæ­å»ºèµ·ä¸€ä¸ªæµåª’ä½“æœåŠ¡å™¨ã€‚é…åˆffmpegå¼€æºé¡¹ç›®å¼€æºå®žçŽ°è®¸å¤šç‚¹æ’­å’Œç›´æ’­çš„åŸºæœ¬åŠŸèƒ½ã€‚ åŠŸèƒ½ç‰¹ç‚¹Nginx-rtmpæž¶æž„çš„æµåª’ä½“æœåŠ¡å™¨å…·æœ‰ä»¥ä¸‹ä¸€äº›åŠŸèƒ½ç‰¹ç‚¹ï¼šï¼ˆç¿»è¯‘è‡ªå®˜ç½‘ï¼‰ æ”¯æŒRTMP / HLS / MPEG-DASHåè®®çš„è§†é¢‘ç›´æ’­ã€‚æµ‹è¯•æŽ¨æµå¯ä»¥å®žçŽ°rtmp å’Œhttp flv çš„æŽ¨æµï¼Œhlså’Œdashå¹¶æ²¡æœ‰æµ‹è¯•æŽ¨æµï¼›æ‹‰æµå¯ä»¥å®žçŽ°rtmp å’Œhlsï¼Œæ²¡æœ‰æµ‹è¯•http flv å’Œdashã€‚2.æ”¯æŒflv/mp4æ ¼å¼çš„è§†é¢‘ç‚¹æ’­ï¼Œæ”¯æŒä»¥æ–‡ä»¶æˆ–è€…httpçš„æ–¹å¼çš„è¾“å…¥ã€‚3.æ”¯æŒä¸¤ç§æµçš„åˆ†å‘æ¨¡å¼ push and pull4.å¯ä»¥å°†å¤šç›´æ’­æµåˆ†åˆ«å½•åˆ¶æˆflvæ–‡ä»¶5.æ”¯æŒH264/AACç¼–ç 6.æ”¯æŒåœ¨çº¿è½¬ç  Onlinetranscoding with FFmpeg è½¬ç å®žçŽ°ä¹Ÿæ˜¯exec ffmpegçš„ï¼Œç†è®ºä¸Šæ”¯æŒä¸€åˆ‡ffmpegæ”¯æŒçš„åº“ã€‚7.æ”¯æŒHLS (HTTP Live Streaming)éœ€è¦ libavformat (&gt;= 8. 53.31.100) from ffmpeg (ffmpeg.org)8.æ”¯æŒhttpå›žè°ƒ HTTPcallbacks (publish/play/record/update etc)9.æ”¯æŒç‰¹å®šæƒ…å†µä¸‹è°ƒç”¨å¤–éƒ¨ç¨‹åº(exec) ffmpegè½¬ç å³é‡‡ç”¨è¿™ç§æ–¹å¼10.ä½¿ç”¨HTTPcontrolæ¨¡å—æ¥ recording audio/video and dropping clients11.å…ˆè¿›å†…å­˜æŽ§åˆ¶æŠ€æœ¯ï¼Œå¯ä»¥åœ¨ä½¿ç”¨å°‘é‡å†…å­˜çš„æƒ…å†µä¸‹å®Œæˆæµç•…çš„ç›´æ’­åŠŸèƒ½ã€‚12.å¯ä»¥å’Œä»¥ä¸‹å¤–éƒ¨ç¨‹åºååŒå·¥ä½œï¼šWirecast, FMS, Wowza, JWPlayer, FlowPlayer, StrobeMediaPlayback, ffmpeg, avconv, rtmpdump, flvstreamerç­‰ã€‚13.ç»Ÿè®¡æ•°æ®å±•ç¤ºåœ¨XML / XSLæ–‡ä»¶ä¸­ï¼Œå‹å¥½çš„å¯è¯»å½¢å¼ã€‚14.æ”¯æŒè·¨å¹³å° Linux/FreeBSD/MacOSã€‚ å®‰è£…åŠé…ç½®ä»¥ä¸‹é’ˆå¯¹nginx-rtmpæœåŠ¡å™¨çš„å®‰è£…ä»¥åŠä¸€äº›é…ç½®é¡¹åšä¸€ä¸‹ç®€å•ä»‹ç»ã€‚ å®‰è£…éƒ¨ç½²nginx-rtmp-moduleï¼šwget -O nginx-rtmp-module.zip https://github.com/arut/nginx-rtmp-module/archive/master.zip unzip nginx-rtmp-module.zip nginxï¼šwget http://nginx.org/download/nginx-1.11.6.tar.gz tar â€“x zxvf nginx-1.11.6.tar.gz ç¼–è¯‘å®‰è£…ï¼šéƒ¨ç½²nginx-rtmpæœåŠ¡å™¨é™¤äº†éœ€è¦nginxæœ¬èº«çš„ä¸€äº›æ”¯æ’‘åŒ…å’Œåº“ä¹‹å¤–ï¼Œåœ¨configureçš„æ—¶å€™éœ€è¦æ·»åŠ nginx-rtmp-moduleé€‰é¡¹ã€‚ ./configure --prefix=/usr/local/nginx --with-http_ssl_module --add-module=/root/nginx-rtmp-module make &amp;&amp; make install é…ç½®åŽŸç”Ÿçš„nginx-rtmpçš„æ‰€æœ‰åŠŸèƒ½å‡åœ¨nginxçš„é…ç½®æ–‡ä»¶/usr/local/nginx/conf/nginx.confä¸­å®žçŽ°ã€‚nginx.confçš„æ•´ä½“æž¶æž„ï¼š #rtmpé…ç½® rtmp { server { listen 1935; chunk_size 4000 application app_name { â€¦â€¦â€¦â€¦ #é…ç½®é¡¹ } application app_name2 { â€¦â€¦â€¦â€¦ #é…ç½®é¡¹ } application vod { play /var/flvs; #video on demand } } } #nginxé…ç½® http { server { location /hls { # Serve HLS fragments types { application/vnd.apple.mpegurl m3u8; video/mp2t ts; } root /tmp; add_header Cache-Control no-cache; } } } éœ€è¦åœ¨rtmp{ }ä¸­é…ç½®å„ç§æµåª’ä½“ç›¸å…³çš„é…ç½®ï¼Œåœ¨http{ }ä¸­é…ç½®å„ç§httpç›¸å…³çš„é…ç½®ã€‚å„ä¸ªapplicationç‹¬ç«‹é…ç½®ï¼Œæ”¯æŒæ­£åˆ™åŒ¹é…ã€‚ä»¥ä¸‹ä»‹ç»ä¸€äº›é‡è¦çš„é…ç½®é¡¹ï¼š ç›´æ’­åŸºæœ¬é…ç½®ï¼šrtmpæŽ¨æ‹‰æµåœ¨rtmp{ server{ * } }ä¸­é…ç½®ä»¥ä¸‹å†…å®¹ application mytv { live on; } å¦‚æ­¤å³é…ç½®äº†å‘å¸ƒç‚¹ä¸ºmytv çš„ç›´æ’­é¢‘é“ï¼Œå¯ä»¥å®žçŽ°rtmpæŽ¨æµå’Œæ‹‰æµã€‚æŽ¨æ‹‰æµåœ°å€ï¼š rtmp://ip:1935/mytv/stream hlsåœ¨application mytv { * }ä¸­é…ç½®ä»¥ä¸‹å†…å®¹ application mytv { â€¦â€¦â€¦â€¦ #çœç•¥å…¶ä»–é…ç½® hls on; hls_path /tmp/hls; hls_fragment 15s; } åœ¨http { server{ location /hls { } } }ä¸­é…ç½®ä»¥ä¸‹å†…å®¹ http { ... server { ... location /hls { types { application/vnd.apple.mpegurl m3u8; } root /tmp; add_header Cache-Control no-cache; add_header Access-Control-Allow-Origin *; } } } å¦‚æ­¤é…ç½®ä¹‹åŽï¼Œè¿™ä¸ªå³å¯è¿›è¡Œhlsæ‹‰æµ.è¯¦ç»†çš„å…³äºŽhlsçš„å…¶ä»–é…ç½®ã€‚å¦‚åˆ‡ç‰‡æ—¶é—´å‘½åè®¾ç½®ã€æ˜¯å¦åŠ å¯†hlsç­‰é…ç½®å¯ä»¥å‚è€ƒï¼šhlsé…ç½®æ–‡æ¡£ MPEG-DASHåœ¨applicationé…ç½®æ®µä¸­é…ç½®ï¼š dash on; dash_path /tmp/dash; dash_fragment 15s; åœ¨httpé…ç½®æ®µä¸­é…ç½®ï¼š http { ... server { ... location /dash { root /tmp; add_header Cache-Control no-cache; # To avoid issues with cross-domain HTTP requests (e.g. during development) add_header Access-Control-Allow-Origin *; } } } MPEG-DASH å®žçŽ°æ–¹å¼ä¸ŽHLSç±»ä¼¼ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹ï¼šmpeg-dashé…ç½®æ–‡æ¡£ è‡ªåŠ¨è½¬æŽ¨å½“å¤šå°nginx-rtmp æœåŠ¡å™¨è¿è¡Œæ—¶ï¼Œå¯ä»¥é…ç½®æŠŠæµè‡ªåŠ¨æŽ¨åˆ°å…¶ä»–æœºå™¨ä¸Šã€‚ rtmp_auto_push on; rtmp_auto_push_reconnect 1s; rtmp_socket_dir /var/sock; rtmp { server { listen 1935; application myapp { live on; } } } æ­¤åŠŸèƒ½æ²¡æœ‰æµ‹è¯•è¿‡ï¼ŒæœªçŸ¥å…¶å…·ä½“è½¬æŽ¨æ˜¯å¦‚ä½•å®žçŽ°çš„ã€‚ å½•åˆ¶åœ¨application mytv { * }ä¸­é…ç½®ä»¥ä¸‹å†…å®¹ application mytv { â€¦â€¦â€¦â€¦ #çœç•¥å…¶ä»–é…ç½® # record first 1K of stream record all; record_path /tmp/av; record_max_size 1K; # append current timestamp to each flv record_unique on; #å¼€å¯åŽæ¯ä¸ªå½•åˆ¶æ–‡ä»¶æ ¹æ®æ—¶é—´å‘½å } å…¶ä»–å½•åˆ¶é€‰é¡¹å¯å‚è€ƒï¼šrecordé…ç½®æ–‡æ¡£ è½¬ç nginx-rtmp é‡‡ç”¨è°ƒç”¨å¤–éƒ¨ç¨‹åºffmpeg è¿›è¡Œè½¬ç ã€‚éœ€è¦åœ¨application mytv { * }ä¸­é…ç½®ä»¥ä¸‹å†…å®¹ rtmp { server { listen 1935; application src { live on; exec ffmpeg -i rtmp://localhost/src/$name -c:a libfdk_aac -b:a 32k -c:v libx264 -b:v 128K -f flv rtmp://localhost/hls/$name_low -c:a libfdk_aac -b:a 64k -c:v libx264 -b:v 256k -f flv rtmp://localhost/hls/$name_mid -c:a libfdk_aac -b:a 128k -c:v libx264 -b:v 512K -f flv rtmp://localhost/hls/$name_hi; } application hls { live on; â€¦â€¦ } } } exec ffmpeg è¿™æ ·çš„é…ç½®æ˜¯ä¼šåœ¨æ‹‰æµè¯·æ±‚è½¬ç æµçš„æ—¶å€™è§¦å‘ffmpeg æ‹‰æµè½¬ç ï¼Œåœ¨å¤šå°æœºå™¨åšæµåª’ä½“çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡exec_pul å’Œexec_push æ¥é…ç½®åœ¨æ‹‰æµæ—¶è§¦å‘è½¬ç æˆ–è€…åœ¨æŽ¨æµæ—¶è§¦å‘è½¬ç ã€‚ execå…³äºŽè°ƒç”¨å¤–éƒ¨ç¨‹åºï¼Œnginx-rtmp æ”¯æŒå¤šä¸ªé…ç½®é¡¹ï¼Œå‚è€ƒï¼šexecé…ç½®æ–‡æ¡£ ç»Ÿè®¡ä¿¡æ¯åœ¨http{ server{ } }ä¸­é…ç½®å¯ä»¥å¯ç”¨ç»Ÿè®¡ä¿¡æ¯ã€‚ http { server { location /stat { rtmp_stat all; rtmp_stat_stylesheet stat.xsl; } location /stat.xsl { root /path/to/stat/xsl/file; } } } è®¿é—®http://192.168.1.1:8765/statå¯ä»¥çœ‹åˆ°å½“å‰æ—¶é—´å†…çš„å„ä¸ªapplication çš„æ¦‚å†µã€‚ä¹Ÿå¯ä»¥ä¸‹è½½http://192.168.1.1:8765/stat.xsl è¿›è¡Œç»Ÿè®¡ã€‚ç«¯å£å·æ ¹æ®nginxé…ç½®è€Œå®šã€‚ æ—¥å¿—é™¤äº†åŽŸç”Ÿnginx è‡ªå¸¦çš„error.log å’Œaccess.log ä¸¤ä¸ªæ—¥å¿—å¤–ï¼Œnginx-rtmp-module æ¨¡å—è¿˜æœ‰ä¸€ä¸ªrtmp-aceesss.log æ—¥å¿—ã€‚é»˜è®¤éƒ½æ˜¯åœ¨nginx çš„å®‰è£…ç›®å½•çš„ /logs ç›®å½•ä¸­ã€‚æŸ¥é˜…èµ„æ–™åŽå‘çŽ°ï¼Œnginx åº”è¯¥æ˜¯å¯ä»¥è‡ªå®šæ—¥å¿—çš„æ ¼å¼çš„ã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­ä¹Ÿå¯ä»¥å®šä¹‰é”™è¯¯æ—¥å¿—çš„çº§åˆ«ï¼Œæœ‰debug | info | notice | warn | error | crit å‡ ä¸ªçº§åˆ«ï¼Œå¤§æ¦‚æŽ’æŸ¥é—®é¢˜éƒ½åˆ©ç”¨debug çº§åˆ«çš„é”™è¯¯æ—¥å¿—ã€‚ æŽ§åˆ¶æ¨¡å—nginx-rtmp æœåŠ¡å™¨æ”¯æŒä»¥httpçš„å½¢å¼ä»Žå¤–éƒ¨å¯¹rtmp è¿›è¡ŒæŽ§åˆ¶ã€‚éœ€è¦é…ç½®ä»¥ä¸‹é¡¹ã€‚ http { â€¦â€¦ server { listen 8080; server_name localhost; .... location /control { rtmp_control all; } } } å†åœ¨éœ€è¦æŽ§åˆ¶çš„applicationä¸­é¢„è®¾å¥½å„ç§å‚æ•°ä¹‹åŽï¼Œä¾¿å¯ä»¥é‡‡ç”¨ç±»ä¼¼æŽ¥å£çš„å½¢å¼å¯¹æŸäº›æµè¿›è¡Œå½•åˆ¶ï¼Œç¦æ’­ï¼Œé‡å®šå‘ä¹‹ç±»çš„æ“ä½œäº†ã€‚ä»¥ä¸‹å±•ç¤ºå¼€å§‹å’Œåœæ­¢å½•åˆ¶çš„urlã€‚ curl &quot;http://localhost:8080/control/record/start?app=myapp&amp;name=mystream&amp;rec=rec1&quot; curl &quot;http://localhost:8080/control/record/stop?app=myapp&amp;name=mystream&amp;rec=rec1&quot; å…·ä½“çš„æŽ§åˆ¶è¯´æ˜Žå¯ä»¥æŸ¥çœ‹ï¼šcontrolé…ç½®æ–‡æ¡£ æ€»ç»“Nginx-rtmp æž¶æž„çš„æµåª’ä½“æœåŠ¡å™¨å®žé™…æµ‹è¯•åŸºæœ¬åŠŸèƒ½éƒ½æœ‰ï¼Œæ€§èƒ½ä¹Ÿä¸é”™ã€‚åœ¨é…ç½®è¾ƒå·®çš„VPS ä¸Šæ­å»ºä¹Ÿå¯ä»¥æµç•…è¿è¡Œï¼Œå¹¶ä¸å ç”¨å¤ªå¤šçš„èµ„æºã€‚ä½†æ˜¯å…¶åªèƒ½å®žçŽ°ç®€å•çš„åŠŸèƒ½ï¼Œå®žé™…å¯¹äºŽä¸šåŠ¡ä»¥åŠè¿è¥éœ€è¦æ”¹è¿›çš„åœ°æ–¹è¿˜æœ‰å¾ˆå¤šã€‚å®žæµ‹nginx-rtmp æœåŠ¡å™¨åœ¨hls æ—¶ï¼Œæ’­æ”¾æœ‰æ—¶ä¼šæœ‰å¡é¡¿ï¼ŒåŽŸå› æœªçŸ¥ï¼›åŒç çŽ‡æŽ¨åˆ°å…¶ä»–æµåª’ä½“æœåŠ¡å™¨ï¼Œhls æ‹‰æµæ²¡æœ‰å¡é¡¿ï¼Œå¯èƒ½è·ŸæŽ¨æµä¹Ÿæœ‰å…³ç³»ã€‚ Q&amp;AsQ: mpeg dashï¼ŸA: ç±»ä¼¼äºŽappleå®¶çš„HLSï¼ŒMPEG-DASH æ˜¯åŸºäºŽHTTPçš„è‡ªé€‚åº”ä¸²æµæ–¹æ¡ˆä¸­çš„å”¯ä¸€å›½é™…æ ‡å‡†ã€‚ä¹Ÿæ˜¯æœ‰å°åˆ‡ç‰‡å’Œç´¢å¼•æ–‡ä»¶ç»„æˆï¼ŒSCè®¡åˆ’åœ¨æ˜Žå¹´æ”¯æŒæ­¤åè®®ã€‚ Q: http callbackï¼ŸA: åœ¨nginx-rtmp çš„å®˜æ–¹wiki ä¸­æè¿°çš„http callback å¤§æ¦‚æ„æ€ä¸ºå®¢æˆ·ç«¯å‘é€è¿žæŽ¥è¯·æ±‚æ—¶ï¼Œä¼šå‘é€ä¸€ä¸ªå¼‚æ­¥http è¯·æ±‚ï¼Œä¼šä½¿å¤„ç†æš‚åœï¼Œç›´åˆ°è¿”å›žçŠ¶æ€ç ä¹‹åŽå†æ ¹æ®çŠ¶æ€ç ç»§ç»­è¿žæŽ¥è¯·æ±‚ã€‚å…·ä½“å¯ä»¥æŸ¥çœ‹ï¼šhttps://github.com/arut/nginx-rtmp-module/wiki/Directives#notify Q: å¤šåŸŸåé…ç½®ï¼ŸA: ç½‘ä¸Šèµ„æ–™è¯´nginx æœ¬èº«æ˜¯å¯ä»¥æ”¹å†™url çš„ï¼Œæœ‰å¯ä»¥é…ç½®å¤šä¸ªåŸŸåï¼›nginx-rtmp æœåŠ¡å™¨æ²¡æœ‰è¯´æ˜Žå¯ä»¥æ”¯æŒå¤šåŸŸåçš„é…ç½®ï¼Œç›®æµ‹åœ¨åšä¸€äº›ä¿®æ”¹ä¹‹åŽæ˜¯å¯ä»¥åšåˆ°æ”¯æŒå¤šåŸŸåçš„ã€‚ Q: å»¶è¿Ÿï¼ŸA: nginx-rtmp çš„æ‹‰æµå’ŒæŽ¨æµï¼Œå»¶è¿Ÿåœ¨1så·¦å³ã€‚åœ¨æ’­æ”¾å™¨ç¼“å†²è®¾ç½®åœ¨0æ—¶æ‰€æµ‹ã€‚]]></content>
      <tags>
        <tag>live</tag>
        <tag>LINUX</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MarkDown_Test]]></title>
    <url>%2F2016%2F11%2F12%2Fmarkdown_test%2F</url>
    <content type="text"><![CDATA[This a MarkDown test script. there are syntax code blow its markup effects. [TOC] HEADER:HEADER_1# HEADER_1 # HEADER_2## HEADER_2 ## HEADER_3### HEADER_3 ### HEADER_4#### HEADER_4 #### LIST:æœ‰åºï¼š1. a 1. aa 2. bb 1. aaa 2. aaa 3. cc 2. b 3. c 1. a 2. b 3. c æ— åºï¼š a a.a a.a.a a.a.a.a a.a.a.b a.a.b a.b b - a - a.a * a.a.a + a.a.a.a - a.a.a.b - a.a.b - a.b - b note: â€˜*â€˜ is equivalent to â€˜-â€˜ &amp; â€˜+â€˜. QUOTE: Ygritte: you know nothingï¼ŒJon Snow. Ygritte: you know nothingï¼ŒJon Snow. CODE:in a sentenceï¼švar is a variable. `var` is a variable. code blockï¼švar context = canvas.getContext("2d"); ```javascript var context = canvas.getContext(&quot;2d&quot;);``` TABLE: Tables Are Cool col 3 is right-aligned $1600 col 2 is centered $12 zebra stripes are neat $1 | Tables | Are | Cool | | ------------- |:-------------:| -----:| | col 3 is | right-aligned | $1600 | | col 2 is | centered | $12 | | zebra stripes | are neat | $1 | FORMAT:LETTER FORMAT:this is bold, and this is italic, this is delete-line. this is **bold**, and this is *italic*, this is ~~delete-line~~. HORIZONTAL LINE: --- *** TODO or ORDER LIST: Cmd Markdown å¼€å‘ æ”¹è¿› Cmd æ¸²æŸ“ç®—æ³•ï¼Œä½¿ç”¨å±€éƒ¨æ¸²æŸ“æŠ€æœ¯æé«˜æ¸²æŸ“æ•ˆçŽ‡ æ”¯æŒä»¥ PDF æ ¼å¼å¯¼å‡ºæ–‡ç¨¿ æ–°å¢žTodoåˆ—è¡¨åŠŸèƒ½ è¯­æ³•å‚è€ƒ æ”¹è¿› LaTex åŠŸèƒ½ ä¿®å¤ LaTex å…¬å¼æ¸²æŸ“é—®é¢˜ æ–°å¢ž LaTex å…¬å¼ç¼–å·åŠŸèƒ½ è¯­æ³•å‚è€ƒ ä¸ƒæœˆæ—…è¡Œå‡†å¤‡ å‡†å¤‡é‚®è½®ä¸Šéœ€è¦æºå¸¦çš„ç‰©å“ æµè§ˆæ—¥æœ¬å…ç¨Žåº—çš„ç‰©å“ è´­ä¹°è“å®çŸ³å…¬ä¸»å·ä¸ƒæœˆä¸€æ—¥çš„èˆ¹ç¥¨ - [ ] **Cmd Markdown å¼€å‘** - [ ] æ”¹è¿› Cmd æ¸²æŸ“ç®—æ³•ï¼Œä½¿ç”¨å±€éƒ¨æ¸²æŸ“æŠ€æœ¯æé«˜æ¸²æŸ“æ•ˆçŽ‡ - [ ] æ”¯æŒä»¥ PDF æ ¼å¼å¯¼å‡ºæ–‡ç¨¿ - [x] æ–°å¢žTodoåˆ—è¡¨åŠŸèƒ½ [è¯­æ³•å‚è€ƒ](https://github.com/blog/1375-task-lists-in-gfm-issues-pulls-comments) - [x] æ”¹è¿› LaTex åŠŸèƒ½ - [x] ä¿®å¤ LaTex å…¬å¼æ¸²æŸ“é—®é¢˜ - [x] æ–°å¢ž LaTex å…¬å¼ç¼–å·åŠŸèƒ½ [è¯­æ³•å‚è€ƒ](http://docs.mathjax.org/en/latest/tex.html#tex-eq-numbers) - [ ] **ä¸ƒæœˆæ—…è¡Œå‡†å¤‡** - [ ] å‡†å¤‡é‚®è½®ä¸Šéœ€è¦æºå¸¦çš„ç‰©å“ - [ ] æµè§ˆæ—¥æœ¬å…ç¨Žåº—çš„ç‰©å“ - [x] è´­ä¹°è“å®çŸ³å…¬ä¸»å·ä¸ƒæœˆä¸€æ—¥çš„èˆ¹ç¥¨ HYPERLINK:this is bing. this is [bing](https://www.bing.com/). IMAGE:this is the douban icon. ![Alt text](https://img3.doubanio.com/pics/douban-icons/favicon_48x48.png &quot;douban icon&quot;) others:it seems that HEXO does not support some MarkDown syntax, like flow-graph and sequence-graph. of course there are lots of features need to search.ãŠäº’ã„é¡½å¼ ã‚ã† â€‹ â€‹]]></content>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[test]]></title>
    <url>%2F2016%2F10%2F30%2Ftest%2F</url>
    <content type="text"><![CDATA[this is a comments test script. this is a comments test script. this is a comments test script.]]></content>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2016%2F10%2F03%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new "My New Post" More info: Writing Run server$ hexo server More info: Server Generate static files$ hexo generate More info: Generating Deploy to remote sites$ hexo deploy More info: Deployment]]></content>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
</search>
